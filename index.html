<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="generator" content="ReSpec 35.0.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
pre.idl{padding:1em;position:relative}
pre.idl>code{color:#000;color:var(--text,#000)}
@media print{
pre.idl{white-space:pre-wrap}
}
.idlHeader{display:block;width:150px;background:#8ccbf2;background:var(--def-border,#8ccbf2);color:#fff;color:var(--defrow-border,#fff);font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
.idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none;color:inherit}
.idlID{font-weight:700;color:#005a9c}
.idlType{color:#005a9c}
.idlName{color:#ff4500}
.idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
.idlSuperclass{font-style:italic;color:#005a9c}
.idlDefaultValue,.idlParamName{font-style:italic}
.extAttr{color:#666}
.idlSectionComment{color:gray}
.idlIncludes a{font-weight:700}
.respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
.respec-button-copy-paste:is(:focus:hover,.selected:focus){border-color:#51a7e8}
.respec-button-copy-paste:is(:hover,:active,.zeroclipboard-is-hover,.zeroclipboard-is-active){text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.respec-button-copy-paste:is(:active,.selected,.zeroclipboard-is-active){background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
.respec-button-copy-paste:is(:disabled,:disabled:hover,.disabled,.disabled:hover){color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
@media print{
.respec-button-copy-paste{visibility:hidden}
}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
    
<title>Encrypted Media Extensions</title>
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    
    
<link rel="stylesheet" href="eme.css">
  
<meta name="description" content="This specification extends HTMLMediaElement [HTML] providing APIs to control playback
        of encrypted content.">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "ED",
  "implementationReportURI": "https://w3c.github.io/test-results/encrypted-media/all.html",
  "shortName": "encrypted-media",
  "edDraftURI": "https://w3c.github.io/encrypted-media/",
  "editors": [
    {
      "name": "Joey Parrish",
      "w3cid": "105371",
      "company": "Google Inc.",
      "companyURL": "https://www.google.com/"
    },
    {
      "name": "Greg Freedman",
      "w3cid": "115364",
      "company": "Netflix Inc.",
      "companyURL": "https://www.netflix.com/"
    }
  ],
  "formerEditors": [
    {
      "name": "Mark Watson",
      "note": "Until September 2019",
      "w3cid": "46379",
      "company": "Netflix Inc.",
      "companyURL": "https://www.netflix.com/"
    },
    {
      "name": "David Dorwin",
      "note": "Until September 2017",
      "w3cid": "52505",
      "company": "Google Inc.",
      "companyURL": "https://www.google.com/"
    },
    {
      "name": "Jerry Smith",
      "note": "Until September 2017",
      "w3cid": "60176",
      "company": "Microsoft Corporation",
      "companyURL": "https://www.microsoft.com/"
    },
    {
      "name": "Adrian Bateman",
      "note": "Until May 2014",
      "w3cid": "42763",
      "company": "Microsoft Corporation",
      "companyURL": "https://www.microsoft.com/"
    }
  ],
  "group": "media",
  "github": "w3c/encrypted-media",
  "wgURI": "https://www.w3.org/media-wg/",
  "wgPublicList": "public-media-wg",
  "wgPatentURI": "https://www.w3.org/2004/01/pp-impl/115198/status",
  "localBiblio": {
    "CENC": {
      "title": "ISO/IEC 23001-7:2016, Information technology — MPEG systems technologies — Part 7: Common encryption in ISO Base Media File Format files",
      "href": "https://www.iso.org/obp/ui/#iso:std:iso-iec:23001:-7:ed-3:v1",
      "status": "International Standard",
      "publisher": "ISO/IEC",
      "id": "cenc"
    }
  },
  "xref": [
    "dom",
    "html",
    "infra",
    "webaudio"
  ],
  "publishISODate": "2024-04-27T00:00:00.000Z",
  "generatedSubtitle": "W3C Editor's Draft 27 April 2024"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED"></head>
  <body class="h-entry" data-cite="WEBIDL dom html infra webaudio"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">Encrypted Media Extensions</h1> 
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">W3C Editor's Draft</a> <time class="dt-published" datetime="2024-04-27">27 April 2024</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://w3c.github.io/encrypted-media/">https://w3c.github.io/encrypted-media/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/encrypted-media/">https://www.w3.org/TR/encrypted-media/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/encrypted-media/">https://w3c.github.io/encrypted-media/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/encrypted-media/">https://www.w3.org/standards/history/encrypted-media/</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/encrypted-media/commits/">Commit history</a>
                  </dd>
        
        <dt>Implementation report:</dt><dd>
                <a href="https://w3c.github.io/test-results/encrypted-media/all.html">https://w3c.github.io/test-results/encrypted-media/all.html</a>
              </dd>
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="105371">
    <span class="p-name fn">Joey Parrish</span> (<a class="p-org org h-org" href="https://www.google.com/">Google Inc.</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="115364">
    <span class="p-name fn">Greg Freedman</span> (<a class="p-org org h-org" href="https://www.netflix.com/">Netflix Inc.</a>)
  </dd>
        <dt>
                Former editors:
              </dt><dd class="editor p-author h-card vcard" data-editor-id="46379">
    <span class="p-name fn">Mark Watson</span> (<a class="p-org org h-org" href="https://www.netflix.com/">Netflix Inc.</a>) (Until September 2019)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="52505">
    <span class="p-name fn">David Dorwin</span> (<a class="p-org org h-org" href="https://www.google.com/">Google Inc.</a>) (Until September 2017)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="60176">
    <span class="p-name fn">Jerry Smith</span> (<a class="p-org org h-org" href="https://www.microsoft.com/">Microsoft Corporation</a>) (Until September 2017)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="42763">
    <span class="p-name fn">Adrian Bateman</span> (<a class="p-org org h-org" href="https://www.microsoft.com/">Microsoft Corporation</a>) (Until May 2014)
  </dd>
        
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/encrypted-media/">GitHub w3c/encrypted-media</a>
        (<a href="https://github.com/w3c/encrypted-media/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/encrypted-media/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/encrypted-media/issues/">open issues</a>)
      </dd><dd><a href="mailto:public-media-wg@w3.org?subject=%5Bencrypted-media%5D%20YOUR%20TOPIC%20HERE">public-media-wg@w3.org</a> with subject line <kbd>[encrypted-media] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-media-wg">archives</a>)</dd>
        
        
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/policies/#copyright">Copyright</a>
    ©
    2024
    
    <a href="https://www.w3.org/">World Wide Web Consortium</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
    <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/copyright/software-license-2023/" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
        This specification extends <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-1"><code>HTMLMediaElement</code></a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>] providing APIs to control playback
        of encrypted content.
      </p>
      <p>
        The API supports use cases ranging from simple clear key decryption to high value video
        (given an appropriate user agent implementation). License/key exchange is controlled by the
        application, facilitating the development of robust playback applications supporting a
        range of content decryption and protection technologies.
      </p>
      <p>
        This specification does not define a content protection or Digital Rights Management
        system. Rather, it defines a common API that may be used to discover, select and interact
        with such systems as well as with simpler content encryption systems. Implementation of
        Digital Rights Management is not required for compliance with this specification: only the
        <a data-link-type="dfn|abstract-op" href="#dfn-clear-key" class="internalDFN" id="ref-for-dfn-clear-key-1">Clear Key</a> system is required to be implemented as a common baseline.
      </p>
      <p>
        The common API supports a simple set of content encryption capabilities, leaving
        application functions such as authentication and authorization to page authors. This is
        achieved by requiring content protection system-specific messaging to be mediated by the
        page rather than assuming out-of-band communication between the encryption system and a
        license or other server.
      </p>
    </section>
    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p><p>
    This document was published by the <a href="https://www.w3.org/groups/wg/media">Media Working Group</a> as
    an Editor's Draft. 
  </p><p>Publication as an Editor's Draft does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/media/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                      This document is governed by the
                      <a id="w3c_process_revision" href="https://www.w3.org/2023/Process-20231103/">03 November 2023 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                    </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>
        Introduction
      </a></li><li class="tocline"><a class="tocxref" href="#definitions"><bdi class="secno">2. </bdi>
        Definitions
      </a></li><li class="tocline"><a class="tocxref" href="#obtaining-access-to-key-systems"><bdi class="secno">3. </bdi>
        Obtaining Access to Key Systems
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#permissions-policy-integration"><bdi class="secno">3.1 </bdi>
          Permissions Policy Integration
        </a></li><li class="tocline"><a class="tocxref" href="#navigator-extension-requestmediakeysystemaccess"><bdi class="secno">3.2 </bdi>
          <span data-idl="interface" data-title="Navigator" data-dfn-for=""><code>Navigator</code></span> Extension: <code>requestMediaKeySystemAccess()</code>
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#methods"><bdi class="secno">3.2.1 </bdi>
            Methods
          </a></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">3.2.2 </bdi>
            Algorithms
          </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#get-supported-configuration"><bdi class="secno">3.2.2.1 </bdi>
              <span>Get Supported Configuration</span>
            </a></li><li class="tocline"><a class="tocxref" href="#get-supported-configuration-and-consent"><bdi class="secno">3.2.2.2 </bdi>
              <span>Get Supported Configuration and Consent</span>
            </a></li><li class="tocline"><a class="tocxref" href="#get-supported-capabilities-for-audio-video-type"><bdi class="secno">3.2.2.3 </bdi>
              <span>Get Supported Capabilities for Audio/Video Type</span>
            </a></li><li class="tocline"><a class="tocxref" href="#get-consent-status"><bdi class="secno">3.2.2.4 </bdi>
              <span>Get Consent Status</span>
            </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#mediakeysystemconfiguration-dictionary"><bdi class="secno">3.3 </bdi>
          <span data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="MediaKeySystemConfiguration" data-dfn-for=""><code>MediaKeySystemConfiguration</code></span> dictionary
        </a></li><li class="tocline"><a class="tocxref" href="#mediakeysystemmediacapability-dictionary"><bdi class="secno">3.4 </bdi>
          <span data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="MediaKeySystemMediaCapability" data-dfn-for=""><code>MediaKeySystemMediaCapability</code></span> dictionary
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-mediakeysystemmediacapability-members"><bdi class="secno">3.4.1 </bdi>
            Dictionary <span class="formerLink" data-link-type="idl"><code>MediaKeySystemMediaCapability</code></span> Members
          </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#mediakeysystemaccess-interface"><bdi class="secno">4. </bdi>
        <span data-export="" data-dfn-type="interface" data-idl="interface" data-title="MediaKeySystemAccess" data-dfn-for=""><code>MediaKeySystemAccess</code></span> Interface
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#attributes"><bdi class="secno">4.1 </bdi>
          Attributes
        </a></li><li class="tocline"><a class="tocxref" href="#methods-0"><bdi class="secno">4.2 </bdi>
          Methods
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#mediakeys-interface"><bdi class="secno">5. </bdi>
        <span data-export="" data-dfn-type="interface" data-idl="interface" data-title="MediaKeys" data-dfn-for=""><code>MediaKeys</code></span> Interface
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#methods-1"><bdi class="secno">5.1 </bdi>
          Methods
        </a></li><li class="tocline"><a class="tocxref" href="#algorithms-0"><bdi class="secno">5.2 </bdi>
          Algorithms
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#is-persistent-session-type"><bdi class="secno">5.2.1 </bdi>
            <span>Is persistent session type?</span>
          </a></li><li class="tocline"><a class="tocxref" href="#cdm-unavailable"><bdi class="secno">5.2.2 </bdi>
            <span>CDM Unavailable</span>
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#media-keys-storage"><bdi class="secno">5.3 </bdi>
          <span>Storage and Persistence</span>
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#mediakeysession-interface"><bdi class="secno">6. </bdi>
        <span data-export="" data-dfn-type="interface" data-idl="interface" data-title="MediaKeySession" data-dfn-for=""><code>MediaKeySession</code></span> Interface
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#attributes-0"><bdi class="secno">6.1 </bdi>
          Attributes
        </a></li><li class="tocline"><a class="tocxref" href="#methods-2"><bdi class="secno">6.2 </bdi>
          Methods
        </a></li><li class="tocline"><a class="tocxref" href="#mediakeystatusmap-interface"><bdi class="secno">6.3 </bdi>
          <span data-export="" data-dfn-type="interface" data-idl="interface" data-title="MediaKeyStatusMap" data-dfn-for=""><code>MediaKeyStatusMap</code></span> Interface
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#attributes-1"><bdi class="secno">6.3.1 </bdi>
            Attributes
          </a></li><li class="tocline"><a class="tocxref" href="#methods-3"><bdi class="secno">6.3.2 </bdi>
            Methods
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#mediakeymessageevent"><bdi class="secno">6.4 </bdi>
          <span data-xref-type="_IDL_" data-link-type="idl" data-lt="MediaKeyMessageEvent" class="formerLink"><code>MediaKeyMessageEvent</code></span>
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#attributes-2"><bdi class="secno">6.4.1 </bdi>
            Attributes
          </a></li><li class="tocline"><a class="tocxref" href="#mediakeymessageeventinit"><bdi class="secno">6.4.2 </bdi>
            <span data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="MediaKeyMessageEventInit" data-dfn-for=""><code>MediaKeyMessageEventInit</code></span>
          </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-mediakeymessageeventinit-members"><bdi class="secno">6.4.2.1 </bdi>
              Dictionary <span class="formerLink" data-link-type="idl"><code>MediaKeyMessageEventInit</code></span> Members
            </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#mediakeysession-events"><bdi class="secno">6.5 </bdi>
          Event Summary
        </a></li><li class="tocline"><a class="tocxref" href="#mediakeysession-algorithms"><bdi class="secno">6.6 </bdi>
          Algorithms
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#queue-message"><bdi class="secno">6.6.1 </bdi>
            <span>Queue a "message" Event</span>
          </a></li><li class="tocline"><a class="tocxref" href="#update-key-statuses"><bdi class="secno">6.6.2 </bdi>
            <span>Update Key Statuses</span>
          </a></li><li class="tocline"><a class="tocxref" href="#update-expiration"><bdi class="secno">6.6.3 </bdi>
            <span>Update Expiration</span>
          </a></li><li class="tocline"><a class="tocxref" href="#session-closed"><bdi class="secno">6.6.4 </bdi>
            <span>Session Closed</span>
          </a></li><li class="tocline"><a class="tocxref" href="#monitor-cdm"><bdi class="secno">6.6.5 </bdi>
            <span>Monitor for CDM State Changes</span>
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#exceptions"><bdi class="secno">6.7 </bdi>
          Exceptions
        </a></li><li class="tocline"><a class="tocxref" href="#session-storage"><bdi class="secno">6.8 </bdi>
          Session Storage and Persistence
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#htmlmediaelement-extensions"><bdi class="secno">7. </bdi>
        <span data-idl="interface" data-title="HTMLMediaElement" data-dfn-for=""><code>HTMLMediaElement</code></span> Extensions
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#attributes-3"><bdi class="secno">7.1 </bdi>
          Attributes
        </a></li><li class="tocline"><a class="tocxref" href="#methods-4"><bdi class="secno">7.2 </bdi>
          Methods
        </a></li><li class="tocline"><a class="tocxref" href="#mediaencryptedevent"><bdi class="secno">7.3 </bdi>
          <span class="formerLink" data-link-type="idl"><code>MediaEncryptedEvent</code></span>
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#attributes-4"><bdi class="secno">7.3.1 </bdi>
            Attributes
          </a></li><li class="tocline"><a class="tocxref" href="#mediaencryptedeventinit"><bdi class="secno">7.3.2 </bdi>
            <span data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="MediaEncryptedEventInit" data-dfn-for=""><code>MediaEncryptedEventInit</code></span>
          </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-mediaencryptedeventinit-members"><bdi class="secno">7.3.2.1 </bdi>
              Dictionary <span class="formerLink" data-link-type="idl"><code>MediaEncryptedEventInit</code></span> Members
            </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#htmlmediaelement-events"><bdi class="secno">7.4 </bdi>
          Event Summary
        </a></li><li class="tocline"><a class="tocxref" href="#htmlmediaelement-algorithms"><bdi class="secno">7.5 </bdi>
          Algorithms
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#media-may-contain-encrypted-blocks"><bdi class="secno">7.5.1 </bdi>
            Media Data May Contain Encrypted Blocks
          </a></li><li class="tocline"><a class="tocxref" href="#initdata-encountered"><bdi class="secno">7.5.2 </bdi>
            <span class="export" data-export="">Initialization Data Encountered</span>
          </a></li><li class="tocline"><a class="tocxref" href="#encrypted-block-encountered"><bdi class="secno">7.5.3 </bdi>
            <span class="export" data-export="">Encrypted Block Encountered</span>
          </a></li><li class="tocline"><a class="tocxref" href="#attempt-to-decrypt"><bdi class="secno">7.5.4 </bdi>
            <span>Attempt to Decrypt</span>
          </a></li><li class="tocline"><a class="tocxref" href="#wait-for-key"><bdi class="secno">7.5.5 </bdi>
            <span>Wait for Key</span>
          </a></li><li class="tocline"><a class="tocxref" href="#resume-playback"><bdi class="secno">7.5.6 </bdi>
            <span>Attempt to Resume Playback If Necessary</span>
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#media-element-restrictions"><bdi class="secno">7.6 </bdi>
          Media Element Restrictions
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#implementation-requirements"><bdi class="secno">8. </bdi>
        Implementation Requirements
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#cdm-constraint-requirements"><bdi class="secno">8.1 </bdi>
          CDM Constraints
        </a></li><li class="tocline"><a class="tocxref" href="#messaging-requirements"><bdi class="secno">8.2 </bdi>
          Messages and Communication
        </a></li><li class="tocline"><a class="tocxref" href="#persistent-state-requirements"><bdi class="secno">8.3 </bdi>
          Persistent Data
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#use-origin-specific-key-system-storage"><bdi class="secno">8.3.1 </bdi>
            Use origin-specific and browsing profile-specific <span data-link-type="dfn|abstract-op" class="formerLink">Key System</span> storage
          </a></li><li class="tocline"><a class="tocxref" href="#allow-persistent-data-cleared"><bdi class="secno">8.3.2 </bdi>
            Allow Persistent Data to Be Cleared
          </a></li><li class="tocline"><a class="tocxref" href="#encrypt-or-obfuscate-persistent-data"><bdi class="secno">8.3.3 </bdi>
            Encrypt or obfuscate Persistent Data
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#exposed-value-requirements"><bdi class="secno">8.4 </bdi>
          Values Exposed to the Application
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#per-origin-per-profile-values"><bdi class="secno">8.4.1 </bdi>
            Use Per-Origin Per-Profile Values
          </a></li><li class="tocline"><a class="tocxref" href="#allow-values-to-be-cleared"><bdi class="secno">8.4.2 </bdi>
            Allow Values to Be Cleared
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#identifier-requirements"><bdi class="secno">8.5 </bdi>
          Identifiers
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#limit-or-avoid-use-of-distinctive-identifiers-and-permanent-identifiers"><bdi class="secno">8.5.1 </bdi>
            Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers
          </a></li><li class="tocline"><a class="tocxref" href="#encrypt-identifiers"><bdi class="secno">8.5.2 </bdi>
            Encrypt Identifiers
          </a></li><li class="tocline"><a class="tocxref" href="#per-origin-per-profile-identifiers"><bdi class="secno">8.5.3 </bdi>
            Use Per-Origin Per-Profile Identifiers
          </a></li><li class="tocline"><a class="tocxref" href="#non-associable-identifiers"><bdi class="secno">8.5.4 </bdi>
            Use Non-Associable Identifiers
          </a></li><li class="tocline"><a class="tocxref" href="#allow-identifiers-cleared"><bdi class="secno">8.5.5 </bdi>
            Allow Identifiers to Be Cleared
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#individualization"><bdi class="secno">8.6 </bdi>
          <span>Individualization</span>
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#direct-individualization"><bdi class="secno">8.6.1 </bdi>
            <span>Direct Individualization</span>
          </a></li><li class="tocline"><a class="tocxref" href="#app-assisted-individualization"><bdi class="secno">8.6.2 </bdi>
            <span>App-Assisted Individualization</span>
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#support-multiple-keys"><bdi class="secno">8.7 </bdi>
          Support Multiple Keys
        </a></li><li class="tocline"><a class="tocxref" href="#initialization-data-type-support-requirements"><bdi class="secno">8.8 </bdi>
          Initialization Data Type Support
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#licenses-generated-are-independent-of-content-type"><bdi class="secno">8.8.1 </bdi>
            Licenses Generated are Independent of Content Type
          </a></li><li class="tocline"><a class="tocxref" href="#support-extraction-from-media-data"><bdi class="secno">8.8.2 </bdi>
            Support Extraction From Media Data
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#media-requirements"><bdi class="secno">8.9 </bdi>
          Supported Media
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#unencrypted-container"><bdi class="secno">8.9.1 </bdi>
            Unencrypted Container
          </a></li><li class="tocline"><a class="tocxref" href="#interoperably-encrypted"><bdi class="secno">8.9.2 </bdi>
            Interoperably Encrypted
          </a></li><li class="tocline"><a class="tocxref" href="#unencrypted-in-band-support-content"><bdi class="secno">8.9.3 </bdi>
            Unencrypted In-band Support Content
          </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#common-key-systems"><bdi class="secno">9. </bdi>
        <span>Common Key Systems</span>
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#clear-key"><bdi class="secno">9.1 </bdi>
          <span>Clear Key</span>
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#clear-key-capabilities"><bdi class="secno">9.1.1 </bdi>
            Capabilities
          </a></li><li class="tocline"><a class="tocxref" href="#clear-key-behavior"><bdi class="secno">9.1.2 </bdi>
            Behavior
          </a></li><li class="tocline"><a class="tocxref" href="#clear-key-request-format"><bdi class="secno">9.1.3 </bdi>
            License Request Format
          </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#clear-key-request-format-example"><bdi class="secno">9.1.3.1 </bdi>
              Example
            </a></li></ol></li><li class="tocline"><a class="tocxref" href="#clear-key-license-format"><bdi class="secno">9.1.4 </bdi>
            License Format
          </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#clear-key-license-format-example"><bdi class="secno">9.1.4.1 </bdi>
              Example
            </a></li></ol></li><li class="tocline"><a class="tocxref" href="#clear-key-release-format"><bdi class="secno">9.1.5 </bdi>
            License Release Format
          </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#clear-key-release-format-example-1"><bdi class="secno">9.1.5.1 </bdi>
              Example message reflecting a <span data-link-type="dfn|abstract-op" class="formerLink">record of license destruction</span>
            </a></li></ol></li><li class="tocline"><a class="tocxref" href="#clear-key-release-ack-format"><bdi class="secno">9.1.6 </bdi>
            License Release Acknowledgement Format
          </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#clear-key-release-ack-format-example"><bdi class="secno">9.1.6.1 </bdi>
              Example
            </a></li></ol></li><li class="tocline"><a class="tocxref" href="#using-base64url"><bdi class="secno">9.1.7 </bdi>
            Using base64url
          </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#security"><bdi class="secno">10. </bdi>
        Security
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#input-data-security"><bdi class="secno">10.1 </bdi>
          Input Data Attacks and Vulnerabilities
        </a></li><li class="tocline"><a class="tocxref" href="#cdm-security"><bdi class="secno">10.2 </bdi>
          CDM Attacks and Vulnerabilities
        </a></li><li class="tocline"><a class="tocxref" href="#network-attacks"><bdi class="secno">10.3 </bdi>
          Network Attacks
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#potential-attacks"><bdi class="secno">10.3.1 </bdi>
            Potential Attacks
          </a></li><li class="tocline"><a class="tocxref" href="#mitigations"><bdi class="secno">10.3.2 </bdi>
            Mitigations
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#iframe-attacks"><bdi class="secno">10.4 </bdi>
          <code>iframe</code> Attacks
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#potential-attacks-0"><bdi class="secno">10.4.1 </bdi>
            Potential Attacks
          </a></li><li class="tocline"><a class="tocxref" href="#mitigations-0"><bdi class="secno">10.4.2 </bdi>
            Mitigations
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#cross-directory-attacks"><bdi class="secno">10.5 </bdi>
          Cross-Directory Attacks
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy"><bdi class="secno">11. </bdi>
        Privacy
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#privacy-disclosure"><bdi class="secno">11.1 </bdi>
          Information Disclosed by EME and Key Systems
        </a></li><li class="tocline"><a class="tocxref" href="#privacy-fingerprinting"><bdi class="secno">11.2 </bdi>
          Fingerprinting
        </a></li><li class="tocline"><a class="tocxref" href="#privacy-leakage"><bdi class="secno">11.3 </bdi>
          Information Leakage
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#concerns"><bdi class="secno">11.3.1 </bdi>
            Concerns
          </a></li><li class="tocline"><a class="tocxref" href="#mitigations-1"><bdi class="secno">11.3.2 </bdi>
            Mitigations
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#user-tracking"><bdi class="secno">11.4 </bdi>
          User Tracking
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#concerns-0"><bdi class="secno">11.4.1 </bdi>
            Concerns
          </a></li><li class="tocline"><a class="tocxref" href="#mitigations-2"><bdi class="secno">11.4.2 </bdi>
            Mitigations
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-storedinfo"><bdi class="secno">11.5 </bdi>
          Information Stored on User Devices
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#concerns-1"><bdi class="secno">11.5.1 </bdi>
            Concerns
          </a></li><li class="tocline"><a class="tocxref" href="#mitigations-3"><bdi class="secno">11.5.2 </bdi>
            Mitigations
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#incomplete-clearing"><bdi class="secno">11.6 </bdi>
          Incomplete Clearing of Data
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#concerns-2"><bdi class="secno">11.6.1 </bdi>
            Concerns
          </a></li><li class="tocline"><a class="tocxref" href="#mitigations-4"><bdi class="secno">11.6.2 </bdi>
            Mitigations
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#private-browsing"><bdi class="secno">11.7 </bdi>
          Private Browsing Modes
        </a></li><li class="tocline"><a class="tocxref" href="#privacy-secureorigin"><bdi class="secno">11.8 </bdi>
          Secure Origin and Transport
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">12. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">13. </bdi>
        Examples
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#example-source-and-key-known"><bdi class="secno">13.1 </bdi>
          Source and Key Known at Page Load (Clear Key)
        </a></li><li class="tocline"><a class="tocxref" href="#example-selecting-key-system"><bdi class="secno">13.2 </bdi>
          Selecting a Supported Key System and Using Initialization Data from the "encrypted" Event
        </a></li><li class="tocline"><a class="tocxref" href="#example-mediakeys-before-source"><bdi class="secno">13.3 </bdi>
          Create MediaKeys Before Loading Media
        </a></li><li class="tocline"><a class="tocxref" href="#example-using-all-events"><bdi class="secno">13.4 </bdi>
          Using All Events
        </a></li><li class="tocline"><a class="tocxref" href="#example-stored-license"><bdi class="secno">13.5 </bdi>
          Stored License
        </a></li><li class="tocline"><a class="tocxref" href="#example-getStatusForPolicy"><bdi class="secno">13.6 </bdi>
          Pre-fetch Media With HDCP Policy
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">14. </bdi>
        Acknowledgments
      </a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">A.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">A.2 </bdi>Informative references</a></li></ol></li></ol></nav>
    <section class="informative" id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>
        Introduction
      </h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This specification enables script to select content protection mechanisms, control
        license/key exchange, and execute custom license management algorithms. It supports a wide
        range of use cases without requiring client-side modifications in each user agent for each
        use case. This enables content providers to develop a single application solution for all
        devices.
      </p>
      <p>
        Supported content is encrypted per container-specific "common encryption" specifications,
        enabling use across key systems. Supported content has an unencrypted container, enabling
        metadata to be provided to the application and maintaining compatibility with other
        <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-2"><code>HTMLMediaElement</code></a> features.
      </p>
      <p>
        Implementers should pay attention to the mitigations for the security and privacy threats
        and concerns described in this specification. In particular, the specification requirements
        for security and privacy cannot be met without knowledge of the security and privacy
        properties of the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-1">Key System</a> and its implementation(s). <a href="#implementation-requirements" class="sec-ref"><bdi class="secno">8. </bdi>
        Implementation Requirements</a> contains security and privacy provisions related to the
        integration and use of underlying <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-2">Key System</a> implementations. <a href="#security" class="sec-ref"><bdi class="secno">10. </bdi>
        Security</a>
        focuses on external threats, such as input data or network attacks. <a href="#privacy" class="sec-ref"><bdi class="secno">11. </bdi>
        Privacy</a>
        focuses on the handling of user-specific information and providing users with adequate
        control over their own privacy.
      </p>
      <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>Note</span></div><p class="">
        While this specification is independent of the source of the media data, authors should be
        aware that many implementations only support decrypting media data provided via Media
        Source Extensions [<cite><a class="bibref" data-link-type="biblio" href="#bib-media-source" title="Media Source Extensions™">MEDIA-SOURCE</a></cite>].
      </p></div>
      <p>
        A generic stack implemented using the API is shown below. This diagram shows an example
        flow; other combinations of API calls and events are possible.
      </p><img src="stack_overview.svg" alt="A generic stack implemented using the proposed APIs" height="700">
    </section>
    <section id="definitions"><div class="header-wrapper"><h2 id="x2-definitions"><bdi class="secno">2. </bdi>
        Definitions
      </h2><a class="self-link" href="#definitions" aria-label="Permalink for Section 2."></a></div>
      
      <dl>
        <dt>
          <dfn class="export" data-lt="CDM|Content Decryption Module (CDM)" data-export="" data-plurals="cdms" id="dfn-cdm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Content Decryption Module (CDM)</dfn>
        </dt>
        <dd>
          <p>
            Content Decryption Module (CDM) is the client component that provides the
            functionality, including decryption, for one or more <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-3">Key Systems</a>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>Note</span></div><p class="">
            Implementations may or may not separate the implementations of CDMs or treat them as
            separate from the user agent. This is transparent to the API and application.
          </p></div>
        </dd>
        <dt>
          <dfn data-lt="Key System(s)|Key System" data-plurals="key systems" id="dfn-key-system-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Key System</dfn>
        </dt>
        <dd>
          <p>
            A Key System is a generic term for a decryption mechanism and/or content protection
            provider. Key System strings provide unique identification of a Key System. They are
            used by the user agent to select a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-1">CDM</a> and identify the source of a key-related
            event. User agents <em class="rfc2119">MUST</em> support the <a data-link-type="dfn|abstract-op" href="#dfn-common-key-systems" class="internalDFN" id="ref-for-dfn-common-key-systems-1">Common Key Systems</a>. User agents <em class="rfc2119">MAY</em> also
            provide additional <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-2">CDMs</a> with corresponding Key System strings.
          </p>
          <p>
            A Key System string is always a reverse domain name. Key System strings are compared
            using case-sensitive matching. It is <em class="rfc2119">RECOMMENDED</em> that <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-3">CDMs</a> use simple lower-case
            ASCII key system strings.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>Note</span></div><p class="">
            For example, "com.example.somesystem".
          </p></div>
          <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="3"><span>Note</span></div><p class="">
            Within a given system ("somesystem" in the example), subsystems may be defined as
            determined by the key system provider. For example, "com.example.somesystem.1" and
            "com.example.somesystem.1_5". Key System providers should keep in mind that these will
            be used for comparison and discovery, so they should be easy to compare and the
            structure should remain reasonably simple.
          </p></div>
        </dd>
        <dt>
          <dfn id="dfn-key-session" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Key Session</dfn>
        </dt>
        <dd>
          <p>
            A Key Session, or simply Session, provides a context for message exchange with the
            <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-4">CDM</a> as a result of which key(s) are made available to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-5">CDM</a>. Sessions are
            embodied as <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-1"><code>MediaKeySession</code></a> objects. Each Key session is associated with a single
            instance of <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-1">Initialization Data</a> provided in the
            <a data-link-type="idl" data-lt="generateRequest()" href="#dom-mediakeysession-generaterequest" class="internalDFN" id="ref-for-dom-mediakeysession-generaterequest-1"><code>generateRequest</code></a><code>()</code> call.
          </p>
          <p>
            Each Key Session is associated with a single <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-1"><code>MediaKeys</code></a> object, and only media
            element(s) associated with that <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-2"><code>MediaKeys</code></a> object may access key(s) associated with
            the session. Other <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-3"><code>MediaKeys</code></a> objects, <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-6">CDM</a> instances, and media elements <em class="rfc2119">MUST NOT</em> access the key session or use its key(s). Key sessions and the keys they contain
            are no longer <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-1">usable for decryption</a> once the session has been closed, including
            when the <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-2"><code>MediaKeySession</code></a> object is destroyed.
          </p>
          <p>
            All license(s) and key(s) associated with a Key Session which have not been explicitly
            stored <em class="rfc2119">MUST</em> be destroyed when the Key Session is closed.
          </p>
          <p>
            <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-1">Key IDs</a> <em class="rfc2119">MUST</em> be unique within a session.
          </p>
        </dd>
        <dt>
          <dfn data-plurals="session ids" id="dfn-session-id" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Session ID</dfn>
        </dt>
        <dd>
          <p>
            A Session ID is a unique string identifier generated by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-7">CDM</a> that can be used by
            the application to identify <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-3"><code>MediaKeySession</code></a> objects.
          </p>
          <p>
            A new Session ID is generated each time the user agent and <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-8">CDM</a> successfully create
            a new session.
          </p>
          <p>
            Each Session ID <em class="rfc2119">SHALL</em> be unique within the browsing context in which it was created.
            For session types for which the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-1">Is persistent session type?</a> algorithm returns
            <code>true</code>, Session IDs <em class="rfc2119">MUST</em> be unique within the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> over time,
            including across browsing sessions.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="3"><span>Note</span></div><p class="">
            The underlying content protection protocol does not necessarily need to support Session
            IDs.
          </p></div>
        </dd>
        <dt>
          <dfn data-lt="key(s)|Key" id="dfn-key-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Key</dfn>
        </dt>
        <dd>
          <p>
            Unless otherwise stated, key refers to a decryption key that can be used to decrypt
            blocks within <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>. Each such key is uniquely identified by
            a <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-2">key ID</a>. A key is associated with the <a data-link-type="dfn|abstract-op" data-lt="key session" href="#dfn-key-session" class="internalDFN" id="ref-for-dfn-key-session-1">session</a> used to provide it
            to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-9">CDM</a>. (The same key may be present in multiple sessions.) Such keys <em class="rfc2119">MUST</em> only
            be provided to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-10">CDM</a> via an <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-1"><code>update</code></a><code>()</code> call. (They may later be
            loaded by <a data-link-type="idl" data-lt="load()" href="#dom-mediakeysession-load" class="internalDFN" id="ref-for-dom-mediakeysession-load-1"><code>load</code></a><code>()</code> as part of the stored session data.)
          </p>
          <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="3"><span>Note</span></div><p class="">
            Authors <em class="rfc2119">SHOULD</em> encrypt each set of stream(s) that requires enforcement of a
            meaningfully different policy with a distinct key (and key ID). For example, if
            policies may differ between two video resolutions, stream(s) containing one resolution
            should not be encrypted with the key used to encrypt stream(s) containing the other
            resolution. When encrypted, audio streams <em class="rfc2119">SHOULD NOT</em> use the same key as any video
            stream. This is the only way to ensure enforcement and compatibility across clients.
          </p></div>
        </dd>
        <dt>
          <dfn id="dfn-usable-for-decryption" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Usable For Decryption</dfn>
        </dt>
        <dd>
          <p>
            A key is considered usable for decryption if the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-11">CDM</a> is certain the key is
            currently usable to decrypt one or more blocks of <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="3"><span>Note</span></div><p class="">
            For example, a key is not usable for decryption if its license has expired. Even if its
            license has not expired, a key is not usable for decryption if other conditions (e.g.,
            output protection) for its use are not currently satisfied.
          </p></div>
        </dd>
        <dt>
          <dfn class="export" data-export="" data-lt="Decryption key ID|Key ID" data-plurals="key ids" id="dfn-decryption-key-id" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Key ID</dfn>
        </dt>
        <dd>
          <p>
            A <a data-link-type="dfn|abstract-op" href="#dfn-key-s" class="internalDFN" id="ref-for-dfn-key-s-1">key</a> is associated with a key ID that is a sequence of octets and which uniquely
            identifies the key. The container specifies the ID of the key that can decrypt a block
            or set of blocks within the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>. <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-2">Initialization Data</a>
            <em class="rfc2119">MAY</em> contain key ID(s) to identify the keys that are needed to decrypt the media data.
            However, there is no requirement that Initialization Data contain any or all key IDs
            used in the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> or <a href="https://html.spec.whatwg.org/multipage/#media-resource">media
            resource</a>. <a data-link-type="dfn|abstract-op" href="#dfn-license" class="internalDFN" id="ref-for-dfn-license-1">Licenses</a> provided to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-12">CDM</a> associate each key with a key ID so
            the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-13">CDM</a> can select the appropriate key when decrypting an encrypted block of media
            data.
          </p>
        </dd>
        <dt>
          <dfn data-lt="Known|Known Key" data-plurals="known keys" id="dfn-known" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Known Key</dfn>
        </dt>
        <dd>
          <p>
            A key is considered to be known to a session if the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-14">CDM</a>'s implementation of the
            session contains any information - specifically the <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-3">key ID</a> - about it, regardless
            of whether the actual <a data-link-type="dfn|abstract-op" href="#dfn-key-s" class="internalDFN" id="ref-for-dfn-key-s-2">key</a> is usable or its value is known. Known keys are exposed
            via the <a data-link-type="idl" href="#dom-mediakeysession-keystatuses" class="internalDFN" id="ref-for-dom-mediakeysession-keystatuses-1"><code>keyStatuses</code></a> attribute.
          </p>
          <p>
            Keys are considered known even after they become unusable, such as due to
            <a data-link-type="dfn|abstract-op" href="#dfn-expiration" class="internalDFN" id="ref-for-dfn-expiration-1">expiration</a> or if they are removed but a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-1">record of license destruction</a> is
            available. Keys only become unknown when they are explicitly removed from a session and
            any license release message is acknowledged.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="3"><span>Note</span></div><p class="">
            For example, a key could become unknown if an <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-2"><code>update</code></a><code>()</code> call
            provides a new license that does not include the key and includes instructions to
            replace the license(s) that previously contained the key.
          </p></div>
        </dd>
        <dt>
          <dfn data-plurals="licenses" id="dfn-license" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">License</dfn>
        </dt>
        <dd>
          <p>
            A license is key system-specific state information that includes one or more <a data-link-type="dfn|abstract-op" href="#dfn-key-s" class="internalDFN" id="ref-for-dfn-key-s-3">key(s)</a>
            - each associated with a <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-4">key ID</a> - and potentially other information about key
            usage.
          </p>
        </dd>
        <dt id="initialization-data">
          <dfn class="export" data-export="" id="dfn-initialization-data" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Initialization Data</dfn>
        </dt>
        <dd>
          <div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-7" aria-level="3"><span>Note</span></div><p class="">
            <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-4">Key Systems</a> usually require a block of initialization data containing information
            about the stream to be decrypted before they can construct a license request message.
            This block could be a simple key or content ID or a more complex structure containing
            such information. It <em class="rfc2119">SHOULD</em> always allow unique identification of the <a data-link-type="dfn|abstract-op" href="#dfn-key-s" class="internalDFN" id="ref-for-dfn-key-s-4">key(s)</a> needed
            to decrypt the content. This initialization information <em class="rfc2119">MAY</em> be obtained in some
            application-specific way or provided with the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>.
          </p></div>
          <p>
            Initialization Data is a generic term for container-specific data that is used by a
            <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-15">CDM</a> to generate a license request.
          </p>
          <p>
            The format of the initialization data depends upon the type of container, and
            containers <em class="rfc2119">MAY</em> support more than one format of initialization data. The <dfn class="export" data-export="" id="dfn-initialization-data-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Initialization Data Type</dfn> is a string that indicates the format of the
            accompanying Initialization Data. Initialization Data Type strings are always matched
            case-sensitively. It is <em class="rfc2119">RECOMMENDED</em> that Initialization Data Type strings are
            lower-case ASCII strings.
          </p>
          <p>
            The <cite><a data-matched-text="[[[EME-INITDATA-REGISTRY]]]" href="https://www.w3.org/TR/eme-initdata-registry/">Encrypted Media Extensions Initialization Data Format Registry</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-eme-initdata-registry" title="Encrypted Media Extensions Initialization Data Format Registry">EME-INITDATA-REGISTRY</a></cite>] provides the mapping from
            <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-1">Initialization Data Type</a> string to the specification for each format.
          </p>
          <p>
            When the user agent encounters Initialization Data in the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>, it provides that Initialization Data to the application in the
            <a data-link-type="idl" href="#dom-mediaencryptedevent-initdata" class="internalDFN" id="ref-for-dom-mediaencryptedevent-initdata-1"><code>initData</code></a> attribute of the <a data-link-type="idl" data-lt="encrypted" href="#dfn-encrypted" class="internalDFN" id="ref-for-dfn-encrypted-1"><code><code>encrypted</code></code></a> event. The user agent
            <em class="rfc2119">MUST NOT</em> store the Initialization Data or use its <em>content</em> at the time it is
            encountered. The application provides <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-3">Initialization Data</a> to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-16">CDM</a> via
            <a data-link-type="idl" data-lt="generateRequest()" href="#dom-mediakeysession-generaterequest" class="internalDFN" id="ref-for-dom-mediakeysession-generaterequest-2"><code>generateRequest</code></a><code>()</code>. The user agent <em class="rfc2119">MUST NOT</em> provide <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-4">Initialization Data</a> to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-17">CDM</a> by other means.
          </p>
          <p>
            Initialization Data <em class="rfc2119">MUST</em> be a fixed value for a given set of stream(s) or
            <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>. It <em class="rfc2119">MUST</em> only contain information related to the keys
            required to play a given set of stream(s) or <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>. It <em class="rfc2119">MUST NOT</em> contain application data, client-specific data, user-specific data, or executable
            code.
          </p>
          <p>
            Initialization Data <em class="rfc2119">SHOULD NOT</em> contain Key System-specific data or values.
            Implementations <em class="rfc2119">MUST</em> support the common formats defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-eme-initdata-registry" title="Encrypted Media Extensions Initialization Data Format Registry">EME-INITDATA-REGISTRY</a></cite>]
            for each <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-2">Initialization Data Type</a> they support.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-8"><div role="heading" class="note-title marker" id="h-note-8" aria-level="3"><span>Note</span></div><p class="">
            Use of proprietary formats/contents is discouraged, and supporting or using
            <em>only</em> proprietary formats is strongly discouraged. Proprietary formats should
            only be used with pre-existing content or on pre-existing client devices that do not
            support the common formats.
          </p></div>
        </dd>
        <dt>
          <dfn data-lt="associable|Associable Value" id="dfn-associable" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Associable Value</dfn>
        </dt>
        <dd>
          <p>
            Two or more identifiers or other values are said to be associable if they are identical
            <em>or</em> it is possible - with a reasonable amount of time and effort - to correlate
            or associate them. Otherwise, the values are <dfn id="dfn-non-associable" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">non-associable</dfn>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-9"><div role="heading" class="note-title marker" id="h-note-9" aria-level="3"><span>Note</span></div><div class="">
            <p>
              For example, values created in the following ways are <a data-link-type="dfn|abstract-op" href="#dfn-associable" class="internalDFN" id="ref-for-dfn-associable-1">associable</a>:
            </p>
            <ul>
              <li>
                <p>
                  Using a trivially-reversible hash function.
                </p>
              </li>
              <li>
                <p>
                  Sharing a prefix or other subset
                </p>
              </li>
              <li>
                <p>
                  Replacing random value N with N+10
                </p>
              </li>
              <li>
                <p>
                  XORing the origin with a fixed value (because it is trivially reversible)
                </p>
              </li>
            </ul>
            <p>
              In contrast, two values that are completely unrelated or cryptographically distinct,
              such as via a cryptographically strong non-reversible hash function, are
              <a data-link-type="dfn|abstract-op" href="#dfn-non-associable" class="internalDFN" id="ref-for-dfn-non-associable-1">non-associable</a>
            </p>
          </div></div>
          <p>
            Two or more identifiers or other values are said to be <dfn id="dfn-associable-by-an-entity" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">associable by an
            entity</dfn> if it is possible - with a reasonable amount of time and effort - for the
            referenced entity or set of entities to correlate or associate them without
            participation of additional entity(ies). Otherwise, the values are <dfn id="dfn-non-associable-by-an-entity" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">non-associable
            by an entity</dfn>.
          </p>
          <p>
            Two or more identifiers or other values are said to be <dfn data-lt="non-associable by application|non-associable by the application" data-plurals="non-associable by applications" id="dfn-non-associable-by-application" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">non-associable by the application</dfn> if they are
            <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-an-entity" class="internalDFN" id="ref-for-dfn-non-associable-by-an-entity-1">non-associable by an entity</a> where the entity is the set that includes the
            application, all other applications, and other entities such as servers that they use
            or with which they communicate. Otherwise, the values would be considered
            <dfn id="dfn-associable-by-the-application" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">associable by the application</dfn>, which is forbidden.
          </p>
        </dd>
        <dt>
          <dfn data-lt="distinctive|Distinctive Value" data-plurals="distinctive values" id="dfn-distinctive" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Distinctive Value</dfn>
        </dt>
        <dd>
          <p>
            A Distinctive Value is a value, piece of data, implication of the possession of a piece
            of data, or an observable behavior or timing that is <em>not</em> shared across a large
            population of users or client devices. A Distinctive Value may be in memory or
            persisted.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-10"><div role="heading" class="note-title marker" id="h-note-10" aria-level="3"><span>Note</span></div><div class="">
            <p>
              Examples of Distinctive Values include but are not limited to:
            </p>
            <ul>
              <li>
                <p>
                  <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-1">Distinctive Identifiers</a>
                </p>
              </li>
              <li>
                <p>
                  <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-1">Distinctive Permanent Identifiers</a>
                </p>
              </li>
              <li>
                <p>
                  Other identifiers
                </p>
              </li>
              <li>
                <p>
                  <a data-link-type="dfn|abstract-op" href="#dfn-session-id" class="internalDFN" id="ref-for-dfn-session-id-1">Session IDs</a>
                </p>
              </li>
              <li>
                <p>
                  <a data-link-type="dfn|abstract-op" href="#dfn-license" class="internalDFN" id="ref-for-dfn-license-2">Licenses</a>
                </p>
              </li>
              <li>
                <p>
                  Other session data
                </p>
              </li>
            </ul>
          </div></div>
          <div class="note" role="note" id="issue-container-generatedID-11"><div role="heading" class="note-title marker" id="h-note-11" aria-level="3"><span>Note</span></div><p class="">
            While a Distinctive Value is typically unique to a user or client device, a value does
            not need to be strictly unique to be distinctive. For example, a value shared among a
            small number of users could still be distinctive.
          </p></div>
        </dd>
        <dt>
          <dfn data-lt="Permanent Identifier(s)|Permanent Identifier" data-plurals="permanent identifiers" id="dfn-permanent-identifier-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Permanent Identifier</dfn>
        </dt>
        <dd>
          <p>
            A Permanent Identifier is a value, piece of data, implication of the possession of a
            piece of data, or an observable behavior or timing that is indelible in some way or
            otherwise non-trivial for the user to remove, reset, or change. This includes but is
            not limited to:
          </p>
          <ul>
            <li>
              <p>
                A hardware or hardware-based identifier
              </p>
            </li>
            <li>
              <p>
                A value provisioned in the hardware device in the factory
              </p>
            </li>
            <li>
              <p>
                A value associated with or derived from the operating system installation instance
              </p>
            </li>
            <li>
              <p>
                A value associated with or derived from the user agent installation instance
              </p>
            </li>
            <li>
              <p>
                A value associated with or derived from the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-18">CDM</a> or other software component
              </p>
            </li>
            <li>
              <p>
                A value in a configuration file or similar semi-permanent data, even if generated
                on the client
              </p>
            </li>
            <li>
              <p>
                Client or other user account values
              </p>
            </li>
          </ul>
          <p>
            A <dfn data-lt="Distinctive Permanent Identifier(s)|Distinctive Permanent Identifier" data-plurals="distinctive permanent identifiers" id="dfn-distinctive-permanent-identifier-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Distinctive Permanent
            Identifier</dfn> is a <a data-link-type="dfn|abstract-op" href="#dfn-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-permanent-identifier-s-1">Permanent Identifier</a> that is <a data-link-type="dfn|abstract-op" href="#dfn-distinctive" class="internalDFN" id="ref-for-dfn-distinctive-1">distinctive</a>.
          </p>
          <p>
            When exposed outside the client, Distinctive Permanent Identifiers and values derived
            from or otherwise related to them <em class="rfc2119">MUST</em> be <a href="#encrypt-identifiers">encrypted</a>.
            Distinctive Permanent Identifiers <em class="rfc2119">MUST NOT</em> ever be exposed to the application, even in
            encrypted form.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-12"><div role="heading" class="note-title marker" id="h-note-12" aria-level="3"><span>Note</span></div><p class="">
            While a Distinctive Permanent Identifier is typically unique to a user or client
            device, a Distinctive Permanent Identifier does not need to be strictly unique to be
            distinctive. For example, a Distinctive Permanent Identifier shared among a small
            number of users could still be distinctive.
          </p></div>
          <div class="note" role="note" id="issue-container-generatedID-13"><div role="heading" class="note-title marker" id="h-note-13" aria-level="3"><span>Note</span></div><p class="">
            A Distinctive Permanent Identifier is <em>not</em> a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-2">Distinctive Identifier</a> because
            it is not derived or generated (within the scope of this specification).
          </p></div>
          <div class="note" role="note" id="issue-container-generatedID-14"><div role="heading" class="note-title marker" id="h-note-14" aria-level="3"><span>Note</span></div><p class="">
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-1"><code>distinctiveIdentifier</code></a> controls whether Distinctive
            Permanent Identifiers may be used. Specifically, Distinctive Permanent Identifiers may
            only be used when the value of the
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-2"><code>distinctiveIdentifier</code></a> member of the
            <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-1"><code>MediaKeySystemAccess</code></a> used to create the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-4"><code>MediaKeys</code></a> object is
            "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-1"><code>required</code></a>".
          </p></div>
        </dd>
        <dt>
          <dfn data-lt="Distinctive Identifier(s)|Distinctive Identifier" data-plurals="distinctive identifiers" id="dfn-distinctive-identifier-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Distinctive Identifier</dfn>
        </dt>
        <dd>
          <div class="note" role="note" id="issue-container-generatedID-15"><div role="heading" class="note-title marker" id="h-note-15" aria-level="3"><span>Note</span></div><div class="">
            <p>
              A Distinctive Identifier is a value, including in opaque or encrypted form, for which
              it is possible for any entity external to the client to correlate or associate values
              beyond what a user may expect on the web platform (e.g., cookies and other site
              data). For example, values that are <a data-link-type="dfn|abstract-op" data-lt="associable by an entity" href="#dfn-associable-by-an-entity" class="internalDFN" id="ref-for-dfn-associable-by-an-entity-1">associable by an entity other than the application</a> across a) <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origins</a>, b) <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-1">browsing profiles</a>, or c)
              browsing sessions even after the user has attempted to protect his or her privacy by
              clearing browsing data or values for which it is not easy for a user to break such
              association. In particular, a value is a Distinctive Identifier if it is possible for
              a <a data-link-type="dfn|abstract-op" data-lt="associable by an entity" href="#dfn-associable-by-an-entity" class="internalDFN" id="ref-for-dfn-associable-by-an-entity-2">central server, such as an individualization server, to associate</a> values across origins, such as because the <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-1">individualization</a> requests
              contained a common value, or because values provided in individualization requests
              are <a data-link-type="dfn|abstract-op" data-lt="associable by an entity" href="#dfn-associable-by-an-entity" class="internalDFN" id="ref-for-dfn-associable-by-an-entity-3">associable by such a server</a> even after attempts to
              clear browsing data. Possible causes of this include use of <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-2">Distinctive Permanent Identifier(s)</a> in the individualization process.
            </p>
            <p>
              Distinctive Identifiers exposed to the application, even in encrypted form, <em class="rfc2119">MUST</em>
              adhere to the <a href="#identifier-requirements">identifier requirements</a>,
              including being <a href="#encrypt-identifiers">encrypted</a>, <a href="#per-origin-per-profile-identifiers">unique per origin and profile</a>, and <a href="#allow-identifiers-cleared">clearable</a>.
            </p>
            <p>
              While the instantiation or use of a Distinctive Identifier is triggered by the
              application's use of the APIs defined in this specification, the identifier need not
              be provided to the application to trigger conditions related to Distinctive
              Identifiers. (The <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-3">Distinctive Permanent Identifier(s)</a> <em class="rfc2119">MUST NOT</em> ever be provided
              to the application, even in opaque or encrypted form.)
            </p>
          </div></div>
          <div class="note" role="note" id="issue-container-generatedID-16"><div role="heading" class="note-title marker" id="h-note-16" aria-level="3"><span>Note</span></div><p class="">
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-3"><code>distinctiveIdentifier</code></a> controls whether Distinctive
            Identifiers may be used. Specifically, Distinctive Identifiers may only be used when
            the value of the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-4"><code>distinctiveIdentifier</code></a> member of the
            <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-2"><code>MediaKeySystemAccess</code></a> used to create the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-5"><code>MediaKeys</code></a> object is
            "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-2"><code>required</code></a>".
          </p></div>
          <p>
            A Distinctive Identifier is a value, piece of data, implication of the possession of a
            piece of data, or an observable behavior or timing for which all of the following
            criteria hold:
          </p>
          <ul>
            <li>
              <p>
                It is <a data-link-type="dfn|abstract-op" href="#dfn-distinctive" class="internalDFN" id="ref-for-dfn-distinctive-2">distinctive</a>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-17"><div role="heading" class="note-title marker" id="h-note-17" aria-level="3"><span>Note</span></div><p class="">
                While a Distinctive Identifier is typically unique to a user or client device, an
                identifier does not need to be strictly unique to be distinctive. For example, an
                identifier shared among a small number of users could still be distinctive.
              </p></div>
            </li>
            <li>
              <p>
                It, information about it, or values derived from or otherwise related to it are
                exposed, even in encrypted form, outside the client. This includes but is not
                limited to providing it to the application and/or license, <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-2">individualization</a>,
                or other server.
              </p>
            </li>
            <li>
              <p>
                It has one or more the following properties:
              </p>
              <ul>
                <li>
                  <p>
                    It is derived from one or more <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-4">Distinctive Permanent Identifier(s)</a>.
                  </p>
                </li>
                <li>
                  <p>
                    The generation, <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-3">individualization</a>, provisioning or other process that
                    produced the value involved, used, provided, derived from, or similarly
                    involved one or more <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-5">Distinctive Permanent Identifier(s)</a> or another
                    Distinctive Identifier.
                  </p>
                </li>
                <li>
                  <p>
                    It is <a href="#allow-identifiers-cleared">clearable</a> but not <a href="#allow-persistent-data-cleared-with-cookies">along with cookies and other site
                    data</a>.
                  </p>
                  <div class="note" role="note" id="issue-container-generatedID-18"><div role="heading" class="note-title marker" id="h-note-18" aria-level="3"><span>Note</span></div><p class="">
                    For example, via some mechanism external to the user agent, such as an OS-level
                    mechanism.
                  </p></div>
                </li>
              </ul>
              <div class="note" role="note" id="issue-container-generatedID-19"><div role="heading" class="note-title marker" id="h-note-19" aria-level="3"><span>Note</span></div><div class="">
                <p>
                  Other properties of concern that are normatively prohibited for values exposed to
                  the application include:
                </p>
                <ul>
                  <li>
                    <p>
                      It is a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-6">Distinctive Permanent Identifier</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      It is <em>not</em> <a href="#allow-identifiers-cleared">clearable</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Value(s) created after <a href="#allow-identifiers-cleared">clearing
                      identifier(s)</a> may be <a data-link-type="dfn|abstract-op" href="#dfn-associable-by-the-application" class="internalDFN" id="ref-for-dfn-associable-by-the-application-1">associable by the application</a> with previous
                      value(s).
                    </p>
                  </li>
                  <li>
                    <p>
                      Values may not be <a href="#per-origin-per-profile-identifiers">unique per
                      origin and profile</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Values for different origins may be <a data-link-type="dfn|abstract-op" href="#dfn-associable-by-the-application" class="internalDFN" id="ref-for-dfn-associable-by-the-application-2">associable by the application</a>.
                    </p>
                  </li>
                </ul>
                <p>
                  Examples of such normatively prohibited values include but is not limited to:
                </p>
                <ul>
                  <li>
                    <p>
                      A single hardware-based value used for all origins.
                    </p>
                  </li>
                  <li>
                    <p>
                      A single random based value used for all origins.
                    </p>
                  </li>
                  <li>
                    <p>
                      A single value obtained from an <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-4">individualization</a> process that is used
                      for all origins.
                    </p>
                  </li>
                  <li>
                    <p>
                      Values that include all or part of any of the above values.
                    </p>
                  </li>
                  <li>
                    <p>
                      A single value that is used for multiple but not all origins.
                    </p>
                  </li>
                  <li>
                    <p>
                      A single value that is used for all origins on a domain. (Identifiers must be
                      per-<a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>.)
                    </p>
                  </li>
                  <li>
                    <p>
                      A pre-provisioned origin-specific value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Values generated by trivially-reversible means, which are thus <a data-link-type="dfn|abstract-op" href="#dfn-associable-by-the-application" class="internalDFN" id="ref-for-dfn-associable-by-the-application-3">associable by the application</a>, regardless of whether generated on the client or
                      involving an <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-5">individualization</a> process. For example, XORing or otherwise
                      integrating (part of) the origin with a fixed value.
                    </p>
                  </li>
                </ul>
              </div></div>
            </li>
          </ul>
          <div class="note" role="note" id="issue-container-generatedID-20"><div role="heading" class="note-title marker" id="h-note-20" aria-level="3"><span>Note</span></div><p class="">
            While Distinctive Identifier are usually <a data-link-type="dfn|abstract-op" data-lt="associable by an entity" href="#dfn-associable-by-an-entity" class="internalDFN" id="ref-for-dfn-associable-by-an-entity-4">associable by the entity that generated them</a> they <em class="rfc2119">MUST</em> be <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-1">non-associable by applications</a>. In other
            words, such correlation or association is only possible by the entity, such as an
            <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-6">individualization</a> server, that originally generated the Distinctive Identifier
            values. Entities with access to the <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-7">Distinctive Permanent Identifier(s)</a> <em class="rfc2119">MUST NOT</em>
            expose this capability to applications, as this would make resulting Distinctive
            Identifiers <a data-link-type="dfn|abstract-op" href="#dfn-associable-by-the-application" class="internalDFN" id="ref-for-dfn-associable-by-the-application-4">associable by the application</a>, and <em class="rfc2119">SHOULD</em> take care to avoid exposing
            such correlation to other entities or third parties.
          </p></div>
          <div class="note" role="note" id="issue-container-generatedID-21"><div role="heading" class="note-title marker" id="h-note-21" aria-level="3"><span>Note</span></div><div class="">
            <p>
              Examples of Distinctive Identifiers include but are not limited to:
            </p>
            <ul>
              <li>
                <p>
                  A series of bytes that is included in key requests, different from the series of
                  bytes included by other client devices, and based on or was acquired directly or
                  indirectly using a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-8">Distinctive Permanent Identifier</a>.
                </p>
              </li>
              <li>
                <p>
                  A public key included in key requests that is different from the public keys
                  included in the requests by other client devices and is based on or was acquired
                  directly or indirectly using a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-9">Distinctive Permanent Identifier</a>.
                </p>
              </li>
              <li>
                <p>
                  Demonstration of possession of a private key (e.g., by signing some data) that
                  other client devices do not have and is based on or was acquired directly or
                  indirectly using a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-10">Distinctive Permanent Identifier</a>.
                </p>
              </li>
              <li>
                <p>
                  An identifier for such a key.
                </p>
              </li>
              <li>
                <p>
                  Such a value used to derive another value that is exposed even though the first
                  value is not directly exposed.
                </p>
              </li>
              <li>
                <p>
                  A value derived from another Distinctive Identifier.
                </p>
              </li>
              <li>
                <p>
                  A random value that was reported to a (e.g., <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-7">individualization</a>) server along
                  with a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-11">Distinctive Permanent Identifier</a> or provided by such a server after
                  providing a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-12">Distinctive Permanent Identifier</a>.
                </p>
              </li>
              <li>
                <p>
                  A value derived from a unique value provisioned in the hardware device in the
                  factory.
                </p>
              </li>
              <li>
                <p>
                  A value derived from a unique hardware value (e.g., MAC address or serial number)
                  or software value (e.g., operating system installation instance or operating
                  system user account name) in the hardware device in the factory.
                </p>
              </li>
              <li>
                <p>
                  A value derived from a unique value embedded in the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-19">CDM</a> binary or other file
                  used by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-20">CDM</a>.
                </p>
              </li>
            </ul>
            <p>
              Examples of things that are <em>not</em> Distinctive Identifiers:
            </p>
            <ul>
              <li>
                <p>
                  A public key shared among all copies of a given <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-21">CDM</a> version if the installed
                  base is large.
                </p>
              </li>
              <li>
                <p>
                  A nonce or ephemeral key that is unique but used in only one session.
                </p>
              </li>
              <li>
                <p>
                  A value that is not exposed, even in derived or similar ways, outside the client,
                  including via <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-8">individualization</a> or similar.
                </p>
              </li>
              <li>
                <p>
                  Device-unique keys used in attestations between, for example, the video pipeline
                  and the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-22">CDM</a> when the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-23">CDM</a> does not let these attestations further flow to
                  the application and instead makes a new attestation on its own using a key that
                  does not constitute a Distinctive Identifier.
                </p>
              </li>
              <li>
                <p>
                  A value that is fully cleared/clearable along with browsing data, such as
                  cookies, after which it will be replaced by a value that is <a data-link-type="dfn|abstract-op" href="#dfn-non-associable" class="internalDFN" id="ref-for-dfn-non-associable-2">non-associable</a>]
                  (not just <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-2">non-associable by applications</a>), even by a central server such as
                  an <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-9">individualization</a> server, AND one or more of the following:
                </p>
                <ul>
                  <li>
                    <p>
                      No <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-13">Distinctive Permanent Identifier</a> or Distinctive Identifier was
                      involved in the generation of the value.
                    </p>
                  </li>
                  <li>
                    <p>
                      It is a random value generated <em>without</em> inputs from the system.
                    </p>
                  </li>
                  <li>
                    <p>
                      It is a value provided by a server without the use of or knowledge of another
                      Distinctive Identifier.
                    </p>
                  </li>
                </ul>
              </li>
            </ul>
          </div></div>
        </dd>
        <dt>
          <dfn class="lint-ignore" id="dfn-use-of-distinctive-identifiers-and-distinctive-permanent-identifiers" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Use of Distinctive Identifiers and Distinctive Permanent
          Identifiers</dfn>
        </dt>
        <dd>
          <p>
            An implementation, configuration, instance, or object <dfn data-lt="use Distinctive Identifier(s)|use of Distinctive Identifier(s)|uses Distinctive Identifier(s)" id="dfn-use-distinctive-identifier-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">uses Distinctive
            Identifier(s)</dfn> if, at any time during its lifetime or the lifetime of related such
            entities, it exposes, even in encrypted form, one or more <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-3">Distinctive Identifier(s)</a>, information about them, or values derived from or otherwise related to
            them outside the client. This includes but is not limited to providing such a value to
            the application and/or license, <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-10">individualization</a>, or other server.
          </p>
          <p>
            An implementation, configuration, instance, or object <dfn data-lt="use Distinctive Permanent Identifier(s)|using Distinctive Permanent Identifier(s)|uses Distinctive Permanent Identifier(s)" id="dfn-use-distinctive-permanent-identifier-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">uses
            Distinctive Permanent Identifier(s)</dfn> if, at any time during its lifetime or the
            lifetime of related such entities, it exposes, even in encrypted form, one or more
            <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-14">Distinctive Permanent Identifier(s)</a>, information about them, or values derived from
            or otherwise related to them outside the client. This includes but is not limited to
            providing such a value to an <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-11">individualization</a> server. Such values <em class="rfc2119">MUST NOT</em> be
            provided to the application.
          </p>
          <p>
            An implementation, configuration, instance, or object <dfn data-lt="use Distinctive Identifier(s) or Distinctive Permanent Identifier(s)|use of Distinctive Identifier(s) or Distinctive Permanent Identifier(s)|using Distinctive Identifier(s) or Distinctive Permanent Identifier(s)|uses Distinctive Identifier(s) or Distinctive Permanent Identifier(s)" id="dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
            uses Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</dfn> if it
            <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-1">uses Distinctive Identifier(s)</a> and/or <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-permanent-identifier-s-1">uses Distinctive Permanent Identifier(s)</a>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-22"><div role="heading" class="note-title marker" id="h-note-22" aria-level="3"><span>Note</span></div><p class="">
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-5"><code>distinctiveIdentifier</code></a> controls whether <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-4">Distinctive Identifiers</a> and <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-15">Distinctive Permanent Identifiers</a> may be used. Specifically, such
            identifiers may only be used when the value of the
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-6"><code>distinctiveIdentifier</code></a> member of the
            <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-3"><code>MediaKeySystemAccess</code></a> used to create the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-6"><code>MediaKeys</code></a> object is
            "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-3"><code>required</code></a>".
          </p></div>
        </dd>
        <dt>
          <dfn class="lint-ignore" id="dfn-cross-origin-limitations" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Cross Origin Limitations</dfn>
        </dt>
        <dd>
          <p>
            During playback, embedded media data is exposed to script in the embedding <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>.
            In order for the API to provide <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-5">Initialization Data</a> in the <a data-link-type="idl" data-lt="encrypted" href="#dfn-encrypted" class="internalDFN" id="ref-for-dfn-encrypted-2"><code><code>encrypted</code></code></a> event,
            <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> <em class="rfc2119">MUST</em> be <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-same-origin">CORS-same-origin</a> with the embedding page.
            If <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> is cross-origin with the embedding document, authors
            <em class="rfc2119">SHOULD</em> use the <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-crossorigin"><code>crossOrigin</code></a> attribute on the <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-3"><code>HTMLMediaElement</code></a>
            and CORS headers on the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> response to make it
            <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-same-origin">CORS-same-origin</a>.
          </p>
        </dd>
        <dt>
          <dfn id="dfn-mixed-content-limitations" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Mixed Content Limitations</dfn>
        </dt>
        <dd>
          <p>
            During playback, embedded media data is exposed to script in the embedding <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>.
            In order for the API to provide <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-6">Initialization Data</a> in the <a data-link-type="idl" data-lt="encrypted" href="#dfn-encrypted" class="internalDFN" id="ref-for-dfn-encrypted-3"><code><code>encrypted</code></code></a> event,
            <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> <em class="rfc2119">MUST NOT</em> be <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://www.w3.org/TR/mixed-content/#mixed-content">Mixed Content</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-mixed-content" title="Mixed Content">MIXED-CONTENT</a></cite>].
          </p>
        </dd>
        <dt>
          <dfn id="dfn-time" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Time</dfn>
        </dt>
        <dd>
          <p>
            Time <em class="rfc2119">MUST</em> be equivalent to that represented in <a class="external" href="https://tc39.github.io/ecma262/#sec-time-values-and-time-range">ECMAScript
            <span class="estype">Time Values and Time Range</span></a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-ecma-262" title="ECMAScript Language Specification">ECMA-262</a></cite>].
          </p>
          <p>
            Time will equal <code>NaN</code> if no such time exists or if the time is
            indeterminate. It should never have the value <code>Infinity</code>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-23"><div role="heading" class="note-title marker" id="h-note-23" aria-level="3"><span>Note</span></div><p class="">
            Time generally represents an instant in time with millisecond accuracy; however, that
            alone is not a sufficient definition. The defined Time Values and Time Range reference
            adds other important requirements.
          </p></div>
        </dd>
        <dt>
          <dfn data-lt="expiration|Expiration Time" id="dfn-expiration" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Expiration Time</dfn>
        </dt>
        <dd>
          <p>
            The <a data-link-type="dfn|abstract-op" href="#dfn-time" class="internalDFN" id="ref-for-dfn-time-1">time</a> after which key(s) will no longer be <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-2">usable for decryption</a>.
          </p>
        </dd>
        <dt>
          <dfn data-plurals="browsing profiles" id="dfn-browsing-profile" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Browsing Profile</dfn>
        </dt>
        <dd>
          <p>
            A User Agent on a given machine may support execution in a variety of different
            contexts or modes or temporary states that are expected to behave independently with
            respect to application-visible state and data. In particular, all stored data is
            expected to be independent. In this specification we refer to such independent contexts
            or modes as "Browsing Profiles".
          </p>
          <div class="note" role="note" id="issue-container-generatedID-24"><div role="heading" class="note-title marker" id="h-note-24" aria-level="3"><span>Note</span></div><p class="">
            Examples of such independent contexts include if the user agent is running in different
            operating system user accounts or if the user agent provides the capability to define
            multiple independent profiles for a single account.
          </p></div>
        </dd>
        <dt>
          <dfn id="dfn-valid-media-mime-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Valid Media MIME Type</dfn>
        </dt>
        <dd>
          <p>
            A valid media MIME type is a media <a href="https://html.spec.whatwg.org/multipage/#mime-types">MIME type</a> that is
            also a <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://mimesniff.spec.whatwg.org/#valid-mime-type">valid MIME type string</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-mimesniff" title="MIME Sniffing Standard">mimesniff</a></cite>]. When a MIME type includes parameters,
            such as <code>"codecs"</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6381" title="The 'Codecs' and 'Profiles' Parameters for &quot;Bucket&quot; Media Types">RFC6381</a></cite>], such parameters <em class="rfc2119">MUST</em> also be valid per the relevant
            specification.
          </p>
          <p>
            When used with the features defined in this specification, MIME type strings <em class="rfc2119">SHOULD</em>
            explicitly specify codecs and codec constraints (e.g., per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6381" title="The 'Codecs' and 'Profiles' Parameters for &quot;Bucket&quot; Media Types">RFC6381</a></cite>]) unless these
            are normatively implied by the container.
          </p>
        </dd>
      </dl>
    </section>
    <section id="obtaining-access-to-key-systems"><div class="header-wrapper"><h2 id="x3-obtaining-access-to-key-systems"><bdi class="secno">3. </bdi>
        Obtaining Access to Key Systems
      </h2><a class="self-link" href="#obtaining-access-to-key-systems" aria-label="Permalink for Section 3."></a></div>
      
      <p>
        This section defines the mechanism for obtaining access to a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-5">Key System</a>. The inclusion
        of capabilities in the request also enables feature detection.
      </p>
      <p>
        The steps of an algorithm are always aborted when rejecting a promise.
      </p>
      <section id="permissions-policy-integration"><div class="header-wrapper"><h3 id="x3-1-permissions-policy-integration"><bdi class="secno">3.1 </bdi>
          Permissions Policy Integration
        </h3><a class="self-link" href="#permissions-policy-integration" aria-label="Permalink for Section 3.1"></a></div>
        
        <p>
          <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-1"><code>requestMediaKeySystemAccess</code></a><code>()</code> is a <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://www.w3.org/TR/permissions-policy-1/#policy-controlled-feature">policy-controlled feature</a> identified
          by the string <code><dfn id="dfn-encrypted-media" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">encrypted-media</dfn></code>. Its <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://www.w3.org/TR/permissions-policy-1/#policy-controlled-feature-default-allowlist">default allowlist</a> is <code>'self'</code> [<cite><a class="bibref" data-link-type="biblio" href="#bib-permissions-policy" title="Permissions Policy">PERMISSIONS-POLICY</a></cite>].
        </p>
      </section>
      <section data-dfn-for="Navigator" id="navigator-extension-requestmediakeysystemaccess"><div class="header-wrapper"><h3 id="x3-2-navigator-extension-requestmediakeysystemaccess"><bdi class="secno">3.2 </bdi>
          <dfn id="dom-navigator" data-idl="interface" data-title="Navigator" data-dfn-for="" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code>Navigator</code></dfn> Extension: <code>requestMediaKeySystemAccess()</code>
        </h3><a class="self-link" href="#navigator-extension-requestmediakeysystemaccess" aria-label="Permalink for Section 3.2"></a></div>
        
        <pre class="idl def" id="webidl-571417346"><span class="idlHeader"><a class="self-link" href="#webidl-571417346">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-navigator-partial-1" data-title="Navigator">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-navigator" id="ref-for-dom-navigator-1"><code>Navigator</code></a> {<span data-idl="" class="idlMethod" id="idl-def-navigator-requestmediakeysystemaccess-keysystem-supportedconfigurations" data-title="requestMediaKeySystemAccess" data-dfn-for="Navigator">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>]<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-4"><code>MediaKeySystemAccess</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-navigator-requestmediakeysystemaccess" id="ref-for-dom-navigator-requestmediakeysystemaccess-2"><code>requestMediaKeySystemAccess</code></a> (<span class="idlType">
      <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">keySystem</span>,<span class="idlType">
      <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-1"><code>MediaKeySystemConfiguration</code></a>&gt;</span> <span class="idlParamName">supportedConfigurations</span>);</span>
};</span></code></pre>
        <section id="methods"><div class="header-wrapper"><h4 id="x3-2-1-methods"><bdi class="secno">3.2.1 </bdi>
            Methods
          </h4><a class="self-link" href="#methods" aria-label="Permalink for Section 3.2.1"></a></div>
          
          <dl class="methods">
            <dt>
              <dfn data-export="" data-dfn-type="method" id="dom-navigator-requestmediakeysystemaccess" data-idl="operation" data-title="requestMediaKeySystemAccess()" data-dfn-for="Navigator" data-type="Promise" data-lt="requestMediaKeySystemAccess()|requestMediaKeySystemAccess(keySystem, supportedConfigurations)" data-local-lt="Navigator.requestMediaKeySystemAccess|Navigator.requestMediaKeySystemAccess()|requestMediaKeySystemAccess" tabindex="0" aria-haspopup="dialog"><code>requestMediaKeySystemAccess()</code></dfn>
            </dt>
            <dd>
              <div class="note" role="note" id="issue-container-generatedID-25"><div role="heading" class="note-title marker" id="h-note-25" aria-level="5"><span>Note</span></div><p class="">
                Calling this method may have <em>user-visible effects</em>, including requests for
                user consent. This method should only be called when the author intends to create
                and use a <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-7"><code>MediaKeys</code></a> object with the provided configuration.
              </p></div>
              <p>
                Requests access to the specified <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-6">Key System</a>. When
                <code>supportedConfigurations</code> is specified, the configuration specified by
                at least one of its elements must be supported. The resulting
                <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-5"><code>MediaKeySystemAccess</code></a> will correspond to the first such element.
              </p>
              <p>
                Any permission checks or user interaction, such as a prompt for consent, <em class="rfc2119">MUST</em> be
                performed before resolving the promise.
              </p>
              <p>
                If the <code>keySystem</code> is not supported or not allowed (in at least one of
                the <code>supportedConfigurations</code>, if specified), the promise is rejected.
                Otherwise, it is resolved with a new <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-6"><code>MediaKeySystemAccess</code></a> object.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-26"><div role="heading" class="note-title marker" id="h-note-26" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  This method is only exposed to <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context">secure contexts</a> as indicated by the
                  <code>[SecureContext]</code> IDL attribute.
                </p>
                <p>
                  Requiring Secure Contexts is <em>not</em> a replacement for other security- and
                  privacy-related requirements and recommendations. Implementations <em class="rfc2119">MUST</em> meet all
                  related requirements and <em class="rfc2119">SHOULD</em> follow related recommendations such that the
                  risks on in an secure context would be similar.
                </p>
              </div></div>
              <p>
                When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
              </p>
              <ol class="method-algorithm">
                
                <li>
                  <p>
                    If <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#this">this</a>'s <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>'s <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window">associated Document</a> is not
                    <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use">allowed to use</a> the <a href="#dfn-encrypted-media" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-encrypted-media-1"><code><code>encrypted-media</code></code></a> feature, then
                    throw a "<a data-link-type="idl" data-lt="SecurityError" data-type="exception" href="https://webidl.spec.whatwg.org/#securityerror"><code>SecurityError</code></a>" <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> and abort these steps.
                  </p>
                </li>
                <li>
                  <p>
                    If <var>keySystem</var> is the empty string, return a promise rejected with a
                    newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-1"><code><code>TypeError</code></code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    If <var>supportedConfigurations</var> is empty, return a promise rejected with
                    a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-2"><code><code>TypeError</code></code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>document</var> be the calling context's <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>origin</var> be the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of <var>document</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>promise</var> be a new promise.
                  </p>
                </li>
                <li>
                  <p>
                    Run the following steps in parallel:
                  </p>
                  <ol>
                    <li>
                      <p>
                        If <var>keySystem</var> is not one of the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-7">Key Systems</a> supported by the
                        user agent, reject <var>promise</var> with a <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-1"><code><code>NotSupportedError</code></code></a>. String
                        comparison is case-sensitive.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>implementation</var> be the implementation of
                        <var>keySystem</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        For each value in <code>supportedConfigurations</code>:
                      </p>
                      <ol>
                        <li>
                          <p>
                            Let <var>candidate configuration</var> be the value.
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>supported configuration</var> be the result of executing the
                            <a data-link-type="dfn|abstract-op" href="#dfn-get-supported-configuration" class="internalDFN" id="ref-for-dfn-get-supported-configuration-1">Get Supported Configuration</a> algorithm on <var>implementation</var>,
                            <var>candidate configuration</var>, and <var>origin</var>.
                          </p>
                        </li>
                        <li>
                          <p>
                            If <var>supported configuration</var> is not <code>NotSupported</code>,
                            run the following steps:
                          </p>
                          <ol>
                            <li>
                              <p>
                                Let <var>access</var> be a new <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-7"><code>MediaKeySystemAccess</code></a> object, and
                                initialize it as follows:
                              </p>
                              <ol>
                                <li>
                                  <p>
                                    Set the <a data-link-type="idl" href="#dom-mediakeysystemaccess-keysystem" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-keysystem-1"><code>keySystem</code></a> attribute to
                                    <var>keySystem</var>.
                                  </p>
                                </li>
                                <li>
                                  <p>
                                    Let the <var>configuration</var> value be <var>supported
                                    configuration</var>.
                                  </p>
                                </li>
                                <li>
                                  <p>
                                    Let the <var>cdm implementation</var> value be
                                    <var>implementation</var>.
                                  </p>
                                </li>
                              </ol>
                            </li>
                            <li>
                              <p>
                                Resolve <var>promise</var> with <var>access</var> and abort the
                                parallel steps of this algorithm.
                              </p>
                            </li>
                          </ol>
                        </li>
                      </ol>
                    </li>
                    <li>
                      <p>
                        Reject <var>promise</var> with a <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-2"><code><code>NotSupportedError</code></code></a>.
                      </p>
                      <div class="note" role="note" id="issue-container-generatedID-27"><div role="heading" class="note-title marker" id="h-note-27" aria-level="5"><span>Note</span></div><p class="">
                        <code>keySystem</code> was not supported/allowed or none of the
                        configurations in <code>supportedConfigurations</code> were
                        supported/allowed.
                      </p></div>
                    </li>
                  </ol>
                </li>
                <li>
                  <p>
                    Return <var>promise</var>.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </section>
        <section id="algorithms"><div class="header-wrapper"><h4 id="x3-2-2-algorithms"><bdi class="secno">3.2.2 </bdi>
            Algorithms
          </h4><a class="self-link" href="#algorithms" aria-label="Permalink for Section 3.2.2"></a></div>
          
          <section id="get-supported-configuration"><div class="header-wrapper"><h5 id="x3-2-2-1-get-supported-configuration"><bdi class="secno">3.2.2.1 </bdi>
              <dfn id="dfn-get-supported-configuration" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Get Supported Configuration</dfn>
            </h5><a class="self-link" href="#get-supported-configuration" aria-label="Permalink for Section 3.2.2.1"></a></div>
            
            <p>
              Given a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-8">Key Systems</a> implementation <var>implementation</var>,
              <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-2"><code>MediaKeySystemConfiguration</code></a> <var>candidate configuration</var>, and
              <var>origin</var>, this algorithm returns a supported configuration or
              <code>NotSupported</code> as appropriate.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-28"><div role="heading" class="note-title marker" id="h-note-28" aria-level="6"><span>Note</span></div><p class="">
              Unrecognized dictionary members in <var>candidate configuration</var> are ignored per
              [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] and will never reach this algorithm. Thus, they cannot be considered as
              part of the configuration.
            </p></div>
            <div class="note" role="note" id="issue-container-generatedID-29"><div role="heading" class="note-title marker" id="h-note-29" aria-level="6"><span>Note</span></div><div class="">
              <p>
                For certain configurations, it may be required to obtain user consent or inform the
                user. User Agents have some flexibility to determine whether consent is required
                for a specific configuration and whether such consent may also apply to other
                configurations. For example, consent to one configuration may also imply consent
                for less powerful, more restricted configurations. Equally, a denial of consent for
                one configuration may imply denial of consent for more powerful, less restricted
                configurations.
              </p>
              <p>
                Supported configurations, including supported audio and video codecs, may depend on
                availability of optional capabilities such as <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-5">Distinctive Identifier(s)</a> and
                persistent state. The following algorithm iteratively tries to find a configuration
                that is both supported and has user consent (or does not need consent).
              </p>
              <p>
                User Agents should reuse earlier consent responses, when appropriate, at least for
                the duration of the <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-3"><code>requestMediaKeySystemAccess</code></a><code>()</code> algorithm in order
                to avoid repeated requests to the user for similar configurations.
              </p>
              <p>
                The variable <var>restrictions</var> in the steps below represents the
                configurations for which consent has been denied during the execution of this
                algorithm or based on persisted consent information for the origin. It is used to
                determine whether user consent for a candidate configuration or accumulated
                configuration has been denied. Consent is denied for a accumulated configuration if
                every derived configuration has already been denied. Internal representation of
                <var>restrictions</var> is implementation-specific.
              </p>
            </div></div>
            <ol>
              <li>
                <p>
                  Let <var>supported configuration</var> be <code>ConsentDenied</code>.
                </p>
              </li>
              <li>
                <p>
                  Initialize <var>restrictions</var> to indicate that no configurations have had
                  user consent denied.
                </p>
              </li>
              <li>
                <p>
                  Repeat the following step while <var>supported configuration</var> is
                  <code>ConsentDenied</code>:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>supported configuration</var> and, if provided,
                      <var>restrictions</var> be the result of executing the <a data-link-type="dfn|abstract-op" href="#dfn-get-supported-configuration-and-consent" class="internalDFN" id="ref-for-dfn-get-supported-configuration-and-consent-1">Get Supported Configuration and Consent</a> algorithm with <var>implementation</var>,
                      <var>candidate configuration</var>, <var>restrictions</var> and
                      <var>origin</var>.
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>supported configuration</var>.
                </p>
              </li>
            </ol>
          </section>
          <section id="get-supported-configuration-and-consent"><div class="header-wrapper"><h5 id="x3-2-2-2-get-supported-configuration-and-consent"><bdi class="secno">3.2.2.2 </bdi>
              <dfn id="dfn-get-supported-configuration-and-consent" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Get Supported Configuration and Consent</dfn>
            </h5><a class="self-link" href="#get-supported-configuration-and-consent" aria-label="Permalink for Section 3.2.2.2"></a></div>
            
            <p>
              Given a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-9">Key Systems</a> implementation <var>implementation</var>,
              <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-3"><code>MediaKeySystemConfiguration</code></a> <var>candidate configuration</var>,
              <var>restrictions</var> and <var>origin</var>, this algorithm returns a supported
              configuration, <code>NotSupported</code>, or <code>ConsentDenied</code> as
              appropriate and, in the <code>ConsentDenied</code> case, <var>restrictions</var>.
            </p>
            <ol>
              <li>
                <p>
                  Let <var>accumulated configuration</var> be a new <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-4"><code>MediaKeySystemConfiguration</code></a>
                  dictionary.
                </p>
              </li>
              <li>
                <p>
                  Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-label" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-label-1"><code>label</code></a> member of <var>accumulated
                  configuration</var> to equal the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-label" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-label-2"><code>label</code></a> member of
                  <var>candidate configuration</var>.
                </p>
              </li>
              <li>
                <p>
                  If the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-initdatatypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-initdatatypes-1"><code>initDataTypes</code></a> member of <var>candidate
                  configuration</var> is non-empty, run the following steps:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>supported types</var> be an empty sequence of <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>s.
                    </p>
                  </li>
                  <li>
                    <p>
                      For each value in <var>candidate configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-initdatatypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-initdatatypes-2"><code>initDataTypes</code></a> member:
                    </p>
                    <ol>
                      <li>
                        <p>
                          Let <var>initDataType</var> be the value.
                        </p>
                      </li>
                      <li>
                        <p>
                          If the <var>implementation</var> supports generating requests based on
                          <var>initDataType</var>, add <var>initDataType</var> to <var>supported
                          types</var>. String comparison is case-sensitive. The empty string is
                          never supported.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-30"><div role="heading" class="note-title marker" id="h-note-30" aria-level="6"><span>Note</span></div><p class="">
                          The <var>initDataType</var> <em class="rfc2119">MUST</em> be supported independent of content
                          types in order to avoid unexpectedly rejecting the configuration in later
                          steps. Support for <var>initDataType</var> includes both license
                          generation and, when appropriate, extraction from media data. See
                          <a href="#initialization-data-type-support-requirements">Initialization
                          Data Type Support requirements</a>.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      If <var>supported types</var> is empty, return <code>NotSupported</code>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-initdatatypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-initdatatypes-3"><code>initDataTypes</code></a> member of
                      <var>accumulated configuration</var> to <var>supported types</var>.
                    </p>
                  </li>
                </ol>
              </li>
              
              <li>
                <p>
                  Let <var>distinctive identifier requirement</var> be the value of <var>candidate
                  configuration</var>'s <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-7"><code>distinctiveIdentifier</code></a>
                  member.
                </p>
              </li>
              <li>
                <p>
                  If <var>distinctive identifier requirement</var> is
                  "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-1"><code>optional</code></a>" and <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-6">Distinctive Identifiers</a> are not
                  allowed according to <var>restrictions</var>, set <var>distinctive identifier
                  requirement</var> to "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-1"><code>not-allowed</code></a>".
                </p>
              </li>
              <li>
                <p>
                  Follow the steps for <var>distinctive identifier requirement</var> from the
                  following list:
                </p>
                <dl class="switch">
                  <dt>
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-4"><code>required</code></a>"
                  </dt>
                  <dd>
                    <p>
                      If the <var>implementation</var> does not support <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-2">use of Distinctive Identifier(s)</a> in combination with <var>accumulated configuration</var> and
                      <var>restrictions</var>, return <code>NotSupported</code>.
                    </p>
                  </dd>
                  <dt>
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-2"><code>optional</code></a>"
                  </dt>
                  <dd>
                    <p>
                      Continue with the following steps.
                    </p>
                  </dd>
                  <dt>
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-2"><code>not-allowed</code></a>"
                  </dt>
                  <dd>
                    <p>
                      If the <var>implementation</var> requires <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-1">use of Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a> in combination with <var>accumulated
                      configuration</var> and <var>restrictions</var>, return
                      <code>NotSupported</code>.
                    </p>
                  </dd>
                </dl>
                <div class="note" role="note" id="issue-container-generatedID-31"><div role="heading" class="note-title marker" id="h-note-31" aria-level="6"><span>Note</span></div><div class="">
                  <p>
                    The combination of <var>accumulated configuration</var> and
                    <var>restrictions</var> means all the possible configurations that include
                    everything in <var>accumulated configuration</var> and that are not denied
                    according to <var>restrictions</var>.
                  </p>
                  <p>
                    A feature is supported by an implementation with this combination if the
                    implementation supports at least one of the configurations in the combination
                    with the feature.
                  </p>
                  <p>
                    A feature is required by an implementtion with this combination if all
                    configurations in the combination that are suported by the implementation
                    include the feature.
                  </p>
                </div></div>
              </li>
              <li>
                <p>
                  Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-8"><code>distinctiveIdentifier</code></a> member of
                  <var>accumulated configuration</var> to equal <var>distinctive identifier
                  requirement</var>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>persistent state requirement</var> be equal to the value of
                  <var>candidate configuration</var>'s
                  <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-1"><code>persistentState</code></a> member.
                </p>
              </li>
              <li>
                <p>
                  If <var>persistent state requirement</var> is "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-3"><code>optional</code></a>"
                  and persisting state is not allowed according to <var>restrictions</var>, set
                  <var>persistent state requirement</var> to
                  "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-3"><code>not-allowed</code></a>".
                </p>
              </li>
              <li>
                <p>
                  Follow the steps for <var>persistent state requirement</var> from the following
                  list:
                </p>
                <dl class="switch">
                  <dt>
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-5"><code>required</code></a>"
                  </dt>
                  <dd>
                    <p>
                      If the <var>implementation</var> does not support persisting state in
                      combination with <var>accumulated configuration</var> and
                      <var>restrictions</var>, return <code>NotSupported</code>.
                    </p>
                  </dd>
                  <dt>
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-4"><code>optional</code></a>"
                  </dt>
                  <dd>
                    <p>
                      Continue with the following steps.
                    </p>
                  </dd>
                  <dt>
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-4"><code>not-allowed</code></a>"
                  </dt>
                  <dd>
                    <p>
                      If the <var>implementation</var> requires persisting state in combination
                      with <var>accumulated configuration</var> and <var>restrictions</var>, return
                      <code>NotSupported</code>.
                    </p>
                  </dd>
                </dl>
              </li>
              <li>
                <p>
                  Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-2"><code>persistentState</code></a> member of
                  <var>accumulated configuration</var> to equal the value of <var>persistent state
                  requirement</var>.
                </p>
              </li>
              <li>
                <p>
                  Follow the steps for the first matching condition from the following list:
                </p>
                <dl class="switch">
                  <dt>
                    If the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-sessiontypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-sessiontypes-1"><code>sessionTypes</code></a> member is
                    <a data-link-type="dfn|abstract-op" data-lt="exist" data-type="dfn" href="https://infra.spec.whatwg.org/#map-exists">present</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra" title="Infra Standard">Infra</a></cite>] in <var>candidate configuration</var>
                  </dt>
                  <dd>
                    <p>
                      Let <var>session types</var> be <var>candidate configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-sessiontypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-sessiontypes-2"><code>sessionTypes</code></a> member.
                    </p>
                  </dd>
                  <dt>
                    Otherwise
                  </dt>
                  <dd>
                    <p>
                      Let <var>session types</var> be <code>[ "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-1"><code>temporary</code></a>"
                      ]</code>.
                    </p>
                  </dd>
                </dl>
              </li>
              <li>
                <p>
                  For each value in <var>session types</var>:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>session type</var> be the value.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-3"><code>persistentState</code></a> value is
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-5"><code>not-allowed</code></a>" and the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-2">Is persistent session type?</a> algorithm returns <code>true</code> for <var>session type</var>
                      return <code>NotSupported</code>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <var>implementation</var> does not support <var>session type</var> in
                      combination with <var>accumulated configuration</var> and
                      <var>restrictions</var> for other reasons, return <code>NotSupported</code>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-4"><code>persistentState</code></a> value is
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-5"><code>optional</code></a>" and the result of running the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-3">Is persistent session type?</a> algorithm on <var>session type</var> is
                      <code>true</code>, change <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-5"><code>persistentState</code></a> value to
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-6"><code>required</code></a>".
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-sessiontypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-sessiontypes-3"><code>sessionTypes</code></a> member of <var>accumulated
                  configuration</var> to <var>session types</var>.
                </p>
              </li>
              <li>
                <p>
                  If the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-1"><code>videoCapabilities</code></a> and
                  <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-audiocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-1"><code>audioCapabilities</code></a> members in <var>candidate
                  configuration</var> are both empty, return <code>NotSupported</code>.
                </p>
              </li>
              <li>
                <dl class="switch">
                  <dt>
                    If the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-2"><code>videoCapabilities</code></a> member in
                    <var>candidate configuration</var> is non-empty:
                  </dt>
                  <dd>
                    <ol>
                      <li>
                        <p>
                          Let <var>video capabilities</var> be the result of executing the <a data-link-type="dfn|abstract-op" href="#dfn-get-supported-capabilities-for-audio-video-type" class="internalDFN" id="ref-for-dfn-get-supported-capabilities-for-audio-video-type-1">Get Supported Capabilities for Audio/Video Type</a> algorithm on Video,
                          <var>candidate configuration</var>'s
                          <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-3"><code>videoCapabilities</code></a> member,
                          <var>accumulated configuration</var>, and <var>restrictions</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If <var>video capabilities</var> is <code>null</code>, return
                          <code>NotSupported</code>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-4"><code>videoCapabilities</code></a> member of
                          <var>accumulated configuration</var> to <var>video capabilities</var>.
                        </p>
                      </li>
                    </ol>
                  </dd>
                  <dt>
                    Otherwise:
                  </dt>
                  <dd>
                    <p>
                      Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-5"><code>videoCapabilities</code></a> member of
                      <var>accumulated configuration</var> to an empty sequence.
                    </p>
                  </dd>
                </dl>
              </li>
              <li>
                <dl class="switch">
                  <dt>
                    If the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-audiocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-2"><code>audioCapabilities</code></a> member in
                    <var>candidate configuration</var> is non-empty:
                  </dt>
                  <dd>
                    <ol>
                      <li>
                        <p>
                          Let <var>audio capabilities</var> be the result of executing the <a data-link-type="dfn|abstract-op" href="#dfn-get-supported-capabilities-for-audio-video-type" class="internalDFN" id="ref-for-dfn-get-supported-capabilities-for-audio-video-type-2">Get Supported Capabilities for Audio/Video Type</a> algorithm on Audio,
                          <var>candidate configuration</var>'s
                          <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-audiocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-3"><code>audioCapabilities</code></a> member,
                          <var>accumulated configuration</var>, and <var>restrictions</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If <var>audio capabilities</var> is <code>null</code>, return
                          <code>NotSupported</code>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-audiocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-4"><code>audioCapabilities</code></a> member of
                          <var>accumulated configuration</var> to <var>audio capabilities</var>.
                        </p>
                      </li>
                    </ol>
                  </dd>
                  <dt>
                    Otherwise:
                  </dt>
                  <dd>
                    <p>
                      Set the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-audiocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-5"><code>audioCapabilities</code></a> member of
                      <var>accumulated configuration</var> to an empty sequence.
                    </p>
                  </dd>
                </dl>
              </li>
              
              <li>
                <p>
                  If <var>accumulated configuration</var>'s
                  <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-9"><code>distinctiveIdentifier</code></a> value is
                  "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-6"><code>optional</code></a>", follow the steps for the first matching
                  condition from the following list:
                </p>
                <dl class="switch">
                  <dt>
                    If the <var>implementation</var> requires <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-2">use of Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a> for any of the combinations in
                    <var>accumulated configuration</var>:
                  </dt>
                  <dd>
                    <p>
                      Change <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-10"><code>distinctiveIdentifier</code></a> value to
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-7"><code>required</code></a>".
                    </p>
                  </dd>
                  <dt>
                    Otherwise
                  </dt>
                  <dd>
                    <p>
                      Change <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-11"><code>distinctiveIdentifier</code></a> value to
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-6"><code>not-allowed</code></a>".
                    </p>
                  </dd>
                </dl>
              </li>
              <li>
                <p>
                  If <var>accumulated configuration</var>'s
                  <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-6"><code>persistentState</code></a> value is
                  "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-7"><code>optional</code></a>", follow the steps for the first matching
                  condition from the following list:
                </p>
                <dl class="switch">
                  <dt>
                    If the <var>implementation</var> requires persisting state for any of the
                    combinations in <var>accumulated configuration</var>
                  </dt>
                  <dd>
                    <p>
                      Change <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-7"><code>persistentState</code></a> value to
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-8"><code>required</code></a>".
                    </p>
                  </dd>
                  <dt>
                    Otherwise
                  </dt>
                  <dd>
                    <p>
                      Change <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-8"><code>persistentState</code></a> value to
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-7"><code>not-allowed</code></a>".
                    </p>
                  </dd>
                </dl>
              </li>
              <li>
                <p>
                  If <var>implementation</var> in the configuration specified by the combination of
                  the values in <var>accumulated configuration</var> is not supported or not
                  allowed in the <var>origin</var>, return <code>NotSupported</code>.
                </p>
                <div class="note" role="note" id="issue-container-generatedID-32"><div role="heading" class="note-title marker" id="h-note-32" aria-level="6"><span>Note</span></div><p class="">
                  In this step, "supported" includes the implementation being available for use
                  when this algorithm returns, not just user agent support for such an
                  implementation.
                </p></div>
              </li>
              <li>
                <p>
                  If <var>accumulated configuration</var>'s
                  <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-12"><code>distinctiveIdentifier</code></a> value is
                  "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-9"><code>required</code></a>" and the <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-7">Distinctive Identifier(s)</a>
                  associated with <var>accumulated configuration</var> are not <a href="#per-origin-per-profile-identifiers">unique per origin and profile</a> and
                  <a href="#allow-identifiers-cleared">clearable</a>:
                </p>
                <ol>
                  <li>
                    <p>
                      Update <var>restrictions</var> to reflect that all configurations described
                      by <var>accumulated configuration</var> do not have user consent.
                    </p>
                  </li>
                  <li>
                    <p>
                      Return <code>ConsentDenied</code> and <var>restrictions</var>.
                    </p>
                  </li>
                </ol>
                <div class="note" role="note" id="issue-container-generatedID-33"><div role="heading" class="note-title marker" id="h-note-33" aria-level="6"><span>Note</span></div><div class="">
                  <p>
                    The "unique per origin and profile" and "clearable" conditions cannot be false
                    in a compliant implementation because implementations <em class="rfc2119">MUST</em> <a href="#per-origin-per-profile-identifiers">use per-origin per-profile
                    identifiers</a> and <a href="#allow-identifiers-cleared">allow the user to
                    clear identifier</a>.
                  </p>
                </div></div>
              </li>
              <li>
                <p>
                  Let <var>consent status</var> and <var>updated restrictions</var> be the result
                  of running the <a data-link-type="dfn|abstract-op" href="#dfn-get-consent-status" class="internalDFN" id="ref-for-dfn-get-consent-status-1">Get Consent Status</a> algorithm on <var>accumulated
                  configuration</var>, <var>restrictions</var> and <var>origin</var> and follow the
                  steps for the value of <var>consent status</var> from the following list:
                </p>
                <dl class="switch">
                  <dt>
                    <code>ConsentDenied</code>:
                  </dt>
                  <dd>
                    <p>
                      Return <code>ConsentDenied</code> and <var>updated restrictions</var>.
                    </p>
                  </dd>
                  <dt>
                    <code>InformUser</code>:
                  </dt>
                  <dd>
                    <p>
                      Inform the user that <var>accumulated configuration</var> is in use in the
                      <var>origin</var> including, specifically, the information that <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-8">Distinctive Identifier(s)</a> and/or <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-16">Distinctive Permanent Identifier(s)</a> as appropriate
                      will be used if the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-13"><code>distinctiveIdentifier</code></a>
                      member of <var>accumulated configuration</var> is
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-10"><code>required</code></a>". Continue to the next step.
                    </p>
                  </dd>
                  <dt>
                    <code>Allowed</code>:
                  </dt>
                  <dd>
                    <p>
                      Continue to the next step.
                    </p>
                  </dd>
                </dl>
              </li>
              <li>
                <p>
                  Return <var>accumulated configuration</var>.
                </p>
              </li>
            </ol>
          </section>
          <section id="get-supported-capabilities-for-audio-video-type"><div class="header-wrapper"><h5 id="x3-2-2-3-get-supported-capabilities-for-audio-video-type"><bdi class="secno">3.2.2.3 </bdi>
              <dfn id="dfn-get-supported-capabilities-for-audio-video-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Get Supported Capabilities for Audio/Video Type</dfn>
            </h5><a class="self-link" href="#get-supported-capabilities-for-audio-video-type" aria-label="Permalink for Section 3.2.2.3"></a></div>
            
            <p>
              Given an <var>audio/video type</var>, <a data-link-type="idl" data-lt="MediaKeySystemMediaCapability" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-1"><code>MediaKeySystemMediaCapability</code></a> sequence
              <var>requested media capabilities</var>, <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-5"><code>MediaKeySystemConfiguration</code></a>
              <var>accumulated configuration</var>, and <var>restrictions</var>, this algorithm
              returns a sequence of supported <a data-link-type="idl" data-lt="MediaKeySystemMediaCapability" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-2"><code>MediaKeySystemMediaCapability</code></a> values for this
              audio/video type or <code>null</code> as appropriate.
            </p>
            <ol>
              <li>
                <p>
                  Let <var>local accumulated configuration</var> be a local copy of
                  <var>accumulated configuration</var>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>supported media capabilities</var> be an empty sequence of
                  <a data-link-type="idl" data-lt="MediaKeySystemMediaCapability" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-3"><code>MediaKeySystemMediaCapability</code></a> dictionaries.
                </p>
              </li>
              <li>
                <p>
                  For each <var>requested media capability</var> in <var>requested media
                  capabilities</var>:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>content type</var> be <var>requested media capability</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-contenttype" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-contenttype-1"><code>contentType</code></a> member.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>encryption scheme</var> be <var>requested media capability</var>’s
                      <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-encryptionscheme" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-encryptionscheme-1"><code>encryptionScheme</code></a> member.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>robustness</var> be <var>requested media capability</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-robustness" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-robustness-1"><code>robustness</code></a> member.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>content type</var> is the empty string, return <code>null</code>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>content type</var> is not a <a data-link-type="dfn|abstract-op" href="#dfn-valid-media-mime-type" class="internalDFN" id="ref-for-dfn-valid-media-mime-type-1">valid media MIME type</a> or is
                      unrecognized, continue to the next iteration.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>container</var> be the container type specified by <var>content
                      type</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the user agent does not support <var>container</var>, continue to the next
                      iteration. The case-sensitivity of string comparisons is determined by the
                      appropriate RFC.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-34"><div role="heading" class="note-title marker" id="h-note-34" aria-level="6"><span>Note</span></div><p class="">
                      Per RFC 6838 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6838" title="Media Type Specifications and Registration Procedures">RFC6838</a></cite>], "Both top-level type and subtype names are
                      case-insensitive."
                    </p></div>
                  </li>
                  <li>
                    <p>
                      Let <var>parameters</var> be the RFC 6381 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6381" title="The 'Codecs' and 'Profiles' Parameters for &quot;Bucket&quot; Media Types">RFC6381</a></cite>] parameters, if any,
                      specified by <var>content type</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the user agent does not recognize one or more <var>parameters</var>,
                      continue to the next iteration.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>media types</var> be the set of codecs and codec constraints
                      specified by <var>parameters</var>. The case-sensitivity of string
                      comparisons is determined by the appropriate RFC or other specification.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-35"><div role="heading" class="note-title marker" id="h-note-35" aria-level="6"><span>Note</span></div><p class="">
                      Case-sensitive string comparison is <em class="rfc2119">RECOMMENDED</em> because RFC 6381 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6381" title="The 'Codecs' and 'Profiles' Parameters for &quot;Bucket&quot; Media Types">RFC6381</a></cite>]
                      says, "Values are case sensitive" for some formats.
                    </p></div>
                  </li>
                  <li>
                    <p>
                      If <var>media types</var> is empty:
                    </p>
                    <dl class="switch">
                      <dt>
                        If <var>container</var> normatively implies a specific set of codecs and
                        codec constraints:
                      </dt>
                      <dd>
                        <p>
                          Let <var>parameters</var> be that set.
                        </p>
                      </dd>
                      <dt>
                        Otherwise:
                      </dt>
                      <dd>
                        <p>
                          Continue to the next iteration.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If <var>content type</var> is not strictly a <var>audio/video type</var>,
                      continue to the next iteration.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-36"><div role="heading" class="note-title marker" id="h-note-36" aria-level="6"><span>Note</span></div><p class="">
                      For example, if <var>audio/video type</var> is Video and the top-level type
                      is not "video" or <var>media types</var> contains non-video codecs.
                    </p></div>
                  </li>
                  <li>
                    <p>
                      If <var>encryption scheme</var> is non-null and is not recognized or not
                      supported by <var>implementation</var>, continue to the next iteration.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>robustness</var> is not the empty string and contains an unrecognized
                      value or a value not supported by <var>implementation</var>, continue to the
                      next iteration. String comparison is case-sensitive.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the user agent and <var>implementation</var> definitely support playback
                      of encrypted <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> for the combination of
                      <var>container</var>, <var>media types</var>, <var>encryption scheme</var>,
                      <var>robustness</var> and <var>local accumulated configuration</var> in
                      combination with <var>restrictions</var>:
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-37"><div role="heading" class="note-title marker" id="h-note-37" aria-level="6"><span>Note</span></div><p class="">
                      <var>requested media capability</var> (content type and robustness) must be
                      supported when used together with all previously added requested media
                      capabilities.
                    </p></div>
                    <ol>
                      <li>
                        <p>
                          Add <var>requested media capability</var> to <var>supported media
                          capabilities</var>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-38"><div role="heading" class="note-title marker" id="h-note-38" aria-level="6"><span>Note</span></div><p class="">
                          This step ensures that the values of the members of entries in
                          <var>supported media capabilities</var> are exactly the strings supplied
                          in <var>requested media capability</var> without modification by the User
                          Agent.
                        </p></div>
                      </li>
                      <li>
                        <dl class="switch">
                          <dt>
                            If <var>audio/video type</var> is Video:
                          </dt>
                          <dd>
                            <p>
                              Add <var>requested media capability</var> to the
                              <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-6"><code>videoCapabilities</code></a> member of
                              <var>local accumulated configuration</var>.
                            </p>
                          </dd>
                          <dt>
                            If <var>audio/video type</var> is Audio:
                          </dt>
                          <dd>
                            <p>
                              Add <var>requested media capability</var> to the
                              <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-audiocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-6"><code>audioCapabilities</code></a> member of
                              <var>local accumulated configuration</var>.
                            </p>
                          </dd>
                        </dl>
                        <div class="note" role="note" id="issue-container-generatedID-39"><div role="heading" class="note-title marker" id="h-note-39" aria-level="6"><span>Note</span></div><p class="">
                          This step ensures that configurations are always checked with
                          configurations from previous iterations, including from previous calls to
                          this algorithm. Otherwise, only configurations from previous calls to
                          this algorithm would be checked in subsequent calls.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  If <var>supported media capabilities</var> is empty, return <code>null</code>.
                </p>
                <div class="note" role="note" id="issue-container-generatedID-40"><div role="heading" class="note-title marker" id="h-note-40" aria-level="6"><span>Note</span></div><p class="">
                  None of the <a data-link-type="idl" data-lt="MediaKeySystemMediaCapability" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-4"><code>MediaKeySystemMediaCapability</code></a> elements in <var>requested media
                  capabilities</var> is supported in combination with <var>accumulated
                  configuration</var>.
                </p></div>
              </li>
              <li>
                <p>
                  Return <var>supported media capabilities</var>.
                </p>
              </li>
            </ol>
          </section>
          <section id="get-consent-status"><div class="header-wrapper"><h5 id="x3-2-2-4-get-consent-status"><bdi class="secno">3.2.2.4 </bdi>
              <dfn id="dfn-get-consent-status" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Get Consent Status</dfn>
            </h5><a class="self-link" href="#get-consent-status" aria-label="Permalink for Section 3.2.2.4"></a></div>
            
            <p>
              Given an <var>accumulated configuration</var>, <var>restrictions</var> and
              <var>origin</var>, this algorithm returns the consent status for <var>accumulated
              configuration</var> and <var>origin</var> as one of <code>ConsentDenied</code>,
              <code>InformUser</code> or <code>Allowed</code>, together with an updated value for
              <var>restrictions</var> in the <code>ConsentDenied</code> case.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-41"><div role="heading" class="note-title marker" id="h-note-41" aria-level="6"><span>Note</span></div><div class="">
              <p>
                Consent status for <var>accumulated configuration</var> depends at least on the
                value of the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-14"><code>distinctiveIdentifier</code></a> member of
                <var>accumulated configuration</var>.
              </p>
              <p>
                Previous consent for <var>accumulated configuration</var> with
                <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-15"><code>distinctiveIdentifier</code></a> set to
                "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-8"><code>not-allowed</code></a>" does not imply consent for the same
                configuration with <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-16"><code>distinctiveIdentifier</code></a> set to
                "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-8"><code>optional</code></a>" or "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-11"><code>required</code></a>".
              </p>
            </div></div>
            <ol>
              <li>
                <p>
                  If there is persisted denial for <var>origin</var> indicating that
                  <var>accumulated configuration</var> is not allowed, run the following steps:
                </p>
                <ol>
                  <li>
                    <p>
                      Update <var>restrictions</var> to reflect the configurations for which
                      consent has been denied.
                    </p>
                  </li>
                  <li>
                    <p>
                      Return <code>ConsentDenied</code> and <var>restrictions</var>.
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  If there is persisted consent for <var>origin</var> indicating <var>accumulated
                  configuration</var> is allowed, return <code>Allowed</code>.
                </p>
              </li>
              <li>
                <p>
                  If any of the following are true:
                </p>
                <ul>
                  <li>
                    <p>
                      The <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-17"><code>distinctiveIdentifier</code></a> member of
                      <var>accumulated configuration</var> is not
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-9"><code>not-allowed</code></a>" and the combination of the User Agent,
                      <var>implementation</var> and <var>accumulated configuration</var> does not
                      follow all the recommendations of <a href="#allow-persistent-data-cleared">Allow Persistent Data to Be Cleared</a> with
                      respect to <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-9">Distinctive Identifier(s)</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      The user agent requires explicit user consent for the <var>accumulated
                      configuration</var> for other reasons.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-42"><div role="heading" class="note-title marker" id="h-note-42" aria-level="6"><span>Note</span></div><p class="">
                      Another reason for requiring explicit user consent may be due to the security
                      properties of the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-24">CDM</a> implementation.
                    </p></div>
                  </li>
                </ul>
                <p>
                  then run the following steps:
                </p>
                <ol>
                  <li>
                    <p>
                      Request user consent to use <var>accumulated configuration</var> in the
                      <var>origin</var> and wait for the user response.
                    </p>
                    <p>
                      The consent <em class="rfc2119">MUST</em> include consent to use a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-10">Distinctive Identifier(s)</a>
                      and/or <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-17">Distinctive Permanent Identifier(s)</a> as appropriate if
                      <var>accumulated configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-18"><code>distinctiveIdentifier</code></a> member is
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-12"><code>required</code></a>".
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-43"><div role="heading" class="note-title marker" id="h-note-43" aria-level="6"><span>Note</span></div><div class="">
                      <p>
                        User consent to use <var>accumulated configuration</var> is specific to the
                        <var>origin</var> and may be limited to configurations sharing certain
                        properties with <var>accumulated configuration</var>.
                      </p>
                    </div></div>
                  </li>
                  <li>
                    <p>
                      If consent was denied, run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          Update <var>restrictions</var> to reflect the configurations for which
                          consent was denied.
                        </p>
                      </li>
                      <li>
                        <p>
                          Return <code>ConsentDenied</code> and <var>restrictions</var>.
                        </p>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  If the <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-19"><code>distinctiveIdentifier</code></a> member of
                  <var>accumulated configuration</var> is not
                  "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-10"><code>not-allowed</code></a>", return <code>InformUser</code>.
                </p>
              </li>
              <li>
                <p>
                  If the user agent requires informing the user for the <var>accumulated
                  configuration</var> for other reasons, return <code>InformUser</code>.
                </p>
              </li>
              <li>
                <p>
                  Return <code>Allowed</code>.
                </p>
              </li>
            </ol>
          </section>
        </section>
      </section>
      <section data-dfn-for="MediaKeySystemConfiguration" id="mediakeysystemconfiguration-dictionary"><div class="header-wrapper"><h3 id="x3-3-mediakeysystemconfiguration-dictionary"><bdi class="secno">3.3 </bdi>
          <dfn data-export="" data-dfn-type="dictionary" id="dom-mediakeysystemconfiguration" data-idl="dictionary" data-title="MediaKeySystemConfiguration" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeySystemConfiguration</code></dfn> dictionary
        </h3><a class="self-link" href="#mediakeysystemconfiguration-dictionary" aria-label="Permalink for Section 3.3"></a></div>
        
        <pre class="idl def" id="webidl-1197737164"><span class="idlHeader"><a class="self-link" href="#webidl-1197737164">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-mediakeysrequirement" data-title="MediaKeysRequirement">enum <a class="internalDFN idlID" data-link-type="enum" href="#dom-mediakeysrequirement" id="ref-for-dom-mediakeysrequirement-1"><code>MediaKeysRequirement</code></a> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysrequirement-required" id="ref-for-dom-mediakeysrequirement-required-13"><code>required</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysrequirement-optional" id="ref-for-dom-mediakeysrequirement-optional-9"><code>optional</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysrequirement-not-allowed" id="ref-for-dom-mediakeysrequirement-not-allowed-11"><code>not-allowed</code></a>"</span>
};</span></code></pre>
        <p>
          The <dfn data-export="" data-dfn-type="enum" id="dom-mediakeysrequirement" data-idl="enum" data-title="MediaKeysRequirement" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeysRequirement</code></dfn> enumeration is defined as follows:
        </p>
        <table class="simple" data-dfn-for="MediaKeysRequirement">
          <tbody>
            <tr>
              <th colspan="2">
                Enumeration description
              </th>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysrequirement-required" data-idl="enum-value" data-title="required" data-dfn-for="MediaKeysRequirement" tabindex="0" aria-haspopup="dialog"><code>required</code></dfn>
              </td>
              <td>
                <dl>
                  <dt>
                    When used in a call to <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-4"><code>requestMediaKeySystemAccess</code></a><code>()</code>
                  </dt>
                  <dd>
                    The returned object <em class="rfc2119">MUST</em> support this feature.
                  </dd>
                  <dt>
                    When returned by a <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-8"><code>MediaKeySystemAccess</code></a> object
                  </dt>
                  <dd>
                    <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-25">CDM</a> instances created by the object <em class="rfc2119">MAY</em> use this feature.
                  </dd>
                </dl>
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysrequirement-optional" data-idl="enum-value" data-title="optional" data-dfn-for="MediaKeysRequirement" tabindex="0" aria-haspopup="dialog"><code>optional</code></dfn>
              </td>
              <td>
                <dl>
                  <dt>
                    When used in a call to <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-5"><code>requestMediaKeySystemAccess</code></a><code>()</code>
                  </dt>
                  <dd>
                    The returned object <em class="rfc2119">MAY</em> support and use this feature.
                  </dd>
                  <dt>
                    When returned by a <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-9"><code>MediaKeySystemAccess</code></a> object
                  </dt>
                  <dd>
                    This value cannot and <em class="rfc2119">MUST NOT</em> be present in such an object.
                  </dd>
                </dl>
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysrequirement-not-allowed" data-idl="enum-value" data-title="not-allowed" data-dfn-for="MediaKeysRequirement" tabindex="0" aria-haspopup="dialog"><code>not-allowed</code></dfn>
              </td>
              <td>
                <dl>
                  <dt>
                    When used in a call to <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-6"><code>requestMediaKeySystemAccess</code></a><code>()</code>
                  </dt>
                  <dd>
                    The returned object <em class="rfc2119">MUST</em> function without using this feature and <em class="rfc2119">MUST NOT</em> use
                    it at any time.
                  </dd>
                  <dt>
                    When returned by a <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-10"><code>MediaKeySystemAccess</code></a> object
                  </dt>
                  <dd>
                    <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-26">CDM</a> instances created by the object <em class="rfc2119">MUST NOT</em> use this feature.
                  </dd>
                </dl>
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="idl def" id="webidl-798704963"><span class="idlHeader"><a class="self-link" href="#webidl-798704963">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-mediakeysystemconfiguration" data-title="MediaKeySystemConfiguration">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-mediakeysystemconfiguration" id="ref-for-dom-mediakeysystemconfiguration-6"><code>MediaKeySystemConfiguration</code></a> {<span data-idl="" class="idlMember" id="idl-def-mediakeysystemconfiguration-label" data-title="label" data-dfn-for="MediaKeySystemConfiguration"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span>                               <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemconfiguration-label" id="ref-for-dom-mediakeysystemconfiguration-label-3"><code>label</code></a> = "";</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemconfiguration-initdatatypes" data-title="initDataTypes" data-dfn-for="MediaKeySystemConfiguration"><span class="idlType">
  <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>&gt;</span>                     <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemconfiguration-initdatatypes" id="ref-for-dom-mediakeysystemconfiguration-initdatatypes-4"><code>initDataTypes</code></a> = [];</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemconfiguration-audiocapabilities" data-title="audioCapabilities" data-dfn-for="MediaKeySystemConfiguration"><span class="idlType">
  <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-5"><code>MediaKeySystemMediaCapability</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemconfiguration-audiocapabilities" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-7"><code>audioCapabilities</code></a> = [];</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemconfiguration-videocapabilities" data-title="videoCapabilities" data-dfn-for="MediaKeySystemConfiguration"><span class="idlType">
  <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-6"><code>MediaKeySystemMediaCapability</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemconfiguration-videocapabilities" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-7"><code>videoCapabilities</code></a> = [];</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemconfiguration-distinctiveidentifier" data-title="distinctiveIdentifier" data-dfn-for="MediaKeySystemConfiguration"><span class="idlType">
  <a data-link-type="idl" href="#dom-mediakeysrequirement" class="internalDFN" id="ref-for-dom-mediakeysrequirement-2"><code>MediaKeysRequirement</code></a></span>                    <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-20"><code>distinctiveIdentifier</code></a> = "optional";</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemconfiguration-persistentstate" data-title="persistentState" data-dfn-for="MediaKeySystemConfiguration"><span class="idlType">
  <a data-link-type="idl" href="#dom-mediakeysrequirement" class="internalDFN" id="ref-for-dom-mediakeysrequirement-3"><code>MediaKeysRequirement</code></a></span>                    <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemconfiguration-persistentstate" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-9"><code>persistentState</code></a> = "optional";</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemconfiguration-sessiontypes" data-title="sessionTypes" data-dfn-for="MediaKeySystemConfiguration"><span class="idlType">
  <a data-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence">sequence</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>&gt;</span>                     <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemconfiguration-sessiontypes" id="ref-for-dom-mediakeysystemconfiguration-sessiontypes-4"><code>sessionTypes</code></a>;</span>
};</span></code></pre>
        <p>
          The dictionary <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-7"><code>MediaKeySystemConfiguration</code></a> contains the following members:
        </p>
        <dl class="dictionary-members" data-dfn-for="MediaKeySystemConfiguration">
          <dt>
            <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemconfiguration-label" data-idl="field" data-title="label" data-dfn-for="MediaKeySystemConfiguration" data-type="DOMString" tabindex="0" aria-haspopup="dialog">label</dfn></code> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, defaulting to <code>""</code>
          </dt>
          <dd>
            An optional label that will be preserved in the <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-8"><code>MediaKeySystemConfiguration</code></a>
            returned from the <a data-link-type="idl" data-lt="getConfiguration()" href="#dom-mediakeysystemaccess-getconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-getconfiguration-1"><code>getConfiguration</code></a><code>()</code> method of
            <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-11"><code>MediaKeySystemAccess</code></a>.
          </dd>
          <dt>
            <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemconfiguration-initdatatypes" data-idl="field" data-title="initDataTypes" data-dfn-for="MediaKeySystemConfiguration" data-type="sequence" tabindex="0" aria-haspopup="dialog">initDataTypes</dfn></code> of type <span class="idlMemberType">sequence&lt;<a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>&gt;</span>, defaulting to <code>[]</code>
          </dt>
          <dd>
            A list of supported <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-3">Initialization Data Type</a> names. The <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-4">Initialization Data Type</a> capability of this object is considered supported if the list is empty or
            contains one or more values that are supported with all other members (as determined by
            the algorithm). Values in the sequence <em class="rfc2119">MUST</em> not be the empty string.
          </dd>
          <dt>
            <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemconfiguration-audiocapabilities" data-idl="field" data-title="audioCapabilities" data-dfn-for="MediaKeySystemConfiguration" data-type="sequence" tabindex="0" aria-haspopup="dialog">audioCapabilities</dfn></code> of type <span class="idlMemberType">sequence&lt;<a data-link-type="idl" data-lt="MediaKeySystemMediaCapability" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-7"><code>MediaKeySystemMediaCapability</code></a>&gt;</span>, defaulting to
            <code>[]</code>
          </dt>
          <dd>
            A list of supported audio type and capability pairs. The audio capability of this
            object is considered supported if the list is empty or contains one or more values that
            are supported with all other members (as determined by the algorithm). When there is a
            conflict between values, the earlier value will be selected. An empty list indicates
            that no audio capabilities are supported. In this case, the
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-8"><code>videoCapabilities</code></a> element must not be empty.
          </dd>
          <dt>
            <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemconfiguration-videocapabilities" data-idl="field" data-title="videoCapabilities" data-dfn-for="MediaKeySystemConfiguration" data-type="sequence" tabindex="0" aria-haspopup="dialog">videoCapabilities</dfn></code> of type <span class="idlMemberType">sequence&lt;<a data-link-type="idl" data-lt="MediaKeySystemMediaCapability" href="#dom-mediakeysystemmediacapability" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-8"><code>MediaKeySystemMediaCapability</code></a>&gt;</span>, defaulting to
            <code>[]</code>
          </dt>
          <dd>
            A list of supported video type and capability pairs. The video capability of this
            object is considered supported if the list is empty or contains one or more values that
            are supported with all other members (as determined by the algorithm). When there is a
            conflict between values, the earlier value will be selected. An empty list indicates
            that no video capabilities are supported. In this case, the
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-audiocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-audiocapabilities-8"><code>audioCapabilities</code></a> element must not be empty.
          </dd>
          <dt>
            <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemconfiguration-distinctiveidentifier" data-idl="field" data-title="distinctiveIdentifier" data-dfn-for="MediaKeySystemConfiguration" data-type="MediaKeysRequirement" tabindex="0" aria-haspopup="dialog">distinctiveIdentifier</dfn></code> of type <a data-link-type="idl" data-lt="MediaKeysRequirement" href="#dom-mediakeysrequirement" class="internalDFN" id="ref-for-dom-mediakeysrequirement-4"><code>MediaKeysRequirement</code></a>,
            defaulting to <code>"optional"</code>
          </dt>
          <dd>
            Whether use of a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-11">Distinctive Identifier(s)</a> is required.
            <p>
              When this member is "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-12"><code>not-allowed</code></a>", the implementation <em class="rfc2119">MUST NOT</em> <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-3">use Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a> for any
              operations associated with any object created from this configuration.
            </p>
          </dd>
          <dt>
            <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemconfiguration-persistentstate" data-idl="field" data-title="persistentState" data-dfn-for="MediaKeySystemConfiguration" data-type="MediaKeysRequirement" tabindex="0" aria-haspopup="dialog">persistentState</dfn></code> of type <a data-link-type="idl" data-lt="MediaKeysRequirement" href="#dom-mediakeysrequirement" class="internalDFN" id="ref-for-dom-mediakeysrequirement-5"><code>MediaKeysRequirement</code></a>, defaulting to
            <code>"optional"</code>
          </dt>
          <dd>
            Whether the ability to persist state is required. This includes session data and any
            other type of state.
            <p>
              The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-27">CDM</a> <em class="rfc2119">MUST NOT</em> persist any state related to the application or <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of
              this object's <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> when this member is
              "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-13"><code>not-allowed</code></a>".
            </p>
            <div class="note" role="note" id="issue-container-generatedID-44"><div role="heading" class="note-title marker" id="h-note-44" aria-level="4"><span>Note</span></div><p class="">
              For the purposes of this member, persistent state does not include persistent unique
              identifiers (<a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-12">Distinctive Identifiers</a>) controlled by the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-10">Key System</a>
              implementation. <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-21"><code>distinctiveIdentifier</code></a> independently
              reflects this requirement.
            </p></div>
            <p>
              Only "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-2"><code>temporary</code></a>" sessions may be created when persistent
              state is not supported.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-45"><div role="heading" class="note-title marker" id="h-note-45" aria-level="4"><span>Note</span></div><p class="">
              For "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-3"><code>temporary</code></a>" sessions, the need and ability to store state
              is <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-11">Key System</a> implementation-specific and may vary by feature used.
            </p></div>
            <div class="note" role="note" id="issue-container-generatedID-46"><div role="heading" class="note-title marker" id="h-note-46" aria-level="4"><span>Note</span></div><p class="">
              Applications intending to create non-"<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-4"><code>temporary</code></a>" sessions,
              should set this member to "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-14"><code>required</code></a>" when calling
              <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-7"><code>requestMediaKeySystemAccess</code></a><code>()</code>.
            </p></div>
          </dd>
          <dt>
            <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemconfiguration-sessiontypes" data-idl="field" data-title="sessionTypes" data-dfn-for="MediaKeySystemConfiguration" data-type="sequence" tabindex="0" aria-haspopup="dialog">sessionTypes</dfn></code> of type <span class="idlMemberType">sequence&lt;<a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>&gt;</span>
          </dt>
          <dd>
            A list of <a data-link-type="idl" data-lt="MediaKeySessionType" href="#dom-mediakeysessiontype" class="internalDFN" id="ref-for-dom-mediakeysessiontype-1"><code>MediaKeySessionType</code></a>s that must be supported. All values must be
            supported.
            <p>
              If this member is <a data-link-type="dfn|abstract-op" data-lt="exist" data-type="dfn" href="https://infra.spec.whatwg.org/#map-exists">not present</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-infra" title="Infra Standard">Infra</a></cite>] when the dictionary is passed
              to <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-8"><code>requestMediaKeySystemAccess</code></a><code>()</code>, the dictionary will be treated as if
              this member is set to <code>[ "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-5"><code>temporary</code></a>" ]</code>.
            </p>
          </dd>
        </dl>
        <p>
          Implementations <em class="rfc2119">SHOULD NOT</em> add members to this dictionary. Should member(s) be added,
          they <em class="rfc2119">MUST</em> be of type <a data-link-type="idl" data-lt="MediaKeysRequirement" href="#dom-mediakeysrequirement" class="internalDFN" id="ref-for-dom-mediakeysrequirement-6"><code>MediaKeysRequirement</code></a>, and it is <em class="rfc2119">RECOMMENDED</em> that they have
          default values of "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-10"><code>optional</code></a>" to support the widest range of
          application and client combinations.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-47"><div role="heading" class="note-title marker" id="h-note-47" aria-level="4"><span>Note</span></div><p class="">
          Dictionary members not recognized by a user agent implementation are ignored per
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] and will not be considered in the <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-9"><code>requestMediaKeySystemAccess</code></a><code>()</code>
          algorithm. Should an application use non-standard dictionary member(s), it <em class="rfc2119">MUST NOT</em> rely
          on user agent implementations rejecting a configuration that includes such dictionary
          members.
        </p></div>
        <p>
          This dictionary <em class="rfc2119">MUST NOT</em> be used to pass state or data to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-28">CDM</a>.
        </p>
      </section>
      <section id="mediakeysystemmediacapability-dictionary"><div class="header-wrapper"><h3 id="x3-4-mediakeysystemmediacapability-dictionary"><bdi class="secno">3.4 </bdi>
          <dfn data-export="" data-dfn-type="dictionary" id="dom-mediakeysystemmediacapability" data-idl="dictionary" data-title="MediaKeySystemMediaCapability" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeySystemMediaCapability</code></dfn> dictionary
        </h3><a class="self-link" href="#mediakeysystemmediacapability-dictionary" aria-label="Permalink for Section 3.4"></a></div>
        
        <pre class="idl def" id="webidl-1151374081"><span class="idlHeader"><a class="self-link" href="#webidl-1151374081">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-mediakeysystemmediacapability" data-title="MediaKeySystemMediaCapability">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-mediakeysystemmediacapability" id="ref-for-dom-mediakeysystemmediacapability-9"><code>MediaKeySystemMediaCapability</code></a> {<span data-idl="" class="idlMember" id="idl-def-mediakeysystemmediacapability-contenttype" data-title="contentType" data-dfn-for="MediaKeySystemMediaCapability"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemmediacapability-contenttype" id="ref-for-dom-mediakeysystemmediacapability-contenttype-2"><code>contentType</code></a> = "";</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemmediacapability-encryptionscheme" data-title="encryptionScheme" data-dfn-for="MediaKeySystemMediaCapability"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemmediacapability-encryptionscheme" id="ref-for-dom-mediakeysystemmediacapability-encryptionscheme-2"><code>encryptionScheme</code></a> = null;</span><span data-idl="" class="idlMember" id="idl-def-mediakeysystemmediacapability-robustness" data-title="robustness" data-dfn-for="MediaKeySystemMediaCapability"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeysystemmediacapability-robustness" id="ref-for-dom-mediakeysystemmediacapability-robustness-2"><code>robustness</code></a> = "";</span>
};</span></code></pre>
        <section id="dictionary-mediakeysystemmediacapability-members"><div class="header-wrapper"><h4 id="x3-4-1-dictionary-mediakeysystemmediacapability-members"><bdi class="secno">3.4.1 </bdi>
            Dictionary <a class="idlType internalDFN" href="#dom-mediakeysystemmediacapability" data-link-type="idl" id="ref-for-dom-mediakeysystemmediacapability-10"><code>MediaKeySystemMediaCapability</code></a> Members
          </h4><a class="self-link" href="#dictionary-mediakeysystemmediacapability-members" aria-label="Permalink for Section 3.4.1"></a></div>
          
          <dl class="dictionary-members" data-dfn-for="MediaKeySystemMediaCapability">
            <dt>
              <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemmediacapability-contenttype" data-idl="field" data-title="contentType" data-dfn-for="MediaKeySystemMediaCapability" data-type="DOMString" tabindex="0" aria-haspopup="dialog">contentType</dfn></code> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, defaulting to
              <code>""</code>
            </dt>
            <dd>
              <p>
                The type of the <a href="https://html.spec.whatwg.org/multipage/#media-resource">media resource</a>. Its value
                must be a <a data-link-type="dfn|abstract-op" href="#dfn-valid-media-mime-type" class="internalDFN" id="ref-for-dfn-valid-media-mime-type-2">valid media MIME type</a>. The empty string is invalid.
              </p>
            </dd>
            <dt>
              <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemmediacapability-encryptionscheme" data-idl="field" data-title="encryptionScheme" data-dfn-for="MediaKeySystemMediaCapability" data-type="DOMString" tabindex="0" aria-haspopup="dialog">encryptionScheme</dfn></code> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, defaulting to
              <code>null</code>
            </dt>
            <dd>
              <p>
                The encryption scheme associated with the content type. A value which is null or
                not present indicates to the user agent that no specific encryption scheme is
                required by the application, and therefore any encryption scheme is acceptable.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-48"><div role="heading" class="note-title marker" id="h-note-48" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  Applications that are aware of this field <em class="rfc2119">SHOULD</em> specify the encryption schemes
                  they require, since different encryption schemes are generally incompatible with
                  one another. It is unrealistic for an application to be accepting of "any"
                  encryption scheme, but the default of null and the interpretation of null as
                  "any" provide backward compatibility for unaware applications and a path to a
                  polyfill for older user agents.
                </p>
              </div></div>
              <div class="note" role="note" id="issue-container-generatedID-49"><div role="heading" class="note-title marker" id="h-note-49" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  The empty string is distinct from null or not present, and so would be treated as
                  an unrecognized encryption scheme.
                </p>
              </div></div>
              <div class="note" role="note" id="issue-container-generatedID-50"><div role="heading" class="note-title marker" id="h-note-50" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  Well-known values for encryptionScheme are:
                </p>
                <ul>
                  <li>
                    <code><dfn id="scheme-cenc" data-lt="&quot;cenc&quot;|cenc" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">cenc</dfn></code>: The "cenc"
                    mode, defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-cenc" title="ISO/IEC 23001-7:2016, Information technology — MPEG systems technologies — Part 7: Common encryption in ISO Base Media File Format files">CENC</a></cite>], section 4.2a. AES-CTR mode full sample and video NAL
                    subsample encryption.
                  </li>
                  <li>
                    <code><dfn id="scheme-cbcs" data-lt="&quot;cbcs&quot;|cbcs" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">cbcs</dfn></code>: The "cbcs"
                    mode, defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-cenc" title="ISO/IEC 23001-7:2016, Information technology — MPEG systems technologies — Part 7: Common encryption in ISO Base Media File Format files">CENC</a></cite>], section 4.2d. AES-CBC mode partial video NAL pattern
                    encryption. For video, the spec allows various encryption patterns.
                  </li>
                  <li>
                    <code><dfn class="lint-ignore" id="dfn-cbcs-1-9" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">cbcs-1-9</dfn></code>: The same as <a data-link-type="dfn|abstract-op" href="#scheme-cbcs" class="internalDFN" id="ref-for-scheme-cbcs-1"><code>"cbcs"</code></a>
                    mode, but with a specific encrypt:skip pattern of 1:9 for video, as recommended
                    in [<cite><a class="bibref" data-link-type="biblio" href="#bib-cenc" title="ISO/IEC 23001-7:2016, Information technology — MPEG systems technologies — Part 7: Common encryption in ISO Base Media File Format files">CENC</a></cite>], section 10.4.2.
                  </li>
                </ul>
              </div></div>
            </dd>
            <dt>
              <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeysystemmediacapability-robustness" data-idl="field" data-title="robustness" data-dfn-for="MediaKeySystemMediaCapability" data-type="DOMString" tabindex="0" aria-haspopup="dialog">robustness</dfn></code> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, defaulting to
              <code>""</code>
            </dt>
            <dd>
              <p>
                The robustness level associated with the content type. The empty string indicates
                that any ability to decrypt and decode the content type is acceptable.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-51"><div role="heading" class="note-title marker" id="h-note-51" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  Implementations <em class="rfc2119">MUST</em> configure the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-29">CDM</a> to support at least the robustness
                  levels specified in the configuration of the <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-12"><code>MediaKeySystemAccess</code></a> object used
                  to create the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-8"><code>MediaKeys</code></a> object. Exact configuration of the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-30">CDM</a> is
                  implementation-specific, and implementations <em class="rfc2119">MAY</em> configure the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-31">CDM</a> to use the
                  highest robustness level in the configuration even if a higher robustness level
                  is available. If only the empty string is specified, implementations <em class="rfc2119">MAY</em> be
                  configured to use the lowest robustness level the implementation supports.
                </p>
                <p>
                  Applications <em class="rfc2119">SHOULD</em> specify the robustness level(s) they require to avoid
                  unexpected client incompatibilities.
                </p>
              </div></div>
            </dd>
          </dl>
        </section>
        <p>
          In order for the capability represented by this object to be considered supported,
          <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-contenttype" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-contenttype-3"><code>contentType</code></a> <em class="rfc2119">MUST NOT</em> be the empty string and its entire
          value, including all codecs, <em class="rfc2119">MUST</em> be supported with
          <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-robustness" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-robustness-3"><code>robustness</code></a>.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-52"><div role="heading" class="note-title marker" id="h-note-52" aria-level="4"><span>Note</span></div><p class="">
          If any of a set of codecs is acceptable, use a separate instances of this dictionary for
          each codec.
        </p></div>
      </section>
    </section>
    <section id="mediakeysystemaccess-interface"><div class="header-wrapper"><h2 id="x4-mediakeysystemaccess-interface"><bdi class="secno">4. </bdi>
        <dfn data-export="" data-dfn-type="interface" id="dom-mediakeysystemaccess" data-idl="interface" data-title="MediaKeySystemAccess" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeySystemAccess</code></dfn> Interface
      </h2><a class="self-link" href="#mediakeysystemaccess-interface" aria-label="Permalink for Section 4."></a></div>
      
      <p>
        The <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-13"><code>MediaKeySystemAccess</code></a> object provides access to a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-12">Key System</a>.
      </p>
      <pre class="idl def" id="webidl-1780138428"><span class="idlHeader"><a class="self-link" href="#webidl-1780138428">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-mediakeysystemaccess" data-title="MediaKeySystemAccess">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>] interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-mediakeysystemaccess" id="ref-for-dom-mediakeysystemaccess-14"><code>MediaKeySystemAccess</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-mediakeysystemaccess-keysystem" data-title="keySystem" data-dfn-for="MediaKeySystemAccess">
  readonly attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeysystemaccess-keysystem" id="ref-for-dom-mediakeysystemaccess-keysystem-2"><code>keySystem</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-mediakeysystemaccess-getconfiguration" data-title="getConfiguration" data-dfn-for="MediaKeySystemAccess"><span class="idlType">
  <a data-link-type="idl" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-9"><code>MediaKeySystemConfiguration</code></a></span>  <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeysystemaccess-getconfiguration" id="ref-for-dom-mediakeysystemaccess-getconfiguration-2"><code>getConfiguration</code></a> ();</span><span data-idl="" class="idlMethod" id="idl-def-mediakeysystemaccess-createmediakeys" data-title="createMediaKeys" data-dfn-for="MediaKeySystemAccess"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-9"><code>MediaKeys</code></a>&gt;</span>           <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeysystemaccess-createmediakeys" id="ref-for-dom-mediakeysystemaccess-createmediakeys-1"><code>createMediaKeys</code></a> ();</span>
};</span></code></pre>
      <section id="attributes"><div class="header-wrapper"><h3 id="x4-1-attributes"><bdi class="secno">4.1 </bdi>
          Attributes
        </h3><a class="self-link" href="#attributes" aria-label="Permalink for Section 4.1"></a></div>
        
        <dl class="attributes" data-dfn-for="MediaKeySystemAccess">
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeysystemaccess-keysystem" data-idl="attribute" data-title="keySystem" data-dfn-for="MediaKeySystemAccess" data-type="DOMString" data-lt="keySystem" data-local-lt="MediaKeySystemAccess.keySystem" tabindex="0" aria-haspopup="dialog"><code>keySystem</code></dfn> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, readonly
          </dt>
          <dd>
            Identifies the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-13">Key System</a> being used.
          </dd>
        </dl>
      </section>
      <section id="methods-0"><div class="header-wrapper"><h3 id="x4-2-methods"><bdi class="secno">4.2 </bdi>
          Methods
        </h3><a class="self-link" href="#methods-0" aria-label="Permalink for Section 4.2"></a></div>
        
        <dl class="methods" data-dfn-for="MediaKeySystemAccess">
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeysystemaccess-getconfiguration" data-idl="operation" data-title="getConfiguration()" data-dfn-for="MediaKeySystemAccess" data-type="MediaKeySystemConfiguration" data-lt="getConfiguration()" data-local-lt="MediaKeySystemAccess.getConfiguration|MediaKeySystemAccess.getConfiguration()|getConfiguration" tabindex="0" aria-haspopup="dialog"><code>getConfiguration()</code></dfn>
          </dt>
          <dd>
            <p>
              Returns the supported combination of configuration options selected by the
              <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-10"><code>requestMediaKeySystemAccess</code></a><code>()</code> algorithm.
            </p>
            <p>
              The returned object is a non-strict subset (plus any implied defaults) of the first
              satisfiable <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-10"><code>MediaKeySystemConfiguration</code></a> configuration passed to the
              <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-11"><code>requestMediaKeySystemAccess</code></a><code>()</code> call that returned the promise that was
              resolved with this object. It does not contain values capabilities not specified in
              that single configuration (other than implied defaults) and thus may not reflect all
              capabilities of the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-14">Key System</a> implementation. All values in the configuration
              may be used in any combination. Members of type <a data-link-type="idl" data-lt="MediaKeysRequirement" href="#dom-mediakeysrequirement" class="internalDFN" id="ref-for-dom-mediakeysrequirement-7"><code>MediaKeysRequirement</code></a> reflect
              whether the capability is required for any combination. They will not have the value
              "<a data-link-type="idl" href="#dom-mediakeysrequirement-optional" class="internalDFN" id="ref-for-dom-mediakeysrequirement-optional-11"><code>optional</code></a>".
            </p>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  Return this object's <var>configuration</var> value.
                </p>
                <div class="note" role="note" id="issue-container-generatedID-53"><div role="heading" class="note-title marker" id="h-note-53" aria-level="4"><span>Note</span></div><p class="">
                  This results in a new object being created and initialized from
                  <var>configuration</var> each time this method is called.
                </p></div>
                <div class="note" role="note" id="issue-container-generatedID-54"><div role="heading" class="note-title marker" id="h-note-54" aria-level="4"><span>Note</span></div><p class="">
                  If <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-encryptionscheme" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-encryptionscheme-3"><code>encryptionScheme</code></a> was not given by the
                  application, the accumulated <var>configuration</var> <em class="rfc2119">MUST</em> still contain an
                  <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-encryptionscheme" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-encryptionscheme-4"><code>encryptionScheme</code></a> field with a value of
                  <code>null</code>, so that polyfills can detect the user agent's support for the
                  field without specifying specific values.
                </p></div>
              </li>
            </ol>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeysystemaccess-createmediakeys" data-idl="operation" data-title="createMediaKeys()" data-dfn-for="MediaKeySystemAccess" data-type="Promise" data-lt="createMediaKeys()" data-local-lt="MediaKeySystemAccess.createMediaKeys|MediaKeySystemAccess.createMediaKeys()|createMediaKeys" tabindex="0" aria-haspopup="dialog"><code>createMediaKeys()</code></dfn>
          </dt>
          <dd>
            <p>
              Creates a new <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-10"><code>MediaKeys</code></a> object for <var>keySystem</var>.
            </p>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>configuration</var> be the value of this object's
                      <var>configuration</var> value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>use distinctive identifier</var> be <code>true</code> if the value
                      of <var>configuration</var>'s
                      <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-22"><code>distinctiveIdentifier</code></a> member is
                      "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-15"><code>required</code></a>" and <code>false</code> otherwise.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>persistent state allowed</var> be <code>true</code> if the value of
                      <var>configuration</var>'s <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-10"><code>persistentState</code></a>
                      member is "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-16"><code>required</code></a>" and <code>false</code>
                      otherwise.
                    </p>
                  </li>
                  <li>
                    <p>
                      Load and initialize the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-15">Key System</a> implementation represented by this
                      object's <var>cdm implementation</var> value if necessary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>instance</var> be a new instance of the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-16">Key System</a>
                      implementation represented by this object's <var>cdm implementation</var>
                      value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Initialize <var>instance</var> to enable, disable and/or select <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-17">Key System</a> features using <var>configuration</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>use distinctive identifier</var> is <code>false</code>, prevent
                      <var>instance</var> from <a data-link-type="dfn|abstract-op" data-lt="uses Distinctive Identifier(s) or Distinctive Permanent Identifier(s)" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-4">using Distinctive Identifier(s) and Distinctive Permanent Identifier(s)</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>persistent state allowed</var> is <code>false</code>, prevent
                      <var>instance</var> from persisting any state related to the application or
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of this object's <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If any of the preceding steps failed, reject <var>promise</var> with a new
                      <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> whose name is the appropriate <a href="#error-names">error
                      name</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>media keys</var> be a new <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-11"><code>MediaKeys</code></a> object, and initialize it as
                      follows:
                    </p>
                    <ol>
                      <li>
                        <p>
                          Let the <var>use distinctive identifier</var> value be <var>use
                          distinctive identifier</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Let the <var>persistent state allowed</var> value be <var>persistent
                          state allowed</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Let the <var>supported session types</var> value be be the value of
                          <var>configuration</var>'s <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-sessiontypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-sessiontypes-5"><code>sessionTypes</code></a>
                          member.
                        </p>
                      </li>
                      <li>
                        <p>
                          Let the <var>cdm implementation</var> value be this object's <var>cdm
                          implementation</var> value.
                        </p>
                      </li>
                      <li>
                        <p>
                          Let the <var>cdm instance</var> value be <var>instance</var>.
                        </p>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      Resolve <var>promise</var> with <var>media keys</var>.
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
        </dl>
      </section>
    </section>
    <section id="mediakeys-interface"><div class="header-wrapper"><h2 id="x5-mediakeys-interface"><bdi class="secno">5. </bdi>
        <dfn data-export="" data-dfn-type="interface" id="dom-mediakeys" data-idl="interface" data-title="MediaKeys" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeys</code></dfn> Interface
      </h2><a class="self-link" href="#mediakeys-interface" aria-label="Permalink for Section 5."></a></div>
      
      <p>
        The <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-12"><code>MediaKeys</code></a> object represents a set of keys that an associated <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-4"><code>HTMLMediaElement</code></a>
        can use for decryption of <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> during playback. It also
        represents a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-32">CDM</a> instance.
      </p>
      <p>
        A <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-13"><code>MediaKeys</code></a> object may be destroyed by the user agent when it is no longer accessible
      </p>
      <div class="note" role="note" id="issue-container-generatedID-55"><div role="heading" class="note-title marker" id="h-note-55" aria-level="3"><span>Note</span></div><p class="">
        For example, when there are no script references and no attached media element.
      </p></div>
      <p>
        For methods that return a promise, all errors are reported asynchronously by rejecting the
        returned Promise. This includes [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] type mapping errors.
      </p>
      <p>
        The steps of an algorithm are always aborted when rejecting a promise.
      </p>
      <pre class="idl def" id="webidl-2083600463"><span class="idlHeader"><a class="self-link" href="#webidl-2083600463">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-mediakeysessiontype" data-title="MediaKeySessionType">enum <a class="internalDFN idlID" data-link-type="enum" href="#dom-mediakeysessiontype" id="ref-for-dom-mediakeysessiontype-2"><code>MediaKeySessionType</code></a> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysessiontype-temporary" id="ref-for-dom-mediakeysessiontype-temporary-6"><code>temporary</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysessiontype-persistent-license" id="ref-for-dom-mediakeysessiontype-persistent-license-1"><code>persistent-license</code></a>"</span>
};</span></code></pre>
      <p>
        The <dfn data-export="" data-dfn-type="enum" id="dom-mediakeysessiontype" data-idl="enum" data-title="MediaKeySessionType" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeySessionType</code></dfn> enumeration is defined as follows:
      </p>
      <table class="simple" data-dfn-for="MediaKeySessionType">
        <tbody>
          <tr>
            <th colspan="2">
              Enumeration description
            </th>
          </tr>
          <tr>
            <td>
              <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysessiontype-temporary" data-idl="enum-value" data-title="temporary" data-dfn-for="MediaKeySessionType" tabindex="0" aria-haspopup="dialog"><code>temporary</code></dfn>
            </td>
            <td>
              <p>
                A session for which the license, key(s) and record of or data related to the
                session are not persisted.
              </p>
              <p>
                The application need not worry about managing such storage. Support for this
                session type is <em class="rfc2119">REQUIRED</em>.
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysessiontype-persistent-license" data-idl="enum-value" data-title="persistent-license" data-dfn-for="MediaKeySessionType" tabindex="0" aria-haspopup="dialog"><code>persistent-license</code></dfn>
            </td>
            <td>
              <p>
                A session for which the license (and potentially other data related to the session)
                will be persisted. A <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-2">record of license destruction</a> <em class="rfc2119">SHALL</em> be persisted when the
                license and key(s) it contains are destroyed. The <dfn data-lt="record(s) of license destruction|records of license destruction|record of license destruction" id="dfn-record-s-of-license-destruction" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">record of license
                destruction</dfn> is a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-18">Key System</a>-specific attestation that the license and
                key(s) it contains are no longer usable by the client. Support for this session
                type is <em class="rfc2119">OPTIONAL</em>.
              </p>
              <p>
                Sessions of this type can only be created if the configuration associated with the
                <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-15"><code>MediaKeySystemAccess</code></a> object that created this object has a
                <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-11"><code>persistentState</code></a> value of
                "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-17"><code>required</code></a>". The session <em class="rfc2119">MUST</em> be loadable via its <a data-link-type="dfn|abstract-op" href="#dfn-session-id" class="internalDFN" id="ref-for-dfn-session-id-2">Session ID</a> once <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-3"><code>update</code></a><code>()</code> is called successfully. A <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-1"><code><code>message</code></code></a> of
                type "<a data-link-type="idl" href="#dom-mediakeymessagetype-license-release" class="internalDFN" id="ref-for-dom-mediakeymessagetype-license-release-1"><code>license-release</code></a>" containing the <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-3">record of license destruction</a> will be generated when <a data-link-type="idl" data-lt="remove()" href="#dom-mediakeysession-remove" class="internalDFN" id="ref-for-dom-mediakeysession-remove-1"><code>remove</code></a><code>()</code> is called until
                the record is acknowledged by a response passed to <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-4"><code>update</code></a><code>()</code>.
              </p>
              <p>
                The application is responsible for ensuring that data persisted for such sessions
                is removed when the application no longer needs it. See <a href="#session-storage">Session Storage and Persistence</a>.
              </p>
            </td>
          </tr>
        </tbody>
      </table>
      <pre class="idl def" id="webidl-742597615"><span class="idlHeader"><a class="self-link" href="#webidl-742597615">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-mediakeys" data-title="MediaKeys">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>] interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-mediakeys" id="ref-for-dom-mediakeys-14"><code>MediaKeys</code></a> {<span data-idl="" class="idlMethod" id="idl-def-mediakeys-createsession-sessiontype" data-title="createSession" data-dfn-for="MediaKeys"><span class="idlType">
    <a data-link-type="idl" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-4"><code>MediaKeySession</code></a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeys-createsession" id="ref-for-dom-mediakeys-createsession-1"><code>createSession</code></a> (optional<span class="idlType"> <a data-link-type="idl" href="#dom-mediakeysessiontype" class="internalDFN" id="ref-for-dom-mediakeysessiontype-3"><code>MediaKeySessionType</code></a></span> <span class="idlParamName">sessionType</span> = "temporary");</span><span data-idl="" class="idlMethod" id="idl-def-mediakeys-getstatusforpolicy-policy" data-title="getStatusForPolicy" data-dfn-for="MediaKeys"><span class="idlType">
    <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-1"><code>MediaKeyStatus</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeys-getstatusforpolicy" id="ref-for-dom-mediakeys-getstatusforpolicy-1"><code>getStatusForPolicy</code></a> (optional<span class="idlType"> <a data-link-type="idl" href="#dom-mediakeyspolicy" class="internalDFN" id="ref-for-dom-mediakeyspolicy-1"><code>MediaKeysPolicy</code></a></span> <span class="idlParamName">policy</span> = {});</span><span data-idl="" class="idlMethod" id="idl-def-mediakeys-setservercertificate-servercertificate" data-title="setServerCertificate" data-dfn-for="MediaKeys"><span class="idlType">
    <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeys-setservercertificate" id="ref-for-dom-mediakeys-setservercertificate-1"><code>setServerCertificate</code></a> (<span class="idlType"><a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <span class="idlParamName">serverCertificate</span>);</span>
};</span></code></pre>
      <section id="methods-1"><div class="header-wrapper"><h3 id="x5-1-methods"><bdi class="secno">5.1 </bdi>
          Methods
        </h3><a class="self-link" href="#methods-1" aria-label="Permalink for Section 5.1"></a></div>
        
        <dl class="methods" data-dfn-for="MediaKeys">
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeys-createsession" data-idl="operation" data-title="createSession()" data-dfn-for="MediaKeys" data-type="MediaKeySession" data-lt="createSession()|createSession(sessionType)" data-local-lt="MediaKeys.createSession|MediaKeys.createSession()|createSession" tabindex="0" aria-haspopup="dialog"><code>createSession()</code></dfn>
          </dt>
          <dd>
            <p>
              Returns a new <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-5"><code>MediaKeySession</code></a> object.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-56"><div role="heading" class="note-title marker" id="h-note-56" aria-level="4"><span>Note</span></div><p class="">
              The <var>sessionType</var> parameter affects the behavior of the returned object.
            </p></div>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  If this object's <var>supported session types</var> value does not contain
                  <var>sessionType</var>, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] a <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-3"><code><code>NotSupportedError</code></code></a>.
                </p>
                <div class="note" role="note" id="issue-container-generatedID-57"><div role="heading" class="note-title marker" id="h-note-57" aria-level="4"><span>Note</span></div><p class="">
                  <var>sessionType</var> values for which the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-4">Is persistent session type?</a>
                  algorithm returns <code>true</code> will fail if this object's <var>persistent
                  state allowed</var> value is <code>false</code>.
                </p></div>
              </li>
              <li>
                <p>
                  If the implementation does not support <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-6"><code>MediaKeySession</code></a> operations in the
                  current state, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-1"><code><code>InvalidStateError</code></code></a>.
                </p>
                <div class="note" role="note" id="issue-container-generatedID-58"><div role="heading" class="note-title marker" id="h-note-58" aria-level="4"><span>Note</span></div><p class="">
                  Some implementations are unable to execute <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-7"><code>MediaKeySession</code></a> algorithms until
                  this <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-15"><code>MediaKeys</code></a> object is associated with a media element using
                  <a data-link-type="idl" data-lt="setMediaKeys()" href="#dom-htmlmediaelement-setmediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-setmediakeys-1"><code>setMediaKeys</code></a><code>()</code>. This step enables applications to detect
                  this uncommon behavior before attempting to perform such operations.
                </p></div>
              </li>
              <li>
                <p>
                  Let <var>session</var> be a new <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-8"><code>MediaKeySession</code></a> object, and initialize it as
                  follows:
                </p>
                <ol>
                  <li>
                    <p>
                      Let the <a data-link-type="idl" href="#dom-mediakeysession-sessionid" class="internalDFN" id="ref-for-dom-mediakeysession-sessionid-1"><code>sessionId</code></a> attribute be the empty string.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <a data-link-type="idl" href="#dom-mediakeysession-expiration" class="internalDFN" id="ref-for-dom-mediakeysession-expiration-1"><code>expiration</code></a> attribute be <code>NaN</code>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <a data-link-type="idl" href="#dom-mediakeysession-closed" class="internalDFN" id="ref-for-dom-mediakeysession-closed-1"><code>closed</code></a> attribute be a new promise.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>key status</var> be a new empty <a data-link-type="idl" data-lt="MediaKeyStatusMap" href="#dom-mediakeystatusmap" class="internalDFN" id="ref-for-dom-mediakeystatusmap-1"><code>MediaKeyStatusMap</code></a> object, and
                      initialize it as follows:
                    </p>
                    <ol>
                      <li>
                        <p>
                          Let the <a data-link-type="idl" href="#dom-mediakeystatusmap-size" class="internalDFN" id="ref-for-dom-mediakeystatusmap-size-1"><code>size</code></a> attribute be 0.
                        </p>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      Let the <var>session type</var> value be <var>sessionType</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <var>uninitialized</var> value be true.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <var>callable</var> value be false.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <var>closing or closed</var> value be false.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <var>use distinctive identifier</var> value be this object's <var>use
                      distinctive identifier</var> value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <var>cdm implementation</var> value be this object's <var>cdm
                      implementation</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let the <var>cdm instance</var> value be this object's <var>cdm
                      instance</var>.
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>session</var>.
                </p>
              </li>
            </ol>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeys-getstatusforpolicy" data-idl="operation" data-title="getStatusForPolicy()" data-dfn-for="MediaKeys" data-type="Promise" data-lt="getStatusForPolicy()|getStatusForPolicy(policy)" data-local-lt="MediaKeys.getStatusForPolicy|MediaKeys.getStatusForPolicy()|getStatusForPolicy" tabindex="0" aria-haspopup="dialog"><code>getStatusForPolicy()</code></dfn>
          </dt>
          <dd>
            <p id="status-for-policy">
              Returns the <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-2"><code>MediaKeyStatus</code></a> for a given <a data-link-type="idl" data-lt="MediaKeysPolicy" href="#dom-mediakeyspolicy" class="internalDFN" id="ref-for-dom-mediakeyspolicy-2"><code>MediaKeysPolicy</code></a>.
            </p>
            <div>
              <pre class="idl def" id="webidl-894490038"><span class="idlHeader"><a class="self-link" href="#webidl-894490038">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-mediakeyspolicy" data-title="MediaKeysPolicy">dictionary <dfn data-export="" data-dfn-type="dictionary" id="dom-mediakeyspolicy" data-idl="dictionary" data-title="MediaKeysPolicy" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>MediaKeysPolicy</code></dfn> {<span data-idl="" class="idlMember" id="idl-def-mediakeyspolicy-minhdcpversion" data-title="minHdcpVersion" data-dfn-for="MediaKeysPolicy"><span class="idlType">
    <a data-link-type="idl" href="#dom-hdcpversion" class="internalDFN" id="ref-for-dom-hdcpversion-1"><code>HDCPVersion</code></a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeyspolicy-minhdcpversion" data-idl="field" data-title="minHdcpVersion" data-dfn-for="MediaKeysPolicy" data-type="HDCPVersion" class="idlName" tabindex="0" aria-haspopup="dialog"><code>minHdcpVersion</code></dfn>;</span>
};</span></code></pre>
              <p>
                The <a data-link-type="idl" data-lt="MediaKeysPolicy" href="#dom-mediakeyspolicy" class="internalDFN" id="ref-for-dom-mediakeyspolicy-3"><code>MediaKeysPolicy</code></a> dictionary is an object consisting of only optional
                properties. Each property represents a policy requirement. A policy is said to be
                fulfilled if the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-33">CDM</a> would allow presentation of decrypted media data based on
                all of the requirements.
              </p>
            </div>
            <div>
              <pre class="idl def" id="webidl-1149655754"><span class="idlHeader"><a class="self-link" href="#webidl-1149655754">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-hdcpversion" data-title="HDCPVersion">enum <dfn data-export="" data-dfn-type="enum" id="dom-hdcpversion" data-idl="enum" data-title="HDCPVersion" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>HDCPVersion</code></dfn> {
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-1.0" data-idl="enum-value" data-title="1.0" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>1.0</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-1.1" data-idl="enum-value" data-title="1.1" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>1.1</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-1.2" data-idl="enum-value" data-title="1.2" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>1.2</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-1.3" data-idl="enum-value" data-title="1.3" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>1.3</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-1.4" data-idl="enum-value" data-title="1.4" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>1.4</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-2.0" data-idl="enum-value" data-title="2.0" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>2.0</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-2.1" data-idl="enum-value" data-title="2.1" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>2.1</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-2.2" data-idl="enum-value" data-title="2.2" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>2.2</code></dfn>"</span>,
    <span class="idlEnumItem">"<dfn data-export="" data-dfn-type="enum-value" id="dom-hdcpversion-2.3" data-idl="enum-value" data-title="2.3" data-dfn-for="HDCPVersion" tabindex="0" aria-haspopup="dialog"><code>2.3</code></dfn>"</span>,
};</span></code></pre>
              <p>
                The HDCP Policy is represented by <a data-link-type="idl" href="#dom-mediakeyspolicy-minhdcpversion" class="internalDFN" id="ref-for-dom-mediakeyspolicy-minhdcpversion-1"><code>minHdcpVersion</code></a>. When set, the
                policy requirement will be fulfilled if the system supports
                <a data-link-type="idl" href="#dom-mediakeyspolicy-minhdcpversion" class="internalDFN" id="ref-for-dom-mediakeyspolicy-minhdcpversion-2"><code>minHdcpVersion</code></a> on the current display.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-59"><div role="heading" class="note-title marker" id="h-note-59" aria-level="4"><span>Note</span></div><p class="">
                The determination of HDCP status should be done in the same way that the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-34">CDM</a>
                would enforce such a restriction during playback. In this way, application
                developers can get a reasonable hint to allow them to optimize what content they
                fetch to start playback.
              </p></div>
            </div>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>If <var>policy</var> has no <a data-link-type="dfn|abstract-op" data-lt="exist" data-type="dfn" href="https://infra.spec.whatwg.org/#map-exists">present</a> <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary-member">dictionary members</a>, return
              a promise rejected with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-3"><code><code>TypeError</code></code></a>.
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
                <ol>
                  <li>
                    <p>
                      For each <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary-member">dictionary member</a> of <var>policy</var>, run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-35">CDM</a> cannot determine the <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-3"><code>MediaKeyStatus</code></a> for the
                          <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary-member">dictionary member</a>, then reject <var>promise</var> with
                          <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-4"><code><code>NotSupportedError</code></code></a> and abort these steps.
                        </p>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      For each <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary-member">dictionary member</a> of <var>policy</var>, run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-36">CDM</a> would block presentation of decrypted media data for the
                          <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary-member">dictionary member</a>, then resolve <var>promise</var> with
                          "<a data-link-type="idl" href="#dom-mediakeystatus-output-restricted" class="internalDFN" id="ref-for-dom-mediakeystatus-output-restricted-1"><code>output-restricted</code></a>".
                        </p>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      Resolve <var>promise</var> with "<a data-link-type="idl" href="#dom-mediakeystatus-usable" class="internalDFN" id="ref-for-dom-mediakeystatus-usable-1"><code>usable</code></a>".
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeys-setservercertificate" data-idl="operation" data-title="setServerCertificate()" data-dfn-for="MediaKeys" data-type="Promise" data-lt="setServerCertificate()|setServerCertificate(serverCertificate)" data-local-lt="MediaKeys.setServerCertificate|MediaKeys.setServerCertificate()|setServerCertificate" tabindex="0" aria-haspopup="dialog"><code>setServerCertificate()</code></dfn>
          </dt>
          <dd>
            <p id="server-certificate">
              Provides a server certificate to be used to encrypt messages to the license server.
            </p>
            <p>
              <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-19">Key Systems</a> that use such certificates <em class="rfc2119">MUST</em> also support requesting the
              certificate from the server via the <a data-link-type="dfn|abstract-op" href="#dfn-queue-a-message-event" class="internalDFN" id="ref-for-dfn-queue-a-message-event-1">Queue a "message" Event</a> algorithm.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-60"><div role="heading" class="note-title marker" id="h-note-60" aria-level="4"><span>Note</span></div><p class="">
              This method allows an application to proactively provide a server certificate to
              implementations that support it to avoid the additional round trip should the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-37">CDM</a>
              request it. It is intended as an optimization, and applications are not required to
              use it.
            </p></div>
            <p>
              The server certificate contents are <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-20">Key System</a>-specific. It <em class="rfc2119">MUST NOT</em> contain
              executable code.
            </p>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  If the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-21">Key System</a> implementation represented by this object's <var>cdm
                  implementation</var> value does not support server certificates, return a promise
                  resolved with <code>false</code>.
                </p>
              </li>
              <li>
                <p>
                  If <var>serverCertificate</var> is an empty array, return a promise rejected with
                  a new a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-4"><code><code>TypeError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>certificate</var> be a copy of the contents of the
                  <var>serverCertificate</var> parameter.
                </p>
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>sanitized certificate</var> be a validated and/or sanitized version
                      of <var>certificate</var>.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-61"><div role="heading" class="note-title marker" id="h-note-61" aria-level="4"><span>Note</span></div><p class="">
                      The user agent should thoroughly validate the certificate before passing it
                      to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-38">CDM</a>. This may include verifying values are within reasonable
                      limits, stripping irrelevant data or fields, pre-parsing it, sanitizing it,
                      and/or generating a fully sanitized version. The user agent should check that
                      the length and values of fields are reasonable. Unknown fields should be
                      rejected or removed.
                    </p></div>
                  </li>
                  <li>
                    <p>
                      Use this object's <var>cdm instance</var> to process <var>sanitized
                      certificate</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the preceding step failed, reject <var>promise</var> with a new
                      <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> whose name is the appropriate <a href="#error-names">error
                      name</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Resolve <var>promise</var> with <code>true</code>.
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
        </dl>
      </section>
      <section id="algorithms-0"><div class="header-wrapper"><h3 id="x5-2-algorithms"><bdi class="secno">5.2 </bdi>
          Algorithms
        </h3><a class="self-link" href="#algorithms-0" aria-label="Permalink for Section 5.2"></a></div>
        
        <section id="is-persistent-session-type"><div class="header-wrapper"><h4 id="x5-2-1-is-persistent-session-type"><bdi class="secno">5.2.1 </bdi>
            <dfn id="dfn-is-persistent-session-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Is persistent session type?</dfn>
          </h4><a class="self-link" href="#is-persistent-session-type" aria-label="Permalink for Section 5.2.1"></a></div>
          
          <p>
            The Is persistent session type? algorithm is run to determine whether the specified
            session type supports persistence of any kind. Requests to run this algorithm include a
            <a data-link-type="idl" data-lt="MediaKeySessionType" href="#dom-mediakeysessiontype" class="internalDFN" id="ref-for-dom-mediakeysessiontype-4"><code>MediaKeySessionType</code></a> value.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>session type</var> be the specified <a data-link-type="idl" data-lt="MediaKeySessionType" href="#dom-mediakeysessiontype" class="internalDFN" id="ref-for-dom-mediakeysessiontype-5"><code>MediaKeySessionType</code></a> value.
              </p>
            </li>
            <li>
              <p>
                Follow the steps for the value of <var>session type</var> from the following list:
              </p>
              <dl class="switch">
                <dt>
                  "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-7"><code>temporary</code></a>"
                </dt>
                <dd>
                  Return <code>false</code>.
                </dd>
                <dt>
                  "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-2"><code>persistent-license</code></a>"
                </dt>
                <dd>
                  Return <code>true</code>.
                </dd>
              </dl>
            </li>
          </ol>
        </section>
        <section id="cdm-unavailable"><div class="header-wrapper"><h4 id="x5-2-2-cdm-unavailable"><bdi class="secno">5.2.2 </bdi>
            <dfn id="dfn-cdm-unavailable" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">CDM Unavailable</dfn>
          </h4><a class="self-link" href="#cdm-unavailable" aria-label="Permalink for Section 5.2.2"></a></div>
          
          <p>
            The CDM unavailable algorithm is run to close all <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-9"><code>MediaKeySession</code></a> objects
            associated with a <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-16"><code>MediaKeys</code></a> object, <var>media keys</var> when the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-39">CDM</a> instance
            becomes unavailable.
          </p>
          <p>
            The following step is run:
          </p>
          <ol>
            <li>
              <p>
                For each <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-10"><code>MediaKeySession</code></a> created by the <var>media keys</var> that is not
                <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-1">closed</a>, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to run the <a data-link-type="dfn|abstract-op" href="#dfn-session-closed" class="internalDFN" id="ref-for-dfn-session-closed-1">Session Closed</a>
                algorithm on the session with reason "<a data-link-type="idl" href="#dom-mediakeystatus-internal-error" class="internalDFN" id="ref-for-dom-mediakeystatus-internal-error-1"><code>internal-error</code></a>".
              </p>
            </li>
          </ol>
        </section>
      </section>
      <section id="media-keys-storage"><div class="header-wrapper"><h3 id="x5-3-storage-and-persistence"><bdi class="secno">5.3 </bdi>
          <dfn id="dfn-storage-and-persistence" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Storage and Persistence</dfn>
        </h3><a class="self-link" href="#media-keys-storage" aria-label="Permalink for Section 5.3"></a></div>
        
        <p>
          This section describes general requirements related to storage and persistence.
        </p>
        <p>
          If a <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-17"><code>MediaKeys</code></a> object's <var>persistent state allowed</var> value is
          <code>false</code> then the object's <var>cdm instance</var> <em class="rfc2119">SHALL NOT</em> persist state or
          access previously persisted state as a result of operations on this object or any
          sessions that it creates.
        </p>
        <p>
          If a <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-18"><code>MediaKeys</code></a> object's <var>persistent state allowed</var> value is
          <code>true</code> then the object's <var>cdm instance</var> <em class="rfc2119">MAY</em> persist state or access
          previously persisted state as a result of operations on this object or any sessions that
          it creates.
        </p>
        <p>
          Persisted data <em class="rfc2119">MUST</em> always be stored such that only the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of this object's
          <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> can access it. In addition, the data <em class="rfc2119">MUST</em> only be accessible by the current
          <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-2">browsing profile</a>; other browsing profiles, user agents, and applications <em class="rfc2119">MUST NOT</em> be
          able to access the stored data. See <a href="#privacy-storedinfo">Information Stored on
          User Devices</a>.
        </p>
        <p>
          See <a href="#security" class="sec-ref"><bdi class="secno">10. </bdi>
        Security</a> and <a href="#privacy" class="sec-ref"><bdi class="secno">11. </bdi>
        Privacy</a> for additional considerations
          when supporting persistent storage.
        </p>
      </section>
    </section>
    <section id="mediakeysession-interface"><div class="header-wrapper"><h2 id="x6-mediakeysession-interface"><bdi class="secno">6. </bdi>
        <dfn data-export="" data-dfn-type="interface" id="dom-mediakeysession" data-idl="interface" data-title="MediaKeySession" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeySession</code></dfn> Interface
      </h2><a class="self-link" href="#mediakeysession-interface" aria-label="Permalink for Section 6."></a></div>
      
      <p>
        The <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-11"><code>MediaKeySession</code></a> object represents a <a data-link-type="dfn|abstract-op" href="#dfn-key-session" class="internalDFN" id="ref-for-dfn-key-session-2">key session</a>.
      </p>
      <p>
        A <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-12"><code>MediaKeySession</code></a> object is <dfn data-dfn-for="media key session" id="dfn-closed" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">closed</dfn> if and
        only if the object's <a data-link-type="idl" href="#dom-mediakeysession-closed" class="internalDFN" id="ref-for-dom-mediakeysession-closed-2"><code>closed</code></a> attribute has been resolved.
      </p>
      <p>
        The User Agent <em class="rfc2119">SHALL</em> execute the <a data-link-type="dfn|abstract-op" href="#dfn-monitor-for-cdm-state-changes" class="internalDFN" id="ref-for-dfn-monitor-for-cdm-state-changes-1">Monitor for CDM State Changes</a> algorithm continuously
        for each <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-13"><code>MediaKeySession</code></a> object that is not <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-2">closed</a>. The <a data-link-type="dfn|abstract-op" href="#dfn-monitor-for-cdm-state-changes" class="internalDFN" id="ref-for-dfn-monitor-for-cdm-state-changes-2">Monitor for CDM State Changes</a> algorithm <em class="rfc2119">MUST</em> be run in parallel to the main event loop but not in
        parallel to other procedures defined in this specification that are also defined to be run
        in parallel.
      </p>
      <p>
        A <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-14"><code>MediaKeySession</code></a> object <em class="rfc2119">SHALL NOT</em> be destroyed and <em class="rfc2119">SHALL</em> continue to receive events if
        it is not <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-3">closed</a> and the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-19"><code>MediaKeys</code></a> object that created it remains
        accessible. Otherwise, a <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-15"><code>MediaKeySession</code></a> object that is no longer accessible <em class="rfc2119">SHALL NOT</em>
        receive further events and <em class="rfc2119">MAY</em> be destroyed.
      </p>
      <div class="note" role="note" id="issue-container-generatedID-62"><div role="heading" class="note-title marker" id="h-note-62" aria-level="3"><span>Note</span></div><p class="">
        The above rule implies that the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-40">CDM</a> instance must not be destroyed until all
        <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-20"><code>MediaKeys</code></a> objects and all <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-16"><code>MediaKeySession</code></a> objects associated with the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-41">CDM</a>
        instance are destroyed.
      </p></div>
      <p>
        If a <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-17"><code>MediaKeySession</code></a> object is not <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-4">closed</a> when it becomes
        inaccessible to the page, the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-42">CDM</a> <em class="rfc2119">SHALL</em> close the <a data-link-type="dfn|abstract-op" href="#dfn-key-session" class="internalDFN" id="ref-for-dfn-key-session-3">key session</a> associated with the
        object.
      </p>
      <div class="note" role="note" id="issue-container-generatedID-63"><div role="heading" class="note-title marker" id="h-note-63" aria-level="3"><span>Note</span></div><p class="">
        Closing the key session results in the destruction of any license(s) and key(s) that have
        not been explicitly stored.
      </p></div>
      <div class="note" role="note" id="issue-container-generatedID-64"><div role="heading" class="note-title marker" id="h-note-64" aria-level="3"><span>Note</span></div><p class="">
        Exactly when the key session is closed is an implementation detail, and applications <em class="rfc2119">SHOULD NOT</em> rely on specific timing. 
        
         Applications that want to ensure a session is closed before taking some other action
        <em class="rfc2119">SHOULD</em> call <a data-link-type="idl" data-lt="close()" href="#dom-mediakeysession-close" class="internalDFN" id="ref-for-dom-mediakeysession-close-1"><code>close</code></a><code>()</code> and wait for the returned promise to be resolved.
      </p></div>
      <p>
        For methods that return a promise, all errors are reported asynchronously by rejecting the
        returned Promise. This includes [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] type mapping errors.
      </p>
      <p>
        The following steps of an algorithm are always aborted when rejecting a promise.
      </p>
      <pre class="idl def" id="webidl-103604943"><span class="idlHeader"><a class="self-link" href="#webidl-103604943">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-mediakeysessionclosedreason" data-title="MediaKeySessionClosedReason">enum <a class="internalDFN idlID" data-link-type="enum" href="#dom-mediakeysessionclosedreason" id="ref-for-dom-mediakeysessionclosedreason-1"><code>MediaKeySessionClosedReason</code></a> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysessionclosedreason-internal-error" id="ref-for-dom-mediakeysessionclosedreason-internal-error-1"><code>internal-error</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysessionclosedreason-closed-by-application" id="ref-for-dom-mediakeysessionclosedreason-closed-by-application-1"><code>closed-by-application</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysessionclosedreason-release-acknowledged" id="ref-for-dom-mediakeysessionclosedreason-release-acknowledged-1"><code>release-acknowledged</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysessionclosedreason-hardware-context-reset" id="ref-for-dom-mediakeysessionclosedreason-hardware-context-reset-1"><code>hardware-context-reset</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeysessionclosedreason-resource-evicted" id="ref-for-dom-mediakeysessionclosedreason-resource-evicted-1"><code>resource-evicted</code></a>"</span>
};</span></code></pre>
      <p>
        The <dfn data-export="" data-dfn-type="enum" id="dom-mediakeysessionclosedreason" data-idl="enum" data-title="MediaKeySessionClosedReason" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeySessionClosedReason</code></dfn> enumeration is defined as follows:
      </p>
      <table class="simple" data-dfn-for="MediaKeySessionClosedReason">
        <tbody>
          <tr>
            <th colspan="2">
              Enumeration description
            </th>
          </tr>
          <tr>
            <td>
              <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysessionclosedreason-internal-error" data-idl="enum-value" data-title="internal-error" data-dfn-for="MediaKeySessionClosedReason" tabindex="0" aria-haspopup="dialog"><code>internal-error</code></dfn>
            </td>
            <td>
              The session was closed because of an unrecoverable error in the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-43">CDM</a>. When this
              occurs, applications <em class="rfc2119">MUST NOT</em> create new sessions on this <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-21"><code>MediaKeys</code></a> instance.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysessionclosedreason-closed-by-application" data-idl="enum-value" data-title="closed-by-application" data-dfn-for="MediaKeySessionClosedReason" tabindex="0" aria-haspopup="dialog"><code>closed-by-application</code></dfn>
            </td>
            <td>
              The session was closed by the application calling the <a data-link-type="idl" data-lt="close()" href="#dom-mediakeysession-close" class="internalDFN" id="ref-for-dom-mediakeysession-close-2"><code>close</code></a><code>()</code>
              method of the session explicitly.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysessionclosedreason-release-acknowledged" data-idl="enum-value" data-title="release-acknowledged" data-dfn-for="MediaKeySessionClosedReason" tabindex="0" aria-haspopup="dialog"><code>release-acknowledged</code></dfn>
            </td>
            <td>
              The session was closed because the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-44">CDM</a> received a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-4">record of license destruction</a> acknowledgement.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysessionclosedreason-hardware-context-reset" data-idl="enum-value" data-title="hardware-context-reset" data-dfn-for="MediaKeySessionClosedReason" tabindex="0" aria-haspopup="dialog"><code>hardware-context-reset</code></dfn>
            </td>
            <td>
              The session was closed because the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-45">CDM</a>'s original hardware context was reset.
              When this occurs, the User Agent <em class="rfc2119">MUST</em> allow the application to create new sessions on
              this <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-22"><code>MediaKeys</code></a> instance.
              <div class="note" role="note" id="issue-container-generatedID-65"><div role="heading" class="note-title marker" id="h-note-65" aria-level="3"><span>Note</span></div><div class="">
                <p>
                  This could occur for many reasons, including device hibernation, monitor
                  configuration change, etc. The exact reasons for a hardware context reset are
                  implementation-dependent.
                </p>
              </div></div>
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeysessionclosedreason-resource-evicted" data-idl="enum-value" data-title="resource-evicted" data-dfn-for="MediaKeySessionClosedReason" tabindex="0" aria-haspopup="dialog"><code>resource-evicted</code></dfn>
            </td>
            <td>
              The session was closed because the system needed to reclaim resources to allow the
              creation of other sessions.
              <div class="note" role="note" id="issue-container-generatedID-66"><div role="heading" class="note-title marker" id="h-note-66" aria-level="3"><span>Note</span></div><div class="">
                <p>
                  This would imply that the application is running into a device-specific limit on
                  session resources. If the closed session is still needed for some reason, the
                  application developer should consider some strategy to reduce the number of
                  sessions needed or proactively close unneeded sessions.
                </p>
              </div></div>
            </td>
          </tr>
        </tbody>
      </table>
      <pre class="idl def" id="webidl-782043315"><span class="idlHeader"><a class="self-link" href="#webidl-782043315">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-mediakeysession" data-title="MediaKeySession">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>] interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-mediakeysession" id="ref-for-dom-mediakeysession-18"><code>MediaKeySession</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" class="idlAttribute" id="idl-def-mediakeysession-sessionid" data-title="sessionId" data-dfn-for="MediaKeySession">
  readonly        attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span>                            <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeysession-sessionid" id="ref-for-dom-mediakeysession-sessionid-2"><code>sessionId</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeysession-expiration" data-title="expiration" data-dfn-for="MediaKeySession">
  readonly        attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span>                  <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeysession-expiration" id="ref-for-dom-mediakeysession-expiration-2"><code>expiration</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeysession-closed" data-title="closed" data-dfn-for="MediaKeySession">
  readonly        attribute<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" href="#dom-mediakeysessionclosedreason" class="internalDFN" id="ref-for-dom-mediakeysessionclosedreason-2"><code>MediaKeySessionClosedReason</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeysession-closed" id="ref-for-dom-mediakeysession-closed-3"><code>closed</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeysession-keystatuses" data-title="keyStatuses" data-dfn-for="MediaKeySession">
  readonly        attribute<span class="idlType"> <a data-link-type="idl" href="#dom-mediakeystatusmap" class="internalDFN" id="ref-for-dom-mediakeystatusmap-2"><code>MediaKeyStatusMap</code></a></span>                    <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeysession-keystatuses" id="ref-for-dom-mediakeysession-keystatuses-2"><code>keyStatuses</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeysession-onkeystatuseschange" data-title="onkeystatuseschange" data-dfn-for="MediaKeySession">
                  attribute<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>                         <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeysession-onkeystatuseschange" id="ref-for-dom-mediakeysession-onkeystatuseschange-1"><code>onkeystatuseschange</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeysession-onmessage" data-title="onmessage" data-dfn-for="MediaKeySession">
                  attribute<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>                         <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeysession-onmessage" id="ref-for-dom-mediakeysession-onmessage-1"><code>onmessage</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-mediakeysession-generaterequest-initdatatype-initdata" data-title="generateRequest" data-dfn-for="MediaKeySession"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span>    <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeysession-generaterequest" id="ref-for-dom-mediakeysession-generaterequest-3"><code>generateRequest</code></a> (<span class="idlType"><a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">initDataType</span>,<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <span class="idlParamName">initData</span>);</span><span data-idl="" class="idlMethod" id="idl-def-mediakeysession-load-sessionid" data-title="load" data-dfn-for="MediaKeySession"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeysession-load" id="ref-for-dom-mediakeysession-load-2"><code>load</code></a> (<span class="idlType"><a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">sessionId</span>);</span><span data-idl="" class="idlMethod" id="idl-def-mediakeysession-update-response" data-title="update" data-dfn-for="MediaKeySession"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span>    <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeysession-update" id="ref-for-dom-mediakeysession-update-5"><code>update</code></a> (<span class="idlType"><a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <span class="idlParamName">response</span>);</span><span data-idl="" class="idlMethod" id="idl-def-mediakeysession-close" data-title="close" data-dfn-for="MediaKeySession"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span>    <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeysession-close" id="ref-for-dom-mediakeysession-close-3"><code>close</code></a> ();</span><span data-idl="" class="idlMethod" id="idl-def-mediakeysession-remove" data-title="remove" data-dfn-for="MediaKeySession"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span>    <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeysession-remove" id="ref-for-dom-mediakeysession-remove-2"><code>remove</code></a> ();</span>
};</span></code></pre>
      <section id="attributes-0"><div class="header-wrapper"><h3 id="x6-1-attributes"><bdi class="secno">6.1 </bdi>
          Attributes
        </h3><a class="self-link" href="#attributes-0" aria-label="Permalink for Section 6.1"></a></div>
        
        <dl class="attributes" data-dfn-for="MediaKeySession">
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeysession-sessionid" data-idl="attribute" data-title="sessionId" data-dfn-for="MediaKeySession" data-type="DOMString" data-lt="sessionId" data-local-lt="MediaKeySession.sessionId" tabindex="0" aria-haspopup="dialog"><code>sessionId</code></dfn> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, readonly
          </dt>
          <dd>
            <p>
              The <a data-link-type="dfn|abstract-op" href="#dfn-session-id" class="internalDFN" id="ref-for-dfn-session-id-3">Session ID</a> for this object and the associated key(s) or license(s).
            </p>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeysession-expiration" data-idl="attribute" data-title="expiration" data-dfn-for="MediaKeySession" data-type="unrestricted double" data-lt="expiration" data-local-lt="MediaKeySession.expiration" tabindex="0" aria-haspopup="dialog"><code>expiration</code></dfn> of type <a data-link-type="idl" data-lt="unrestricted double" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double"><code>unrestricted double</code></a>, readonly
          </dt>
          <dd>
            <p>
              The <a data-link-type="dfn|abstract-op" href="#dfn-expiration" class="internalDFN" id="ref-for-dfn-expiration-2">expiration time</a> for all key(s) in the session, or <code>NaN</code> if no such
              time exists or if the license explicitly never expires, as determined by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-46">CDM</a>.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-67"><div role="heading" class="note-title marker" id="h-note-67" aria-level="4"><span>Note</span></div><p class="">
              This value <em class="rfc2119">MAY</em> change during the session lifetime, such as when an action triggers
              the start of a window.
            </p></div>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeysession-closed" data-idl="attribute" data-title="closed" data-dfn-for="MediaKeySession" data-type="Promise" data-lt="closed" data-local-lt="MediaKeySession.closed" tabindex="0" aria-haspopup="dialog"><code>closed</code></dfn> of type <span class="idlAttrType">Promise&lt;<a data-link-type="idl" data-lt="MediaKeySessionClosedReason" href="#dom-mediakeysessionclosedreason" class="internalDFN" id="ref-for-dom-mediakeysessionclosedreason-3"><code>MediaKeySessionClosedReason</code></a>&gt;</span>, readonly
          </dt>
          <dd>
            <p>
              Signals when the object becomes <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-5">closed</a> as a result of the
              <a data-link-type="dfn|abstract-op" href="#dfn-session-closed" class="internalDFN" id="ref-for-dfn-session-closed-2">Session Closed</a> algorithm being run. This promise can only be fulfilled and is
              never rejected.
            </p>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeysession-keystatuses" data-idl="attribute" data-title="keyStatuses" data-dfn-for="MediaKeySession" data-type="MediaKeyStatusMap" data-lt="keyStatuses" data-local-lt="MediaKeySession.keyStatuses" tabindex="0" aria-haspopup="dialog"><code>keyStatuses</code></dfn> of type <a data-link-type="idl" data-lt="MediaKeyStatusMap" href="#dom-mediakeystatusmap" class="internalDFN" id="ref-for-dom-mediakeystatusmap-3"><code>MediaKeyStatusMap</code></a>, readonly
          </dt>
          <dd>
            <p>
              A reference to a read-only map of <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-5">key IDs</a> <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-1">known</a> to the session to the current
              status of the associated key. Each entry <em class="rfc2119">MUST</em> have a unique key ID.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-68"><div role="heading" class="note-title marker" id="h-note-68" aria-level="4"><span>Note</span></div><p class="">
              The map entries and their values may be updated whenever the event loop spins. The
              map <em class="rfc2119">MUST NOT</em> ever be inconsistent or partially updated, but it may change between
              accesses if the event loop spins in between the accesses. Key IDs may be added as the
              result of a <a data-link-type="idl" data-lt="load()" href="#dom-mediakeysession-load" class="internalDFN" id="ref-for-dom-mediakeysession-load-3"><code>load</code></a><code>()</code> or <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-6"><code>update</code></a><code>()</code> call. Key IDs
              may be removed as the result of a <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-7"><code>update</code></a><code>()</code> call that removes
              knowledge of existing keys (or replaces the existing set of keys with a new set). Key
              IDs <em class="rfc2119">MUST NOT</em> be removed because they became unusable, such as due to expiration.
              Instead, such keys <em class="rfc2119">MUST</em> be given an appropriate status, such as
              "<a data-link-type="idl" href="#dom-mediakeystatus-expired" class="internalDFN" id="ref-for-dom-mediakeystatus-expired-1"><code>expired</code></a>".
            </p></div>
            <div class="note" role="note" id="issue-container-generatedID-69"><div role="heading" class="note-title marker" id="h-note-69" aria-level="4"><span>Note</span></div><p class="">
              Some older platforms may contain <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-22">Key System</a> implementations that do not expose
              key IDs, making it impossible to provide a compliant user agent implementation. To
              maximize interoperability, user agent implementations exposing such <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-47">CDMs</a> <em class="rfc2119">SHOULD</em>
              implement this member as follows: Whenever a non-empty list is appropriate, such as
              when the <a data-link-type="dfn|abstract-op" href="#dfn-key-session" class="internalDFN" id="ref-for-dfn-key-session-4">key session</a> represented by this object may contain <a data-link-type="dfn|abstract-op" href="#dfn-key-s" class="internalDFN" id="ref-for-dfn-key-s-5">key(s)</a>, populate
              the map with a single pair containing the one-byte key ID <code>0</code> and the
              <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-4"><code>MediaKeyStatus</code></a> most appropriate for the aggregated status of this object.
            </p></div>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeysession-onkeystatuseschange" data-idl="attribute" data-title="onkeystatuseschange" data-dfn-for="MediaKeySession" data-type="EventHandler" data-lt="onkeystatuseschange" data-local-lt="MediaKeySession.onkeystatuseschange" tabindex="0" aria-haspopup="dialog"><code>onkeystatuseschange</code></dfn> of type <a data-link-type="idl" data-lt="EventHandler" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a>
          </dt>
          <dd>
            <p>
              Event handler for the <a data-link-type="idl" data-lt="keystatuseschange" href="#dfn-keystatuseschange" class="internalDFN" id="ref-for-dfn-keystatuseschange-1"><code><code>keystatuseschange</code></code></a> event.
            </p>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeysession-onmessage" data-idl="attribute" data-title="onmessage" data-dfn-for="MediaKeySession" data-type="EventHandler" data-lt="onmessage" data-local-lt="MediaKeySession.onmessage" tabindex="0" aria-haspopup="dialog"><code>onmessage</code></dfn> of type <a data-link-type="idl" data-lt="EventHandler" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a>
          </dt>
          <dd>
            <p>
              Event handler for the <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-2"><code><code>message</code></code></a> event.
            </p>
          </dd>
        </dl>
      </section>
      <section id="methods-2"><div class="header-wrapper"><h3 id="x6-2-methods"><bdi class="secno">6.2 </bdi>
          Methods
        </h3><a class="self-link" href="#methods-2" aria-label="Permalink for Section 6.2"></a></div>
        
        <dl class="methods" data-dfn-for="MediaKeySession">
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeysession-generaterequest" data-idl="operation" data-title="generateRequest()" data-dfn-for="MediaKeySession" data-type="Promise" data-lt="generateRequest()|generateRequest(initDataType, initData)" data-local-lt="MediaKeySession.generateRequest|MediaKeySession.generateRequest()|generateRequest" tabindex="0" aria-haspopup="dialog"><code>generateRequest()</code></dfn>
          </dt>
          <dd>
            <p>
              Generates a license request based on the <var>initData</var>. A <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-3"><code><code>message</code></code></a> of type
              "<a data-link-type="idl" href="#dom-mediakeymessagetype-license-request" class="internalDFN" id="ref-for-dom-mediakeymessagetype-license-request-1"><code>license-request</code></a>" or
              "<a data-link-type="idl" href="#dom-mediakeymessagetype-individualization-request" class="internalDFN" id="ref-for-dom-mediakeymessagetype-individualization-request-1"><code>individualization-request</code></a>" will always be queued if the
              algorithm succeeds and the promise is resolved.
            </p>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  If this object's <var>closing or closed</var> value is true, return a promise
                  rejected with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-2"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If this object's <var>uninitialized</var> value is false, return a promise
                  rejected with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-3"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  Let this object's <var>uninitialized</var> value be false.
                </p>
              </li>
              
              <li>
                <p>
                  If <var>initDataType</var> is the empty string, return a promise rejected with a
                  newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-5"><code><code>TypeError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If <var>initData</var> is an empty array, return a promise rejected with a newly
                  created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-6"><code><code>TypeError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-23">Key System</a> implementation represented by this object's <var>cdm
                  implementation</var> value does not support <var>initDataType</var> as an
                  <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-5">Initialization Data Type</a>, return a promise rejected with a
                  <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-5"><code><code>NotSupportedError</code></code></a>. String comparison is case-sensitive.
                </p>
              </li>
              <li>
                <p>
                  Let <var>init data</var> be a copy of the contents of the <var>initData</var>
                  parameter.
                </p>
              </li>
              <li>
                <p>
                  Let <var>session type</var> be this object's <var>session type</var>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      If the <var>init data</var> is not valid for <var>initDataType</var>, reject
                      <var>promise</var> with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-7"><code><code>TypeError</code></code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>sanitized init data</var> be a validated and sanitized version of
                      <var>init data</var>.
                    </p>
                    <p>
                      The user agent <em class="rfc2119">MUST</em> thoroughly validate the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-7">Initialization Data</a> before
                      passing it to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-48">CDM</a>. This includes verifying that the length and values
                      of fields are reasonable, verifying that values are within reasonable limits,
                      and stripping irrelevant, unsupported, or unknown data or fields. It is
                      <em class="rfc2119">RECOMMENDED</em> that user agents pre-parse, sanitize, and/or generate a fully
                      sanitized version of the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-8">Initialization Data</a>. If the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-9">Initialization Data</a> format specified by <var>initDataType</var> supports multiple entries,
                      the user agent <em class="rfc2119">SHOULD</em> remove entries that are not needed by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-49">CDM</a>. The
                      user agent <em class="rfc2119">MUST NOT</em> re-order entries within the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-10">Initialization Data</a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the preceding step failed, reject <var>promise</var> with a newly created
                      <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-8"><code><code>TypeError</code></code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If <var>sanitized init data</var> is empty, reject <var>promise</var> with a
                      <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-6"><code><code>NotSupportedError</code></code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>session id</var> be the empty string.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message type</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>cdm</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-50">CDM</a> instance represented by this object's
                      <var>cdm instance</var> value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Use the <var>cdm</var> to execute the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If the <var>sanitized init data</var> is not supported by the
                          <var>cdm</var>, reject <var>promise</var> with a <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-7"><code><code>NotSupportedError</code></code></a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Follow the steps for the value of <var>session type</var> from the
                          following list:
                        </p>
                        <dl class="switch">
                          <dt>
                            "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-8"><code>temporary</code></a>"
                          </dt>
                          <dd>
                            <p>
                              Let <var>requested license type</var> be a temporary non-persistable
                              license.
                            </p>
                            <div class="note" role="note" id="issue-container-generatedID-70"><div role="heading" class="note-title marker" id="h-note-70" aria-level="4"><span>Note</span></div><p class="">
                              The returned license must not be persistable or require persisting
                              information related to it.
                            </p></div>
                          </dd>
                          <dt>
                            "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-3"><code>persistent-license</code></a>"
                          </dt>
                          <dd>
                            <p>
                              Let <var>requested license type</var> be a persistable license.
                            </p>
                          </dd>
                        </dl>
                      </li>
                      <li>
                        <p>
                          Let <var>session id</var> be a unique <a data-link-type="dfn|abstract-op" href="#dfn-session-id" class="internalDFN" id="ref-for-dfn-session-id-4">Session ID</a> string.
                        </p>
                        <p>
                          If the result of running the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-5">Is persistent session type?</a> algorithm on
                          <var>session type</var> is <code>true</code>, the ID <em class="rfc2119">MUST</em> be unique
                          within the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of this object's <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> over time, including
                          across Documents and browsing sessions.
                        </p>
                      </li>
                      <li>
                        <dl class="switch">
                          <dt>
                            If a license request for the <var>requested license type</var> can be
                            generated based on the <var>sanitized init data</var>:
                          </dt>
                          <dd>
                            <ol>
                              <li>
                                <p>
                                  Let <var>message</var> be a license request for the
                                  <var>requested license type</var> generated based on the
                                  <var>sanitized init data</var> interpreted per
                                  <var>initDataType</var>.
                                </p>
                                <p>
                                  The <var>cdm</var> <em class="rfc2119">MUST NOT</em> use any stream-specific data,
                                  including <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>, not provided via the
                                  <var>sanitized init data</var>.
                                </p>
                                <p>
                                  The <var>cdm</var> <em class="rfc2119">SHOULD NOT</em> store session data, including the
                                  session ID, at this point. See <a href="#session-storage">Session
                                  Storage and Persistence</a>.
                                </p>
                              </li>
                              <li>
                                <p>
                                  Let <var>message type</var> be
                                  "<a data-link-type="idl" href="#dom-mediakeymessagetype-license-request" class="internalDFN" id="ref-for-dom-mediakeymessagetype-license-request-2"><code>license-request</code></a>".
                                </p>
                              </li>
                            </ol>
                          </dd>
                          <dt>
                            Otherwise:
                          </dt>
                          <dd>
                            <ol>
                              <li>
                                <p>
                                  Let <var>message</var> be the request that needs to be processed
                                  before a license request request for the <var>requested license
                                  type</var> can be generated based on the <var>sanitized init
                                  data</var>.
                                </p>
                                <p>
                                  In a subsequent call to <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-8"><code>update</code></a><code>()</code> the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-51">CDM</a>
                                  <em class="rfc2119">MUST</em> generate a license request for the <var>requested license
                                  type</var> based on the <var>sanitized init data</var>, which is
                                  interpreted per <var>initDataType</var>.
                                </p>
                              </li>
                              <li>
                                <p>
                                  Let <var>message type</var> reflect the type of
                                  <var>message</var>, either
                                  "<a data-link-type="idl" href="#dom-mediakeymessagetype-license-request" class="internalDFN" id="ref-for-dom-mediakeymessagetype-license-request-3"><code>license-request</code></a>" or
                                  "<a data-link-type="idl" href="#dom-mediakeymessagetype-individualization-request" class="internalDFN" id="ref-for-dom-mediakeymessagetype-individualization-request-2"><code>individualization-request</code></a>".
                                </p>
                              </li>
                            </ol>
                          </dd>
                        </dl>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If any of the preceding steps failed due to a lack of resources, reject
                          <var>promise</var> with <a data-link-type="idl" data-lt="QuotaExceededError" href="#dfn-quotaexceedederror" class="internalDFN" id="ref-for-dfn-quotaexceedederror-1"><code><code>QuotaExceededError</code></code></a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If any of the preceding steps failed for any other reason, reject
                          <var>promise</var> with a new <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> whose name is the
                          appropriate <a href="#error-names">error name</a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set the <a data-link-type="idl" href="#dom-mediakeysession-sessionid" class="internalDFN" id="ref-for-dom-mediakeysession-sessionid-3"><code>sessionId</code></a> attribute to <var>session id</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set this object's <var>callable</var> value to true.
                        </p>
                      </li>
                      <li>
                        <p>
                          Run the <a data-link-type="dfn|abstract-op" href="#dfn-queue-a-message-event" class="internalDFN" id="ref-for-dfn-queue-a-message-event-2">Queue a "message" Event</a> algorithm on the <var>session</var>,
                          providing <var>message type</var> and <var>message</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Resolve <var>promise</var>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-71"><div role="heading" class="note-title marker" id="h-note-71" aria-level="4"><span>Note</span></div><p class="">
                          Since promise handlers are queued as microtasks, these will be executed
                          ahead of any events queued by the preceding steps.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeysession-load" data-idl="operation" data-title="load()" data-dfn-for="MediaKeySession" data-type="Promise" data-lt="load()|load(sessionId)" data-local-lt="MediaKeySession.load|MediaKeySession.load()|load" tabindex="0" aria-haspopup="dialog"><code>load()</code></dfn>
          </dt>
          <dd>
            <p>
              Loads the data stored for the specified session into this object.
            </p>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  If this object's <var>closing or closed</var> value is true, return a promise
                  rejected with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-4"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If this object's <var>uninitialized</var> value is false, return a promise
                  rejected with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-5"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  Let this object's <var>uninitialized</var> value be false.
                </p>
              </li>
              
              <li>
                <p>
                  If <var>sessionId</var> is the empty string, return a promise rejected with a
                  newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-9"><code><code>TypeError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If the result of running the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-6">Is persistent session type?</a> algorithm on this
                  object's <var>session type</var> is <code>false</code>, return a promise rejected
                  with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-10"><code><code>TypeError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>origin</var> be the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of this object's <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>sanitized session ID</var> be a validated and/or sanitized version
                      of <var>sessionId</var>.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-72"><div role="heading" class="note-title marker" id="h-note-72" aria-level="4"><span>Note</span></div><p class="">
                      The user agent should thoroughly validate the sessionId value before passing
                      it to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-52">CDM</a>. At a minimum, this should include checking that the length
                      and value are reasonable (e.g., not longer than tens of characters and
                      alphanumeric).
                    </p></div>
                  </li>
                  <li>
                    <p>
                      If the preceding step failed, or if <var>sanitized session ID</var> is empty,
                      reject <var>promise</var> with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-11"><code><code>TypeError</code></code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If there is a <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-19"><code>MediaKeySession</code></a> object that is not <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-6">closed</a> in this object's <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> whose
                      <a data-link-type="idl" href="#dom-mediakeysession-sessionid" class="internalDFN" id="ref-for-dom-mediakeysession-sessionid-4"><code>sessionId</code></a> attribute is <var>sanitized session ID</var>,
                      reject <var>promise</var> with a <a data-link-type="idl" data-lt="QuotaExceededError" href="#dfn-quotaexceedederror" class="internalDFN" id="ref-for-dfn-quotaexceedederror-2"><code><code>QuotaExceededError</code></code></a>.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-73"><div role="heading" class="note-title marker" id="h-note-73" aria-level="4"><span>Note</span></div><p class="">
                      In other words, do not create a session if a non-closed session, regardless
                      of type, already exists for this <var>sanitized session ID</var> in this
                      browsing context.
                    </p></div>
                  </li>
                  <li>
                    <p>
                      Let <var>expiration time</var> be <code>NaN</code>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message type</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>cdm</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-53">CDM</a> instance represented by this object's
                      <var>cdm instance</var> value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Use the <var>cdm</var> to execute the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If there is no data stored for the <var>sanitized session ID</var> in the
                          <var>origin</var>, resolve <var>promise</var> with <code>false</code> and
                          abort these steps. 
                          
                        </p>
                      </li>
                      <li>
                        <p>
                          If the stored session's <var>session type</var> is not the same as the
                          current <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-20"><code>MediaKeySession</code></a> <var>session type</var>, reject
                          <var>promise</var> with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-12"><code><code>TypeError</code></code></a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Let <var>session data</var> be the data stored for the <var>sanitized
                          session ID</var> in the <var>origin</var>. This <em class="rfc2119">MUST NOT</em> include data
                          from other origin(s) or that is not associated with an origin.
                        </p>
                      </li>
                      <li>
                        <p>
                          If there is a <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-21"><code>MediaKeySession</code></a> object that is not <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-7">closed</a> in any <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> and that represents the <var>session
                          data</var>, reject <var>promise</var> with a <a data-link-type="idl" data-lt="QuotaExceededError" href="#dfn-quotaexceedederror" class="internalDFN" id="ref-for-dfn-quotaexceedederror-3"><code><code>QuotaExceededError</code></code></a>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-74"><div role="heading" class="note-title marker" id="h-note-74" aria-level="4"><span>Note</span></div><p class="">
                          In other words, do not create a session if a non-closed persistent
                          session already exists for this <var>sanitized session ID</var> in any
                          browsing context.
                        </p></div>
                      </li>
                      <li>
                        <p>
                          Load the <var>session data</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If the <var>session data</var> indicates an <a data-link-type="dfn|abstract-op" href="#dfn-expiration" class="internalDFN" id="ref-for-dfn-expiration-3">expiration time</a> for the
                          session, let <var>expiration time</var> be that expiration time.
                        </p>
                      </li>
                      <li>
                        <p>
                          If a message needs to be sent, execute the following steps:
                        </p>
                        <ol>
                          <li>
                            <p>
                              Let <var>message</var> be a message generated based on the
                              <var>session data</var>.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>message type</var> be the appropriate
                              <a data-link-type="idl" data-lt="MediaKeyMessageType" href="#dom-mediakeymessagetype" class="internalDFN" id="ref-for-dom-mediakeymessagetype-1"><code>MediaKeyMessageType</code></a> for the message.
                            </p>
                          </li>
                        </ol>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If any of the preceding steps failed, reject <var>promise</var> with the
                          appropriate <a href="#error-names">error name</a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set the <a data-link-type="idl" href="#dom-mediakeysession-sessionid" class="internalDFN" id="ref-for-dom-mediakeysession-sessionid-5"><code>sessionId</code></a> attribute to <var>sanitized session
                          ID</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Set this object's <var>callable</var> value to true.
                        </p>
                      </li>
                      <li>
                        <p>
                          If the loaded session contains information about any keys (there are
                          <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-2">known keys</a>), run the <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-1">Update Key Statuses</a> algorithm on the
                          <var>session</var>, providing each key's <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-6">key ID</a> along with the
                          appropriate <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-5"><code>MediaKeyStatus</code></a>.
                        </p>
                        <p>
                          Should additional processing be necessary to determine with certainty the
                          status of a key, use "<a data-link-type="idl" href="#dom-mediakeystatus-status-pending" class="internalDFN" id="ref-for-dom-mediakeystatus-status-pending-1"><code>status-pending</code></a>". Once the
                          additional processing for one or more keys has completed, run the
                          <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-2">Update Key Statuses</a> algorithm again with the actual status(es).
                        </p>
                      </li>
                      <li>
                        <p>
                          Run the <a data-link-type="dfn|abstract-op" href="#dfn-update-expiration" class="internalDFN" id="ref-for-dfn-update-expiration-1">Update Expiration</a> algorithm on the <var>session</var>,
                          providing <var>expiration time</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If <var>message</var> is not null, run the <a data-link-type="dfn|abstract-op" href="#dfn-queue-a-message-event" class="internalDFN" id="ref-for-dfn-queue-a-message-event-3">Queue a "message" Event</a>
                          algorithm on the <var>session</var>, providing <var>message type</var>
                          and <var>message</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Resolve <var>promise</var> with <code>true</code>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-75"><div role="heading" class="note-title marker" id="h-note-75" aria-level="4"><span>Note</span></div><p class="">
                          Since promise handlers are queued as microtasks, these will be executed
                          ahead of any events queued by the preceding steps.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeysession-update" data-idl="operation" data-title="update()" data-dfn-for="MediaKeySession" data-type="Promise" data-lt="update()|update(response)" data-local-lt="MediaKeySession.update|MediaKeySession.update()|update" tabindex="0" aria-haspopup="dialog"><code>update()</code></dfn>
          </dt>
          <dd>
            <p>
              Provides messages, including licenses, to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-54">CDM</a>.
            </p>
            <p>
              The <var>response</var> parameter contains a message to be provided to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-55">CDM</a>.
              The contents are <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-24">Key System</a>-specific. It <em class="rfc2119">MUST NOT</em> contain executable code.
            </p>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  If this object's <var>closing or closed</var> value is true, return a promise
                  rejected with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-6"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If this object's <var>callable</var> value is false, return a promise rejected
                  with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-7"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If <var>response</var> is an empty array, return a promise rejected with a newly
                  created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-13"><code><code>TypeError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>response copy</var> be a copy of the contents of the <var>response</var>
                  parameter.
                </p>
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>sanitized response</var> be a validated and/or sanitized version of
                      <var>response copy</var>.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-76"><div role="heading" class="note-title marker" id="h-note-76" aria-level="4"><span>Note</span></div><p class="">
                      The user agent should thoroughly validate the response before passing it to
                      the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-56">CDM</a>. This may include verifying values are within reasonable limits,
                      stripping irrelevant data or fields, pre-parsing it, sanitizing it, and/or
                      generating a fully sanitized version. The user agent should check that the
                      length and values of fields are reasonable. Unknown fields should be rejected
                      or removed.
                    </p></div>
                  </li>
                  <li>
                    <p>
                      If the preceding step failed, or if <var>sanitized response</var> is empty,
                      reject <var>promise</var> with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-14"><code><code>TypeError</code></code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message type</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>session closed</var> be false.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>cdm</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-57">CDM</a> instance represented by this object's
                      <var>cdm instance</var> value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Use the <var>cdm</var> to execute the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If the format of <var>sanitized response</var> is invalid in any way,
                          reject <var>promise</var> with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-15"><code><code>TypeError</code></code></a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Process <var>sanitized response</var>, following the stipulation for the
                          first matching condition from the following list:
                        </p>
                        <dl class="switch">
                          <dt>
                            If <var>sanitized response</var> contains a license or key(s)
                          </dt>
                          <dd>
                            <div class="note" role="note" id="issue-container-generatedID-77"><div role="heading" class="note-title marker" id="h-note-77" aria-level="4"><span>Note</span></div><p class="">
                              This includes an initial license, an updated license, and a license
                              renewal message.
                            </p></div>
                            <p>
                              Process <var>sanitized response</var>, following the stipulation for
                              the first matching condition from the following list:
                            </p>
                            <dl class="switch">
                              <dt>
                                If <var>sessionType</var> is "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-9"><code>temporary</code></a>"
                                and <var>sanitized response</var> does not specify that session
                                data, including any license, key(s), or similar session data it
                                contains, should be stored
                              </dt>
                              <dd>
                                Process <var>sanitized response</var>, not storing any session
                                data.
                              </dd>
                              <dt>
                                If <var>sessionType</var> is
                                "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-4"><code>persistent-license</code></a>" and <var>sanitized
                                response</var> contains a persistable license
                              </dt>
                              <dd>
                                Process <var>sanitized response</var>, storing the license/key(s)
                                and related session data contained in <var>sanitized
                                response</var>. Such data <em class="rfc2119">MUST</em> be stored such that only the
                                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of this object's <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> can access it.
                              </dd>
                              <dt>
                                Otherwise
                              </dt>
                              <dd>
                                <p>
                                  Reject <var>promise</var> with a newly created <a data-link-type="idl" data-lt="TypeError" href="#dfn-typeerror" class="internalDFN" id="ref-for-dfn-typeerror-16"><code><code>TypeError</code></code></a>.
                                </p>
                              </dd>
                            </dl>
                            <p>
                              See also <a href="#session-storage">Session Storage and
                              Persistence</a>.
                            </p>
                            <p>
                              State information, including keys, for each session <em class="rfc2119">MUST</em> be stored in
                              such a way that closing one session does not affect the observable
                              state in other session(s), even if they contain overlapping key IDs.
                            </p>
                            <div class="note" role="note" id="issue-container-generatedID-78"><div role="heading" class="note-title marker" id="h-note-78" aria-level="4"><span>Note</span></div><p class="">
                              When <var>sanitized response</var> contains key(s) and/or related
                              data, <var>cdm</var> will likely store (in memory) the key and
                              related data indexed by key ID.
                            </p></div>
                            <div class="note" role="note" id="issue-container-generatedID-79"><div role="heading" class="note-title marker" id="h-note-79" aria-level="4"><span>Note</span></div><p class="">
                              The replacement algorithm within a session is <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-25">Key System</a>-dependent.
                            </p></div>
                            <div class="note" role="note" id="issue-container-generatedID-80"><div role="heading" class="note-title marker" id="h-note-80" aria-level="4"><span>Note</span></div><p class="">
                              It is <em class="rfc2119">RECOMMENDED</em> that <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-58">CDM</a> implementations support a standard and
                              reasonably high minimum number of keys per <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-22"><code>MediaKeySession</code></a>
                              object, including a standard replacement algorithm, and a standard
                              and reasonably high minimum number of <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-23"><code>MediaKeySession</code></a> objects.
                              This enables a reasonable number of key rotation algorithms to be
                              implemented across user agents and may reduce the likelihood of
                              playback interruptions in use cases that involve various streams in
                              the same element (e.g., adaptive streams, various audio and video
                              tracks) using different keys.
                            </p></div>
                          </dd>
                          <dt>
                            If <var>sanitized response</var> contains a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-5">record of license destruction</a> acknowledgement and <var>sessionType</var> is
                            "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-5"><code>persistent-license</code></a>"
                          </dt>
                          <dd>
                            <p>
                              Run the following steps:
                            </p>
                            <ol>
                              <li>
                                <p>
                                  Close the <a data-link-type="dfn|abstract-op" href="#dfn-key-session" class="internalDFN" id="ref-for-dfn-key-session-5">key session</a> and clear <em>all</em> stored session
                                  data associated with this object, including the
                                  <a data-link-type="idl" href="#dom-mediakeysession-sessionid" class="internalDFN" id="ref-for-dom-mediakeysession-sessionid-6"><code>sessionId</code></a> and <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-6">record of license destruction</a>.
                                </p>
                                <div class="note" role="note" id="issue-container-generatedID-81"><div role="heading" class="note-title marker" id="h-note-81" aria-level="4"><span>Note</span></div><p class="">
                                  A subsequent call to <a data-link-type="idl" data-lt="load()" href="#dom-mediakeysession-load" class="internalDFN" id="ref-for-dom-mediakeysession-load-4"><code>load</code></a><code>()</code> with the value of
                                  this object's <a data-link-type="idl" href="#dom-mediakeysession-sessionid" class="internalDFN" id="ref-for-dom-mediakeysession-sessionid-7"><code>sessionId</code></a> would fail because
                                  there is no data stored for that session ID.
                                </p></div>
                              </li>
                              <li>
                                <p>
                                  Set <var>session closed</var> to true.
                                </p>
                              </li>
                            </ol>
                          </dd>
                          <dt>
                            Otherwise
                          </dt>
                          <dd>
                            Process <var>sanitized response</var>, not storing any session data.
                            <div class="note" role="note" id="issue-container-generatedID-82"><div role="heading" class="note-title marker" id="h-note-82" aria-level="4"><span>Note</span></div><p class="">
                              For example, <var>sanitized response</var> may contain information
                              that will be used to generate another <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-4"><code><code>message</code></code></a> event. In this
                              case, there is no need to verify the contents against the
                              <var>sessionType</var>.
                            </p></div>
                          </dd>
                        </dl>
                      </li>
                      <li>
                        <p>
                          If a message needs to be sent, execute the following steps:
                        </p>
                        <ol>
                          <li>
                            <p>
                              Let <var>message</var> be that message.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let <var>message type</var> be the appropriate
                              <a data-link-type="idl" data-lt="MediaKeyMessageType" href="#dom-mediakeymessagetype" class="internalDFN" id="ref-for-dom-mediakeymessagetype-2"><code>MediaKeyMessageType</code></a> for the message.
                            </p>
                          </li>
                        </ol>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to run the following steps:
                    </p>
                    <ol>
                      <li>
                        <dl class="switch">
                          <dt>
                            If <var>session closed</var> is true:
                          </dt>
                          <dd>
                            <p>
                              Run the <a data-link-type="dfn|abstract-op" href="#dfn-session-closed" class="internalDFN" id="ref-for-dfn-session-closed-3">Session Closed</a> algorithm on this object with reason
                              "<a data-link-type="idl" href="#dom-mediakeysessionclosedreason-release-acknowledged" class="internalDFN" id="ref-for-dom-mediakeysessionclosedreason-release-acknowledged-2"><code>release-acknowledged</code></a>".
                            </p>
                          </dd>
                          <dt>
                            Otherwise:
                          </dt>
                          <dd>
                            <p>
                              Run the following steps:
                            </p>
                            <ol>
                              <li>
                                <p>
                                  If the set of keys <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-3">known</a> to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-59">CDM</a> for this object
                                  changed or the status of any key(s) changed, run the <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-3">Update Key Statuses</a> algorithm on the <var>session</var>, providing each
                                  known key's <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-7">key ID</a> along with the appropriate
                                  <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-6"><code>MediaKeyStatus</code></a>.
                                </p>
                                <p>
                                  Should additional processing be necessary to determine with
                                  certainty the status of a key, use
                                  "<a data-link-type="idl" href="#dom-mediakeystatus-status-pending" class="internalDFN" id="ref-for-dom-mediakeystatus-status-pending-2"><code>status-pending</code></a>". Once the additional
                                  processing for one or more keys has completed, run the <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-4">Update Key Statuses</a> algorithm again with the actual status(es).
                                </p>
                              </li>
                              <li>
                                <p>
                                  If the <a data-link-type="dfn|abstract-op" href="#dfn-expiration" class="internalDFN" id="ref-for-dfn-expiration-4">expiration time</a> for the session changed, run the
                                  <a data-link-type="dfn|abstract-op" href="#dfn-update-expiration" class="internalDFN" id="ref-for-dfn-update-expiration-2">Update Expiration</a> algorithm on the <var>session</var>,
                                  providing the new expiration time.
                                </p>
                              </li>
                              <li>
                                <p>
                                  If any of the preceding steps failed, reject <var>promise</var>
                                  with a new <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> whose name is the appropriate
                                  <a href="#error-names">error name</a>.
                                </p>
                              </li>
                              <li>
                                <p>
                                  If <var>message</var> is not null, run the <a data-link-type="dfn|abstract-op" href="#dfn-queue-a-message-event" class="internalDFN" id="ref-for-dfn-queue-a-message-event-4">Queue a "message" Event</a> algorithm on the <var>session</var>, providing
                                  <var>message type</var> and <var>message</var>.
                                </p>
                              </li>
                            </ol>
                          </dd>
                        </dl>
                      </li>
                      <li>
                        <p>
                          Resolve <var>promise</var>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-83"><div role="heading" class="note-title marker" id="h-note-83" aria-level="4"><span>Note</span></div><p class="">
                          Since promise handlers are queued as microtasks, these will be executed
                          ahead of any events queued by the preceding steps.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeysession-close" data-idl="operation" data-title="close()" data-dfn-for="MediaKeySession" data-type="Promise" data-lt="close()" data-local-lt="MediaKeySession.close|MediaKeySession.close()|close" tabindex="0" aria-haspopup="dialog"><code>close()</code></dfn>
          </dt>
          <dd>
            <p>
              Indicates that the application no longer needs the session and the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-60">CDM</a> should
              release any resources associated with the session and close it. Persisted data should
              not be released or cleared.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-84"><div role="heading" class="note-title marker" id="h-note-84" aria-level="4"><span>Note</span></div><p class="">
              The returned promise is resolved when the request has been processed, and the
              <a data-link-type="idl" href="#dom-mediakeysession-closed" class="internalDFN" id="ref-for-dom-mediakeysession-closed-4"><code>closed</code></a> attribute promise is resolved with
              "<a data-link-type="idl" href="#dom-mediakeysessionclosedreason-closed-by-application" class="internalDFN" id="ref-for-dom-mediakeysessionclosedreason-closed-by-application-2"><code>closed-by-application</code></a>" when the session is closed.
            </p></div>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  If this object's <var>closing or closed</var> value is true, return a resolved
                  promise.
                </p>
              </li>
              <li>
                <p>
                  If this object's <var>callable</var> value is false, return a promise rejected
                  with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-8"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Set this object's <var>closing or closed</var> value to true.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>cdm</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-61">CDM</a> instance represented by this object's
                      <var>cdm instance</var> value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Use <var>cdm</var> to close the <a data-link-type="dfn|abstract-op" href="#dfn-key-session" class="internalDFN" id="ref-for-dfn-key-session-6">key session</a> associated with this object.
                    </p>
                    <div class="note" role="note" id="issue-container-generatedID-85"><div role="heading" class="note-title marker" id="h-note-85" aria-level="4"><span>Note</span></div><p class="">
                      Closing the key session results in the destruction of any license(s) and
                      key(s) that have not been explicitly stored.
                    </p></div>
                  </li>
                  <li>
                    <p>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          Run the <a data-link-type="dfn|abstract-op" href="#dfn-session-closed" class="internalDFN" id="ref-for-dfn-session-closed-4">Session Closed</a> algorithm on this object with reason
                          "<a data-link-type="idl" href="#dom-mediakeysessionclosedreason-closed-by-application" class="internalDFN" id="ref-for-dom-mediakeysessionclosedreason-closed-by-application-3"><code>closed-by-application</code></a>".
                        </p>
                      </li>
                      <li>
                        <p>
                          Resolve <var>promise</var>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-86"><div role="heading" class="note-title marker" id="h-note-86" aria-level="4"><span>Note</span></div><p class="">
                          Since promise handlers are queued as microtasks, these will be executed
                          ahead of any events queued by the preceding steps.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-mediakeysession-remove" data-idl="operation" data-title="remove()" data-dfn-for="MediaKeySession" data-type="Promise" data-lt="remove()" data-local-lt="MediaKeySession.remove|MediaKeySession.remove()|remove" tabindex="0" aria-haspopup="dialog"><code>remove()</code></dfn>
          </dt>
          <dd>
            <p>
              Removes all license(s) and key(s) associated with the session. For <a href="#is-persistent-session-type">persistent session types</a>, other session data will
              be cleared as defined for each session type once a release message acknowledgment is
              processed by <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-9"><code>update</code></a><code>()</code>.
            </p>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              <li>
                <p>
                  If this object's <var>closing or closed</var> value is true, return a promise
                  rejected with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-9"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If this object's <var>callable</var> value is false, return a promise rejected
                  with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-10"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      Let <var>cdm</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-62">CDM</a> instance represented by this object's
                      <var>cdm instance</var> value.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let <var>message type</var> be null.
                    </p>
                  </li>
                  <li>
                    <p>
                      Use the <var>cdm</var> to execute the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If any license(s) and/or key(s) are associated with the session:
                        </p>
                        <ol>
                          <li>
                            <p>
                              Destroy the license(s) and/or key(s) associated with the session.
                            </p>
                            <div class="note" role="note" id="issue-container-generatedID-87"><div role="heading" class="note-title marker" id="h-note-87" aria-level="4"><span>Note</span></div><p class="">
                              This implies destruction of the license(s) and/or keys(s) whether
                              they are in memory, persistent store or both.
                            </p></div>
                          </li>
                          <li>
                            <p>
                              Follow the steps for the value of this object's <var>session
                              type</var> from the following list:
                            </p>
                            <dl class="switch">
                              <dt>
                                "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-10"><code>temporary</code></a>"
                              </dt>
                              <dd>
                                <p>
                                  Continue with the following steps.
                                </p>
                              </dd>
                              <dt>
                                "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-6"><code>persistent-license</code></a>"
                              </dt>
                              <dd>
                                <ol>
                                  <li>
                                    <p>
                                      Let <var>record of license destruction</var> be a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-7">record of license destruction</a> for the license represented by this
                                      object.
                                    </p>
                                  </li>
                                  <li>
                                    <p>
                                      Store the <var>record of license destruction</var>.
                                    </p>
                                  </li>
                                  <li>
                                    <p>
                                      Let <var>message</var> be a message containing or reflecting
                                      the <var>record of license destruction</var>.
                                    </p>
                                  </li>
                                </ol>
                              </dd>
                            </dl>
                          </li>
                        </ol>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          Run the <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-5">Update Key Statuses</a> algorithm on the <var>session</var>,
                          providing all <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-8">key ID</a>(s) in the session along with the
                          "<a data-link-type="idl" href="#dom-mediakeystatus-released" class="internalDFN" id="ref-for-dom-mediakeystatus-released-1"><code>released</code></a>" <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-7"><code>MediaKeyStatus</code></a> value for each.
                        </p>
                      </li>
                      <li>
                        <p>
                          Run the <a data-link-type="dfn|abstract-op" href="#dfn-update-expiration" class="internalDFN" id="ref-for-dfn-update-expiration-3">Update Expiration</a> algorithm on the <var>session</var>,
                          providing <code>NaN</code>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If any of the preceding steps failed, reject <var>promise</var> with a
                          new <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> whose name is the appropriate <a href="#error-names">error name</a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Let <var>message type</var> be "<a data-link-type="idl" href="#dom-mediakeymessagetype-license-release" class="internalDFN" id="ref-for-dom-mediakeymessagetype-license-release-2"><code>license-release</code></a>".
                        </p>
                      </li>
                      <li>
                        <p>
                          If <var>message</var> is not <code>null</code>, run the <a data-link-type="dfn|abstract-op" href="#dfn-queue-a-message-event" class="internalDFN" id="ref-for-dfn-queue-a-message-event-5">Queue a "message" Event</a> algorithm on the <var>session</var>, providing
                          <var>message type</var> and <var>message</var>.
                        </p>
                      </li>
                      <li>
                        <p>
                          Resolve <var>promise</var>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-88"><div role="heading" class="note-title marker" id="h-note-88" aria-level="4"><span>Note</span></div><p class="">
                          Since promise handlers are queued as microtasks, these will be executed
                          ahead of any events queued by the preceding steps.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
        </dl>
      </section>
      <section id="mediakeystatusmap-interface"><div class="header-wrapper"><h3 id="x6-3-mediakeystatusmap-interface"><bdi class="secno">6.3 </bdi>
          <dfn data-export="" data-dfn-type="interface" id="dom-mediakeystatusmap" data-idl="interface" data-title="MediaKeyStatusMap" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeyStatusMap</code></dfn> Interface
        </h3><a class="self-link" href="#mediakeystatusmap-interface" aria-label="Permalink for Section 6.3"></a></div>
        
        <p>
          The <a data-link-type="idl" data-lt="MediaKeyStatusMap" href="#dom-mediakeystatusmap" class="internalDFN" id="ref-for-dom-mediakeystatusmap-4"><code>MediaKeyStatusMap</code></a> object is a read-only map of <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-9">key IDs</a> to the current status
          of the associated key.
        </p>
        <p>
          A key's status is independent of whether the key is currently being used and of media
          data.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-89"><div role="heading" class="note-title marker" id="h-note-89" aria-level="4"><span>Note</span></div><p class="">
          For example, if a key has output requirements that cannot currently be met, the key's
          status should be "<a data-link-type="idl" href="#dom-mediakeystatus-output-downscaled" class="internalDFN" id="ref-for-dom-mediakeystatus-output-downscaled-1"><code>output-downscaled</code></a>" or
          "<a data-link-type="idl" href="#dom-mediakeystatus-output-restricted" class="internalDFN" id="ref-for-dom-mediakeystatus-output-restricted-2"><code>output-restricted</code></a>", as appropriate, regardless of whether that key
          has been or is currently needed to decrypt media data.
        </p></div>
        <pre class="idl def" id="webidl-366396555"><span class="idlHeader"><a class="self-link" href="#webidl-366396555">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-mediakeystatusmap" data-title="MediaKeyStatusMap">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>] interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-mediakeystatusmap" id="ref-for-dom-mediakeystatusmap-5"><code>MediaKeyStatusMap</code></a> {<span data-idl="" class="idlIterable" id="idl-def-mediakeystatusmap-iterable" data-title="iterable" data-dfn-for="MediaKeyStatusMap">
  <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-iterable">iterable</a>&lt;<a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a>,<a data-link-type="idl" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-8"><code>MediaKeyStatus</code></a>&gt;;</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeystatusmap-size" data-title="size" data-dfn-for="MediaKeyStatusMap">
  readonly attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeystatusmap-size" id="ref-for-dom-mediakeystatusmap-size-2"><code>size</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-mediakeystatusmap-has-keyid" data-title="has" data-dfn-for="MediaKeyStatusMap"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeystatusmap-has" id="ref-for-dom-mediakeystatusmap-has-1"><code>has</code></a> (<span class="idlType"><a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <span class="idlParamName">keyId</span>);</span><span data-idl="" class="idlMethod" id="idl-def-mediakeystatusmap-get-keyid" data-title="get" data-dfn-for="MediaKeyStatusMap"><span class="idlType">
  (<a data-link-type="idl" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-9"><code>MediaKeyStatus</code></a> or <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>)</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-mediakeystatusmap-get" id="ref-for-dom-mediakeystatusmap-get-1"><code>get</code></a> (<span class="idlType"><a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <span class="idlParamName">keyId</span>);</span>
};</span></code></pre>
        <section id="attributes-1"><div class="header-wrapper"><h4 id="x6-3-1-attributes"><bdi class="secno">6.3.1 </bdi>
            Attributes
          </h4><a class="self-link" href="#attributes-1" aria-label="Permalink for Section 6.3.1"></a></div>
          
          <dl class="attributes" data-dfn-for="MediaKeyStatusMap">
            <dt>
              <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeystatusmap-size" data-idl="attribute" data-title="size" data-dfn-for="MediaKeyStatusMap" data-type="unsigned long" data-lt="size" data-local-lt="MediaKeyStatusMap.size" tabindex="0" aria-haspopup="dialog"><code>size</code></dfn> of type <a data-link-type="idl" data-lt="unsigned long" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><code>unsigned long</code></a>, readonly
            </dt>
            <dd>
              <p>
                The number of <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-4">known keys</a>.
              </p>
            </dd>
          </dl>
        </section>
        <section id="methods-3"><div class="header-wrapper"><h4 id="x6-3-2-methods"><bdi class="secno">6.3.2 </bdi>
            Methods
          </h4><a class="self-link" href="#methods-3" aria-label="Permalink for Section 6.3.2"></a></div>
          
          <dl class="methods" data-dfn-for="MediaKeyStatusMap">
            <dt>
              <dfn data-export="" data-dfn-type="method" id="dom-mediakeystatusmap-has" data-idl="operation" data-title="has()" data-dfn-for="MediaKeyStatusMap" data-type="boolean" data-lt="has()|has(keyId)" data-local-lt="MediaKeyStatusMap.has|MediaKeyStatusMap.has()|has" tabindex="0" aria-haspopup="dialog"><code>has()</code></dfn>
            </dt>
            <dd>
              <p>
                Returns <code>true</code> if the status of the key identified by <var>keyId</var>
                is known.
              </p>
            </dd>
            <dt>
              <dfn data-export="" data-dfn-type="method" id="dom-mediakeystatusmap-get" data-idl="operation" data-title="get()" data-dfn-for="MediaKeyStatusMap" data-type="MediaKeyStatus|undefined" data-lt="get()|get(keyId)" data-local-lt="MediaKeyStatusMap.get|MediaKeyStatusMap.get()|get" tabindex="0" aria-haspopup="dialog"><code>get()</code></dfn>
            </dt>
            <dd>
              <p>
                Returns the <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-10"><code>MediaKeyStatus</code></a> of the key identified by <var>keyId</var> or
                <code>undefined</code> if the status of the key identified by <var>keyId</var> is
                not known.
              </p>
            </dd>
          </dl>
          <p>
            This interface has <code>entries</code>, <code>keys</code>, <code>values</code>,
            <code>forEach</code> and <code>@@iterator</code> methods brought by <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-iterable">iterable</a>
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
          </p>
          <p>
            The value pairs to iterate over are a snapshot of the set of pairs formed from the
            <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-10">key ID</a> and associated <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-11"><code>MediaKeyStatus</code></a> value for all <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-5">known keys</a>, sorted by
            <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-11">key ID</a>. Key IDs are compared as follows: For key IDs <var>A</var> of length
            <var>m</var> and <var>B</var> of length <var>n</var>, assigned such that <var>m</var>
            &lt;= <var>n</var>, let <var>A</var> &lt; <var>B</var> if and only if the <var>m</var>
            octets of <var>A</var> are less in lexicographical order than the first <var>m</var>
            octets of <var>B</var> or those octets are equal and <var>m</var> &lt; <var>n</var>.
          </p>
        </section>
        <pre class="idl def" id="webidl-418631828"><span class="idlHeader"><a class="self-link" href="#webidl-418631828">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-mediakeystatus" data-title="MediaKeyStatus">enum <a class="internalDFN idlID" data-link-type="enum" href="#dom-mediakeystatus" id="ref-for-dom-mediakeystatus-12"><code>MediaKeyStatus</code></a> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-usable" id="ref-for-dom-mediakeystatus-usable-2"><code>usable</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-expired" id="ref-for-dom-mediakeystatus-expired-2"><code>expired</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-released" id="ref-for-dom-mediakeystatus-released-2"><code>released</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-output-restricted" id="ref-for-dom-mediakeystatus-output-restricted-3"><code>output-restricted</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-output-downscaled" id="ref-for-dom-mediakeystatus-output-downscaled-2"><code>output-downscaled</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-usable-in-future" id="ref-for-dom-mediakeystatus-usable-in-future-1"><code>usable-in-future</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-status-pending" id="ref-for-dom-mediakeystatus-status-pending-3"><code>status-pending</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeystatus-internal-error" id="ref-for-dom-mediakeystatus-internal-error-2"><code>internal-error</code></a>"</span>
};</span></code></pre>
        <p>
          The <dfn data-export="" data-dfn-type="enum" id="dom-mediakeystatus" data-idl="enum" data-title="MediaKeyStatus" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeyStatus</code></dfn> enumeration is defined as follows:
        </p>
        <table class="simple" data-dfn-for="MediaKeyStatus">
          <tbody>
            <tr>
              <th colspan="2">
                Enumeration description
              </th>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-usable" data-idl="enum-value" data-title="usable" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>usable</code></dfn>
              </td>
              <td>
                The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-63">CDM</a> is certain the key is currently <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-3">usable for decryption</a>.<br>
                Keys that <em>may not</em> currently be <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-4">usable for decryption</a> <em class="rfc2119">MUST NOT</em> have
                this status.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-expired" data-idl="enum-value" data-title="expired" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>expired</code></dfn>
              </td>
              <td>
                The key is no longer <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-5">usable for decryption</a> because its <a data-link-type="dfn|abstract-op" href="#dfn-expiration" class="internalDFN" id="ref-for-dfn-expiration-5">expiration time</a> has
                passed.<br>
                The time represented by the <a data-link-type="idl" href="#dom-mediakeysession-expiration" class="internalDFN" id="ref-for-dom-mediakeysession-expiration-3"><code>expiration</code></a> attribute <em class="rfc2119">MUST</em> be
                earlier than the current time. All other keys in the session <em class="rfc2119">MUST</em> have this status.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-released" data-idl="enum-value" data-title="released" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>released</code></dfn>
              </td>
              <td>
                The key itself is no longer available to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-64">CDM</a>, but information about the
                key, such as a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-8">record of license destruction</a>, is available.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-output-restricted" data-idl="enum-value" data-title="output-restricted" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>output-restricted</code></dfn>
              </td>
              <td>
                There are output restrictions associated with the key that cannot currently be met.
                Media data decrypted with this key may be blocked from presentation, if necessary
                according to the output restrictions. The application should avoid using streams
                that will trigger the output restrictions associated with the key.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-output-downscaled" data-idl="enum-value" data-title="output-downscaled" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>output-downscaled</code></dfn>
              </td>
              <td>
                There are output restrictions associated with the key that cannot currently be met.
                Media data decrypted with this key may be presented at a lower quality (e.g.,
                resolution), if necessary according to the output restrictions. The application
                should avoid using streams that will trigger the output restrictions associated
                with the key.<br>
                Support for downscaling is <em class="rfc2119">OPTIONAL</em>. Applications <em class="rfc2119">SHOULD NOT</em> rely on downscaling to
                ensure uninterrupted playback when output requirements cannot be met.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-usable-in-future" data-idl="enum-value" data-title="usable-in-future" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>usable-in-future</code></dfn>
              </td>
              <td>
                The key is not yet <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-6">usable for decryption</a> because the start time is in the
                future. The key will become usable when its start time is reached.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-status-pending" data-idl="enum-value" data-title="status-pending" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>status-pending</code></dfn>
              </td>
              <td>
                The status of the key is not yet known and is being determined. The status will be
                updated with the actual status when it has been determined.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeystatus-internal-error" data-idl="enum-value" data-title="internal-error" data-dfn-for="MediaKeyStatus" tabindex="0" aria-haspopup="dialog"><code>internal-error</code></dfn>
              </td>
              <td>
                The key is not currently <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-7">usable for decryption</a> because of an error in the
                <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-65">CDM</a> unrelated to the other values. This value is not actionable by the
                application.
              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section id="mediakeymessageevent"><div class="header-wrapper"><h3 id="x6-4-mediakeymessageevent"><bdi class="secno">6.4 </bdi>
          <a data-link-type="idl" data-lt="MediaKeyMessageEvent" href="#dom-mediakeymessageevent" class="internalDFN" id="ref-for-dom-mediakeymessageevent-1"><code>MediaKeyMessageEvent</code></a>
        </h3><a class="self-link" href="#mediakeymessageevent" aria-label="Permalink for Section 6.4"></a></div>
        
        <p>
          The MediaKeyMessageEvent object is used for the <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-5"><code><code>message</code></code></a> event.
        </p>
        <pre class="idl def" id="webidl-1754914033"><span class="idlHeader"><a class="self-link" href="#webidl-1754914033">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-mediakeymessagetype" data-title="MediaKeyMessageType">enum <a class="internalDFN idlID" data-link-type="enum" href="#dom-mediakeymessagetype" id="ref-for-dom-mediakeymessagetype-3"><code>MediaKeyMessageType</code></a> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeymessagetype-license-request" id="ref-for-dom-mediakeymessagetype-license-request-4"><code>license-request</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeymessagetype-license-renewal" id="ref-for-dom-mediakeymessagetype-license-renewal-1"><code>license-renewal</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeymessagetype-license-release" id="ref-for-dom-mediakeymessagetype-license-release-3"><code>license-release</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-mediakeymessagetype-individualization-request" id="ref-for-dom-mediakeymessagetype-individualization-request-3"><code>individualization-request</code></a>"</span>
};</span></code></pre>
        <p>
          The <dfn data-export="" data-dfn-type="enum" id="dom-mediakeymessagetype" data-idl="enum" data-title="MediaKeyMessageType" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeyMessageType</code></dfn> is defined as follows:
        </p>
        <table class="simple" data-dfn-for="MediaKeyMessageType">
          <tbody>
            <tr>
              <th colspan="2">
                Enumeration description
              </th>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeymessagetype-license-request" data-idl="enum-value" data-title="license-request" data-dfn-for="MediaKeyMessageType" tabindex="0" aria-haspopup="dialog"><code>license-request</code></dfn>
              </td>
              <td>
                The message contains a request for a new license.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeymessagetype-license-renewal" data-idl="enum-value" data-title="license-renewal" data-dfn-for="MediaKeyMessageType" tabindex="0" aria-haspopup="dialog"><code>license-renewal</code></dfn>
              </td>
              <td>
                The message contains a request to renew an existing license.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeymessagetype-license-release" data-idl="enum-value" data-title="license-release" data-dfn-for="MediaKeyMessageType" tabindex="0" aria-haspopup="dialog"><code>license-release</code></dfn>
              </td>
              <td>
                The message contains a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-9">record of license destruction</a>.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-export="" data-dfn-type="enum-value" id="dom-mediakeymessagetype-individualization-request" data-idl="enum-value" data-title="individualization-request" data-dfn-for="MediaKeyMessageType" tabindex="0" aria-haspopup="dialog"><code>individualization-request</code></dfn>
              </td>
              <td>
                The message contains a request for <a data-link-type="dfn|abstract-op" href="#dfn-app-assisted-individualization" class="internalDFN" id="ref-for-dfn-app-assisted-individualization-1">App-Assisted Individualization</a> (or
                re-individualization).<br>
                As with all other messages, any identifiers in the message <em class="rfc2119">MUST</em> be <a href="#per-origin-per-profile-identifiers">distinctive per origin and profile</a> and
                <em class="rfc2119">MUST NOT</em> be <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-18">Distinctive Permanent Identifiers</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="idl def" id="webidl-1595553803"><span class="idlHeader"><a class="self-link" href="#webidl-1595553803">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-mediakeymessageevent" data-title="MediaKeyMessageEvent">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>, <span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-mediakeymessageevent" data-idl="interface" data-title="MediaKeyMessageEvent" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>MediaKeyMessageEvent</code></dfn> : <span class="idlSuperclass"><a data-link-type="idl" data-type="interface" href="https://dom.spec.whatwg.org/#event">Event</a></span> {<span data-idl="" class="idlConstructor" id="idl-def-mediakeymessageevent-constructor-type-eventinitdict" data-title="constructor" data-dfn-for="MediaKeyMessageEvent">
  <dfn data-export="" data-dfn-type="constructor" id="dom-mediakeymessageevent-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="MediaKeyMessageEvent" data-lt="constructor()|constructor(type, eventInitDict)" data-local-lt="MediaKeyMessageEvent.constructor|MediaKeyMessageEvent.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">type</span>,<span class="idlType"> <a data-link-type="idl" href="#dom-mediakeymessageeventinit" class="internalDFN" id="ref-for-dom-mediakeymessageeventinit-1"><code>MediaKeyMessageEventInit</code></a></span> <span class="idlParamName">eventInitDict</span>);</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeymessageevent-messagetype" data-title="messageType" data-dfn-for="MediaKeyMessageEvent">
  readonly attribute<span class="idlType"> <a data-link-type="idl" href="#dom-mediakeymessagetype" class="internalDFN" id="ref-for-dom-mediakeymessagetype-4"><code>MediaKeyMessageType</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeymessageevent-messagetype" id="ref-for-dom-mediakeymessageevent-messagetype-1"><code>messageType</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mediakeymessageevent-message" data-title="message" data-dfn-for="MediaKeyMessageEvent">
  readonly attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a></span>         <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediakeymessageevent-message" id="ref-for-dom-mediakeymessageevent-message-1"><code>message</code></a>;</span>
};</span></code></pre>
        <section id="attributes-2"><div class="header-wrapper"><h4 id="x6-4-1-attributes"><bdi class="secno">6.4.1 </bdi>
            Attributes
          </h4><a class="self-link" href="#attributes-2" aria-label="Permalink for Section 6.4.1"></a></div>
          
          <dl class="attributes" data-dfn-for="MediaKeyMessageEvent">
            <dt>
              <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeymessageevent-messagetype" data-idl="attribute" data-title="messageType" data-dfn-for="MediaKeyMessageEvent" data-type="MediaKeyMessageType" data-lt="messageType" data-local-lt="MediaKeyMessageEvent.messageType" tabindex="0" aria-haspopup="dialog"><code>messageType</code></dfn> of type <a data-link-type="idl" data-lt="MediaKeyMessageType" href="#dom-mediakeymessagetype" class="internalDFN" id="ref-for-dom-mediakeymessagetype-5"><code>MediaKeyMessageType</code></a>, readonly
            </dt>
            <dd>
              The type of the message.
              <p>
                Implementations <em class="rfc2119">MUST NOT</em> require applications to handle message types.
                Implementations <em class="rfc2119">MUST</em> support applications that do not differentiate messages and
                <em class="rfc2119">MUST NOT</em> require that applications handle message types. Specifically, <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-26">Key Systems</a> <em class="rfc2119">MUST</em> support passing all types of messages to a single URL.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-90"><div role="heading" class="note-title marker" id="h-note-90" aria-level="5"><span>Note</span></div><p class="">
                This attribute allows an application to differentiate messages without parsing the
                message. It is intended to enable optional application and/or server optimizations,
                but applications are not required to use it.
              </p></div>
            </dd>
            <dt>
              <dfn data-export="" data-dfn-type="attribute" id="dom-mediakeymessageevent-message" data-idl="attribute" data-title="message" data-dfn-for="MediaKeyMessageEvent" data-type="ArrayBuffer" data-lt="message" data-local-lt="MediaKeyMessageEvent.message" tabindex="0" aria-haspopup="dialog"><code>message</code></dfn> of type <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a>, readonly
            </dt>
            <dd>
              The message from the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-66">CDM</a>. Messages are <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-27">Key System</a>-specific.
            </dd>
          </dl>
        </section>
        <section id="mediakeymessageeventinit"><div class="header-wrapper"><h4 id="x6-4-2-mediakeymessageeventinit"><bdi class="secno">6.4.2 </bdi>
            <dfn data-export="" data-dfn-type="dictionary" id="dom-mediakeymessageeventinit" data-idl="dictionary" data-title="MediaKeyMessageEventInit" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaKeyMessageEventInit</code></dfn>
          </h4><a class="self-link" href="#mediakeymessageeventinit" aria-label="Permalink for Section 6.4.2"></a></div>
          
          <pre class="idl def" id="webidl-726369050"><span class="idlHeader"><a class="self-link" href="#webidl-726369050">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-mediakeymessageeventinit" data-title="MediaKeyMessageEventInit">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-mediakeymessageeventinit" id="ref-for-dom-mediakeymessageeventinit-2"><code>MediaKeyMessageEventInit</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a></span> {<span data-idl="" class="idlMember" id="idl-def-mediakeymessageeventinit-messagetype" data-title="messageType" data-dfn-for="MediaKeyMessageEventInit">
  required<span class="idlType"> <a data-link-type="idl" href="#dom-mediakeymessagetype" class="internalDFN" id="ref-for-dom-mediakeymessagetype-6"><code>MediaKeyMessageType</code></a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeymessageeventinit-messagetype" id="ref-for-dom-mediakeymessageeventinit-messagetype-1"><code>messageType</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-mediakeymessageeventinit-message" data-title="message" data-dfn-for="MediaKeyMessageEventInit">
  required<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a></span>         <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediakeymessageeventinit-message" id="ref-for-dom-mediakeymessageeventinit-message-1"><code>message</code></a>;</span>
};</span></code></pre>
          <section id="dictionary-mediakeymessageeventinit-members"><div class="header-wrapper"><h5 id="x6-4-2-1-dictionary-mediakeymessageeventinit-members"><bdi class="secno">6.4.2.1 </bdi>
              Dictionary <a class="idlType internalDFN" href="#dom-mediakeymessageeventinit" data-link-type="idl" id="ref-for-dom-mediakeymessageeventinit-3"><code>MediaKeyMessageEventInit</code></a> Members
            </h5><a class="self-link" href="#dictionary-mediakeymessageeventinit-members" aria-label="Permalink for Section 6.4.2.1"></a></div>
            
            <dl class="dictionary-members" data-dfn-for="MediaKeyMessageEventInit">
              <dt>
                <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeymessageeventinit-messagetype" data-idl="field" data-title="messageType" data-dfn-for="MediaKeyMessageEventInit" data-type="MediaKeyMessageType" tabindex="0" aria-haspopup="dialog">messageType</dfn></code> of type <a data-link-type="idl" data-lt="MediaKeyMessageType" href="#dom-mediakeymessagetype" class="internalDFN" id="ref-for-dom-mediakeymessagetype-7"><code>MediaKeyMessageType</code></a>
              </dt>
              <dd>
                The type of the message.
              </dd>
              <dt>
                <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediakeymessageeventinit-message" data-idl="field" data-title="message" data-dfn-for="MediaKeyMessageEventInit" data-type="ArrayBuffer" tabindex="0" aria-haspopup="dialog">message</dfn></code> of type <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a>
              </dt>
              <dd>
                The message.
              </dd>
            </dl>
          </section>
        </section>
      </section>
      <section id="mediakeysession-events" class="informative"><div class="header-wrapper"><h3 id="x6-5-event-summary"><bdi class="secno">6.5 </bdi>
          Event Summary
        </h3><a class="self-link" href="#mediakeysession-events" aria-label="Permalink for Section 6.5"></a></div><p><em>This section is non-normative.</em></p>
        
        <table class="old-table">
          <thead>
            <tr>
              <th>
                Event name
              </th>
              <th>
                Interface
              </th>
              <th>
                Dispatched when...
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <code><dfn id="dfn-keystatuseschange" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">keystatuseschange</dfn></code>
              </td>
              <td>
                <a data-link-type="idl" data-lt="Event" data-type="interface" href="https://dom.spec.whatwg.org/#event"><code>Event</code></a>
              </td>
              <td>
                There has been a change in the keys in the session or their status.
              </td>
            </tr>
            <tr>
              <td>
                <code><dfn id="dfn-message" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">message</dfn></code>
              </td>
              <td>
                <a data-link-type="idl" data-lt="MediaKeyMessageEvent" href="#dom-mediakeymessageevent" class="internalDFN" id="ref-for-dom-mediakeymessageevent-2"><code>MediaKeyMessageEvent</code></a>
              </td>
              <td>
                The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-67">CDM</a> has generated a message for the session.
              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section id="mediakeysession-algorithms"><div class="header-wrapper"><h3 id="x6-6-algorithms"><bdi class="secno">6.6 </bdi>
          Algorithms
        </h3><a class="self-link" href="#mediakeysession-algorithms" aria-label="Permalink for Section 6.6"></a></div>
        
        <section id="queue-message"><div class="header-wrapper"><h4 id="x6-6-1-queue-a-message-event"><bdi class="secno">6.6.1 </bdi>
            <dfn id="dfn-queue-a-message-event" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Queue a "message" Event</dfn>
          </h4><a class="self-link" href="#queue-message" aria-label="Permalink for Section 6.6.1"></a></div>
          
          <p>
            The Queue a "message" Event algorithm queues a message event to a <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-24"><code>MediaKeySession</code></a>
            object. Requests to run this algorithm include a target <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-25"><code>MediaKeySession</code></a> object, a
            <var>message type</var>, and a <var>message</var>.
          </p>
          <p>
            <var>message</var> <em class="rfc2119">MUST NOT</em> contain <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-19">Distinctive Permanent Identifier(s)</a>, even in an
            encrypted form. <var>message</var> <em class="rfc2119">MUST NOT</em> contain <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-13">Distinctive Identifier(s)</a>, even
            in an encrypted form, if the <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-26"><code>MediaKeySession</code></a> object's <var>use distinctive
            identifier</var> value is false.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>session</var> be the specified <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-27"><code>MediaKeySession</code></a> object.
              </p>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to create an event named <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-6"><code><code>message</code></code></a> that does not bubble and is
                not cancellable using the <a data-link-type="idl" data-lt="MediaKeyMessageEvent" href="#dom-mediakeymessageevent" class="internalDFN" id="ref-for-dom-mediakeymessageevent-3"><code>MediaKeyMessageEvent</code></a> interface with its
                <var>type</var> attribute set to <code>message</code> and its <var>isTrusted</var>
                attribute initialized to <code>true</code>, and dispatch it at the
                <var>session</var>.
              </p>
              <p>
                The event interface <a data-link-type="idl" data-lt="MediaKeyMessageEvent" href="#dom-mediakeymessageevent" class="internalDFN" id="ref-for-dom-mediakeymessageevent-4"><code>MediaKeyMessageEvent</code></a> has:
              </p>
              <ul style="list-style-type:none">
                <li><a data-link-type="idl" href="#dom-mediakeymessageevent-messagetype" class="internalDFN" id="ref-for-dom-mediakeymessageevent-messagetype-2"><code>messageType</code></a> = the specified <var>message
                type</var><br>
                  <br>
                  <a data-link-type="idl" href="#dom-mediakeymessageevent-message" class="internalDFN" id="ref-for-dom-mediakeymessageevent-message-2"><code>message</code></a> = the specified <var>message</var>
                </li>
              </ul>
            </li>
          </ol>
        </section>
        <section id="update-key-statuses"><div class="header-wrapper"><h4 id="x6-6-2-update-key-statuses"><bdi class="secno">6.6.2 </bdi>
            <dfn id="dfn-update-key-statuses" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Update Key Statuses</dfn>
          </h4><a class="self-link" href="#update-key-statuses" aria-label="Permalink for Section 6.6.2"></a></div>
          
          <p>
            The Update Key Statuses algorithm updates the set of <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-6">known</a> keys for a
            <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-28"><code>MediaKeySession</code></a> or the status of one or more of the keys. Requests to run this
            algorithm include a target <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-29"><code>MediaKeySession</code></a> object and a sequence of <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-12">key ID</a> and
            associated <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-13"><code>MediaKeyStatus</code></a> pairs.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-91"><div role="heading" class="note-title marker" id="h-note-91" aria-level="5"><span>Note</span></div><p class="">
            The algorithm is always run in a task.
          </p></div>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>session</var> be the associated <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-30"><code>MediaKeySession</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Let the <var>input statuses</var> be the sequence of pairs key ID and associated
                <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-14"><code>MediaKeyStatus</code></a> pairs.
              </p>
            </li>
            <li>
              <p>
                Let the <var>statuses</var> be <var>session</var>'s <a data-link-type="idl" href="#dom-mediakeysession-keystatuses" class="internalDFN" id="ref-for-dom-mediakeysession-keystatuses-3"><code>keyStatuses</code></a>
                attribute.
              </p>
            </li>
            <li>
              <p>
                Run the following steps to replace the contents of <var>statuses</var>:
              </p>
              <ol>
                <li>
                  <p>
                    Empty <var>statuses</var>.
                  </p>
                </li>
                <li>
                  <p>
                    For each pair in <var>input statuses</var>.
                  </p>
                  <ol>
                    <li>
                      <p>
                        Let <var>pair</var> be the pair.
                      </p>
                    </li>
                    <li>
                      <p>
                        Insert an entry for <var>pair</var>'s key ID into <var>statuses</var> with
                        the value of <var>pair</var>'s <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-15"><code>MediaKeyStatus</code></a> value.
                      </p>
                    </li>
                  </ol>
                </li>
              </ol>
              <div class="note" role="note" id="issue-container-generatedID-92"><div role="heading" class="note-title marker" id="h-note-92" aria-level="5"><span>Note</span></div><p class="">
                The effect of this steps is that the contents of <var>session</var>'s
                <a data-link-type="idl" href="#dom-mediakeysession-keystatuses" class="internalDFN" id="ref-for-dom-mediakeysession-keystatuses-4"><code>keyStatuses</code></a> attribute are replaced without invalidating
                existing references to the attribute. This replacement is atomic from a script
                perspective. That is, script <em class="rfc2119">MUST NOT</em> ever see a partially populated sequence.
              </p></div>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <a data-link-type="idl" data-lt="keystatuseschange" href="#dfn-keystatuseschange" class="internalDFN" id="ref-for-dfn-keystatuseschange-2"><code><code>keystatuseschange</code></code></a> at the
                <var>session</var>.
              </p>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to run the <a data-link-type="dfn|abstract-op" href="#dfn-attempt-to-resume-playback-if-necessary" class="internalDFN" id="ref-for-dfn-attempt-to-resume-playback-if-necessary-1">Attempt to Resume Playback If Necessary</a> algorithm
                on each of the media element(s) whose <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-1"><code>mediaKeys</code></a> attribute is
                the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-23"><code>MediaKeys</code></a> object that created the <var>session</var>.
              </p>
            </li>
          </ol>
        </section>
        <section id="update-expiration"><div class="header-wrapper"><h4 id="x6-6-3-update-expiration"><bdi class="secno">6.6.3 </bdi>
            <dfn id="dfn-update-expiration" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Update Expiration</dfn>
          </h4><a class="self-link" href="#update-expiration" aria-label="Permalink for Section 6.6.3"></a></div>
          
          <p>
            The Update Expiration algorithm updates the <a data-link-type="dfn|abstract-op" href="#dfn-expiration" class="internalDFN" id="ref-for-dfn-expiration-6">expiration time</a> of a
            <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-31"><code>MediaKeySession</code></a>. Requests to run this algorithm include a target
            <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-32"><code>MediaKeySession</code></a> object and the new expiration time, which may be <code>NaN</code>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-93"><div role="heading" class="note-title marker" id="h-note-93" aria-level="5"><span>Note</span></div><p class="">
            The algorithm is always run in a task.
          </p></div>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>session</var> be the associated <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-33"><code>MediaKeySession</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Let <var>expiration time</var> be <code>NaN</code>.
              </p>
            </li>
            <li>
              <p>
                If the new expiration time is not <code>NaN</code>, let <var>expiration time</var>
                be that expiration time.
              </p>
            </li>
            <li>
              <p>
                Set the <var>session</var>'s <a data-link-type="idl" href="#dom-mediakeysession-expiration" class="internalDFN" id="ref-for-dom-mediakeysession-expiration-4"><code>expiration</code></a> attribute to
                <var>expiration time</var> expressed as <a data-link-type="dfn|abstract-op" href="#dfn-time" class="internalDFN" id="ref-for-dfn-time-2">time</a>.
              </p>
            </li>
          </ol>
        </section>
        <section id="session-closed"><div class="header-wrapper"><h4 id="x6-6-4-session-closed"><bdi class="secno">6.6.4 </bdi>
            <dfn id="dfn-session-closed" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Session Closed</dfn>
          </h4><a class="self-link" href="#session-closed" aria-label="Permalink for Section 6.6.4"></a></div>
          
          <p>
            The Session Closed algorithm updates the <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-34"><code>MediaKeySession</code></a> state after a <a data-link-type="dfn|abstract-op" href="#dfn-key-session" class="internalDFN" id="ref-for-dfn-key-session-7">key session</a> has been closed by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-68">CDM</a>. Requests to run this algorithm include a
            target <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-35"><code>MediaKeySession</code></a> object and a <a data-link-type="idl" data-lt="MediaKeySessionClosedReason" href="#dom-mediakeysessionclosedreason" class="internalDFN" id="ref-for-dom-mediakeysessionclosedreason-4"><code>MediaKeySessionClosedReason</code></a>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-94"><div role="heading" class="note-title marker" id="h-note-94" aria-level="5"><span>Note</span></div><p class="">
            The algorithm is always run in a task.
          </p></div>
          <p>
            When a session is closed, the license(s) and key(s) associated with it are no longer
            available to decrypt <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>. All <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-36"><code>MediaKeySession</code></a> methods
            will fail and no further events will be queued for this object after this algorithm is
            run.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-95"><div role="heading" class="note-title marker" id="h-note-95" aria-level="5"><span>Note</span></div><div class="">
            <p>
              The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-69">CDM</a> may close a session at any point, such as when the session is no longer
              needed or when system resources are lost. In that case, the <a data-link-type="dfn|abstract-op" href="#dfn-monitor-for-cdm-state-changes" class="internalDFN" id="ref-for-dfn-monitor-for-cdm-state-changes-3">Monitor for CDM State Changes</a> algorithm detects the change and runs this algorithm.
            </p>
            <p>
              Keys in other sessions <em class="rfc2119">MUST</em> be unaffected, even if they have overlapping key IDs.
            </p>
            <p>
              After this algorithm has run, event handlers for the events queued by this algorithm
              will be executed, but no further events can be queued. As a result, no messages can
              be sent by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-70">CDM</a> as a result of closing the session.
            </p>
          </div></div>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let <var>session</var> be the associated <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-37"><code>MediaKeySession</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Let <var>promise</var> be the <var>session</var>'s <a data-link-type="idl" href="#dom-mediakeysession-closed" class="internalDFN" id="ref-for-dom-mediakeysession-closed-5"><code>closed</code></a>
                attribute.
              </p>
            </li>
            
            <li>
              <p>
                If <var>promise</var> is resolved, abort these steps.
              </p>
            </li>
            
            <li>
              <p>
                Set the <var>session</var>'s <var>closing or closed</var> value to true.
              </p>
            </li>
            <li>
              <p>
                Run the <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-6">Update Key Statuses</a> algorithm on the <var>session</var>, providing an
                empty sequence.
              </p>
            </li>
            <li>
              <p>
                Run the <a data-link-type="dfn|abstract-op" href="#dfn-update-expiration" class="internalDFN" id="ref-for-dfn-update-expiration-4">Update Expiration</a> algorithm on the <var>session</var>, providing
                <code>NaN</code>.
              </p>
            </li>
            <li>
              <p>
                Resolve <var>promise</var> with the provided reason.
              </p>
            </li>
          </ol>
        </section>
        <section id="monitor-cdm"><div class="header-wrapper"><h4 id="x6-6-5-monitor-for-cdm-state-changes"><bdi class="secno">6.6.5 </bdi>
            <dfn id="dfn-monitor-for-cdm-state-changes" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Monitor for CDM State Changes</dfn>
          </h4><a class="self-link" href="#monitor-cdm" aria-label="Permalink for Section 6.6.5"></a></div>
          
          <p>
            The Monitor for CDM State Changes algorithm executes steps required when various
            aspects of <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-71">CDM</a> state change.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-96"><div role="heading" class="note-title marker" id="h-note-96" aria-level="5"><span>Note</span></div><p class="">
            This algorithm only applies to <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-72">CDM</a> state changes that are not covered by other
            algorithms. For example, <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-10"><code>update</code></a><code>()</code> may result in messages, key
            status changes and/or expiration changes, but those are all handled within that
            algorithm.
          </p></div>
          <div class="note" role="note" id="issue-container-generatedID-97"><div role="heading" class="note-title marker" id="h-note-97" aria-level="5"><span>Note</span></div><p class="">
            The algorithm is always run in parallel to the main event loop.
          </p></div>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let <var>session</var> be the <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-38"><code>MediaKeySession</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Let <var>cdm</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-73">CDM</a> instance represented by <var>session</var>'s
                <var>cdm instance</var> value.
              </p>
            </li>
            <li>
              <p>
                If <var>cdm</var> has an outgoing message that has not yet been sent, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to execute the following steps:
              </p>
              <ol>
                <li>
                  <p>
                    Let <var>message type</var> and <var>message</var> be the message type and
                    message, respectively.
                  </p>
                </li>
                <li>
                  <p>
                    Run the <a data-link-type="dfn|abstract-op" href="#dfn-queue-a-message-event" class="internalDFN" id="ref-for-dfn-queue-a-message-event-6">Queue a "message" Event</a> algorithm, passing <var>session</var>,
                    <var>message type</var> and <var>message</var>.
                  </p>
                </li>
              </ol>
            </li>
            <li>
              <p>
                If <var>cdm</var> has changed the set of keys <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-7">known</a> to <var>session</var> or
                the status of one or more of the keys, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to execute the following
                steps:
              </p>
              <ol>
                <li>
                  <p>
                    Let <var>statuses</var> be a list of key ID and <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-16"><code>MediaKeyStatus</code></a> value pairs
                    containing one pair for each key <a data-link-type="dfn|abstract-op" href="#dfn-known" class="internalDFN" id="ref-for-dfn-known-8">known</a> to <var>session</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Run the <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-7">Update Key Statuses</a> algorithm, passing <var>session</var> and
                    <var>statuses</var>.
                  </p>
                </li>
              </ol>
            </li>
            <li>
              <p>
                If <var>cdm</var> has changed the <a data-link-type="dfn|abstract-op" href="#dfn-expiration" class="internalDFN" id="ref-for-dfn-expiration-7">expiration time</a> of <var>session</var>,
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to execute the following steps:
              </p>
              <ol>
                <li>
                  <p>
                    Let <var>expiration time</var> be the new expiration time of
                    <var>session</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Run the <a data-link-type="dfn|abstract-op" href="#dfn-update-expiration" class="internalDFN" id="ref-for-dfn-update-expiration-5">Update Expiration</a> algorithm, passing <var>session</var> and
                    <var>expiration time</var>.
                  </p>
                </li>
              </ol>
            </li>
            <li>
              <p>
                If <var>cdm</var> has closed <var>session</var>, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to run the
                <a data-link-type="dfn|abstract-op" href="#dfn-session-closed" class="internalDFN" id="ref-for-dfn-session-closed-5">Session Closed</a> algorithm on <var>session</var> with an appropriate
                <a data-link-type="idl" data-lt="MediaKeySessionClosedReason" href="#dom-mediakeysessionclosedreason" class="internalDFN" id="ref-for-dom-mediakeysessionclosedreason-5"><code>MediaKeySessionClosedReason</code></a> value.
              </p>
            </li>
            <li>
              <p>
                If <var>cdm</var> has become unavailable, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to run the <a data-link-type="dfn|abstract-op" href="#dfn-cdm-unavailable" class="internalDFN" id="ref-for-dfn-cdm-unavailable-1">CDM Unavailable</a> algorithm.
              </p>
            </li>
          </ol>
        </section>
      </section>
      <section id="exceptions"><div class="header-wrapper"><h3 id="x6-7-exceptions"><bdi class="secno">6.7 </bdi>
          Exceptions
        </h3><a class="self-link" href="#exceptions" aria-label="Permalink for Section 6.7"></a></div>
        
        <p id="error-names">
          The methods report errors by rejecting the returned promise with a <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-simple-exception">simple exception</a>
          [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] or a <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a>. The following <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-simple-exception">simple exceptions</a> and <a href="https://webidl.spec.whatwg.org/#idl-DOMException-error-names">DOMException names</a> from [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] are used in
          the algorithms. Causes specified specified in the algorithms are listed alongside each
          name, though these names <em class="rfc2119">MAY</em> be used for other reasons as well.
        </p>
        <table class="old-table">
          <tbody>
            <tr>
              <th>
                Name
              </th>
              <th>
                Possible Causes (non-exhaustive)
              </th>
            </tr>
            <tr>
              <td>
                <code><dfn id="dfn-typeerror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">TypeError</dfn></code>
              </td>
              <td>
                The parameter is empty.<br>
                Invalid initialization data.<br>
                Invalid response format.<br>
                A persistent license was provided for a "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-11"><code>temporary</code></a>"
                session.
              </td>
            </tr>
            <tr>
              <td>
                <code><dfn id="dfn-notsupportederror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">NotSupportedError</dfn></code>
              </td>
              <td>
                The existing <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-24"><code>MediaKeys</code></a> object cannot be removed.<br>
                The <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-28">Key System</a> is not supported.<br>
                The initialization data type is not supported by the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-29">Key System</a>.<br>
                The session type is not supported by the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-30">Key System</a>.<br>
                The initialization data is not supported by the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-31">Key System</a>.<br>
                The operation is not supported by the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-32">Key System</a>.
              </td>
            </tr>
            <tr>
              <td>
                <code><dfn id="dfn-invalidstateerror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">InvalidStateError</dfn></code>
              </td>
              <td>
                The existing <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-25"><code>MediaKeys</code></a> object cannot be removed at this time.<br>
                The session has already been used.<br>
                The session is not yet initialized.<br>
                The session is closed.
              </td>
            </tr>
            <tr>
              <td>
                <code><dfn id="dfn-quotaexceedederror" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">QuotaExceededError</dfn></code>
              </td>
              <td>
                The <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-26"><code>MediaKeys</code></a> object cannot be used with additional <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-5"><code>HTMLMediaElement</code></a>s.<br>
                A non-closed session already exists for this sessionId.<br>
                There are insufficient resources to create a new session or license request.
              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section id="session-storage"><div class="header-wrapper"><h3 id="x6-8-session-storage-and-persistence"><bdi class="secno">6.8 </bdi>
          Session Storage and Persistence
        </h3><a class="self-link" href="#session-storage" aria-label="Permalink for Section 6.8"></a></div>
        
        <p>
          This section provides an overview of session storage and persistence that complements the
          algorithms.
        </p>
        <p>
          The following requirements apply in addition to those in <a data-link-type="dfn|abstract-op" href="#dfn-storage-and-persistence" class="internalDFN" id="ref-for-dfn-storage-and-persistence-1">Storage and Persistence</a>.
        </p>
        <p>
          If the result of running the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-7">Is persistent session type?</a> algorithm on this object's
          <var>session type</var> is <code>false</code>, the user agent and <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-74">CDM</a> <em class="rfc2119">MUST NOT</em>
          persist a record of or data related to the session at any point. This includes
          license(s), key(s), <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-10">record(s) of license destruction</a>, and the <a data-link-type="dfn|abstract-op" href="#dfn-session-id" class="internalDFN" id="ref-for-dfn-session-id-5">Session ID</a>.
        </p>
        <p>
          The remainder of this section applies to session types for which the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-8">Is persistent session type?</a> algorithm returns <code>true</code>.
        </p>
        <p>
          The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-75">CDM</a> <em class="rfc2119">SHOULD NOT</em> store session data, including the Session ID, until
          <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-11"><code>update</code></a><code>()</code> is called the first time. Specifically, the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-76">CDM</a> <em class="rfc2119">SHOULD NOT</em> store session data during the <a data-link-type="idl" data-lt="generateRequest()" href="#dom-mediakeysession-generaterequest" class="internalDFN" id="ref-for-dom-mediakeysession-generaterequest-4"><code>generateRequest</code></a><code>()</code> algorithm. This
          ensures that the application is aware of the session and knows it needs to eventually
          remove it.
        </p>
        <p>
          <em>All</em> data associated with a session <em class="rfc2119">MUST</em> be cleared when the session is cleared,
          such as in <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-12"><code>update</code></a><code>()</code> when processing a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-11">record of license destruction</a> acknowledgement. See <a href="#persistent-state-requirements">Persistent
          Data</a>.
        </p>
        <p>
          The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-77">CDM</a> <em class="rfc2119">MUST</em> ensure that data for a given session is only present in one
          <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-39"><code>MediaKeySession</code></a> object that is not <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-8">closed</a> in any <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a>.
          In other words, <a data-link-type="idl" data-lt="load()" href="#dom-mediakeysession-load" class="internalDFN" id="ref-for-dom-mediakeysession-load-5"><code>load</code></a><code>()</code> <em class="rfc2119">MUST</em> fail when there is already a
          <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-40"><code>MediaKeySession</code></a> representing the session specified by the <var>sessionId</var>
          parameter, either because the object that created it via
          <a data-link-type="idl" data-lt="generateRequest()" href="#dom-mediakeysession-generaterequest" class="internalDFN" id="ref-for-dom-mediakeysession-generaterequest-5"><code>generateRequest</code></a><code>()</code> is still active or it has been loaded into another
          object via <a data-link-type="idl" data-lt="load()" href="#dom-mediakeysession-load" class="internalDFN" id="ref-for-dom-mediakeysession-load-6"><code>load</code></a><code>()</code>. A session <em class="rfc2119">MAY</em> only be loaded again if all objects
          that have ever represented it are <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-9">closed</a>.
        </p>
        <p>
          An application that creates a session using a type for which the <a data-link-type="dfn|abstract-op" href="#dfn-is-persistent-session-type" class="internalDFN" id="ref-for-dfn-is-persistent-session-type-9">Is persistent session type?</a> algorithm returns <code>true</code> <em class="rfc2119">SHOULD</em> later remove the stored data by first
          initiating the removal process using <a data-link-type="idl" data-lt="remove()" href="#dom-mediakeysession-remove" class="internalDFN" id="ref-for-dom-mediakeysession-remove-3"><code>remove</code></a><code>()</code> and then ensuring that
          the removal process, which may involve message exchange(s), successfully completes. The
          <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-78">CDM</a> <em class="rfc2119">MAY</em> also remove sessions as appropriate, but applications <em class="rfc2119">SHOULD NOT</em> rely on
          this.
        </p>
        <p>
          See <a href="#security" class="sec-ref"><bdi class="secno">10. </bdi>
        Security</a> and <a href="#privacy" class="sec-ref"><bdi class="secno">11. </bdi>
        Privacy</a> for additional considerations
          when supporting persistent storage.
        </p>
      </section>
    </section>
    <section id="htmlmediaelement-extensions"><div class="header-wrapper"><h2 id="x7-htmlmediaelement-extensions"><bdi class="secno">7. </bdi>
        <dfn id="dom-htmlmediaelement" data-idl="interface" data-title="HTMLMediaElement" data-dfn-for="" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code>HTMLMediaElement</code></dfn> Extensions
      </h2><a class="self-link" href="#htmlmediaelement-extensions" aria-label="Permalink for Section 7."></a></div>
      
      <p>
        This section specifies additions to and modifications of the <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-6"><code>HTMLMediaElement</code></a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>]
        when the Encrypted Media Extensions are supported.
      </p>
      <p>
        The following internal values are added to the <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-7"><code>HTMLMediaElement</code></a>:
      </p>
      <ul>
        <li>
          <p>
            <var>attaching media keys</var>, which <em class="rfc2119">SHALL</em> have a boolean value.
          </p>
        </li>
        <li>
          <p>
            <var>encrypted block queue</var>, which <em class="rfc2119">SHALL</em> be a queue of encrypted blocks awaiting
            decryption.
          </p>
        </li>
        <li>
          <p>
            <var>decryption blocked waiting for key</var>, which <em class="rfc2119">SHALL</em> have a boolean value.
          </p>
        </li>
        <li>
          <p>
            <var>playback blocked waiting for key</var>, which <em class="rfc2119">SHALL</em> have a boolean value.
          </p>
        </li>
      </ul>
      <p>
        The following modifications are made to the behaviour of the <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-8"><code>HTMLMediaElement</code></a>:
      </p>
      <ul>
        <li>
          <p>
            When a <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-9"><code>HTMLMediaElement</code></a> is created, its <var>attaching media keys</var> value <em class="rfc2119">SHALL</em>
            be initialized to <code>false</code>, its <var>encrypted block queue</var> value <em class="rfc2119">SHALL</em>
            be empty, its <var>decryption blocked waiting for key</var> value <em class="rfc2119">SHALL</em> be initialized
            to <code>false</code>, and its <var>playback blocked waiting for key</var> value <em class="rfc2119">SHALL</em>
            be initialized to <code>false</code>.
          </p>
        </li>
        <li>
          <p>
            When the <a href="https://html.spec.whatwg.org/multipage/#current-playback-position">current playback position</a> is
            changed other than advancing in the <a href="https://html.spec.whatwg.org/multipage/#direction-of-playback">direction
            of playback</a> as part of normal playback, the <var>encrypted block queue</var> value
            <em class="rfc2119">SHALL</em> be empty, the <var>decryption blocked waiting for key</var> value <em class="rfc2119">SHALL</em> be
            initialized to <code>false</code>, and the <var>playback blocked waiting for key</var>
            value <em class="rfc2119">SHALL</em> be set to <code>false</code>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-98"><div role="heading" class="note-title marker" id="h-note-98" aria-level="3"><span>Note</span></div><p class="">
            In other words, these values should be reset when, for example, <a href="https://html.spec.whatwg.org/multipage/#loading-the-media-resource">loading the media resource</a> or <a href="https://html.spec.whatwg.org/multipage/#seeking">seeking</a>.
          </p></div>
        </li>
        <li>
          <p>
            In addition to the criteria specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], an <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-10"><code>HTMLMediaElement</code></a> <em class="rfc2119">SHALL</em> be
            considered a <a href="https://html.spec.whatwg.org/multipage/#blocked-media-element">blocked media element</a> if its
            <var>playback blocked waiting for key</var> value is <code>true</code>.
          </p>
        </li>
        <li>
          <p>
            When the user agent is ready to begin playback and has encountered an indication that
            the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> may contain encrypted blocks during the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#concept-media-load-resource">resource fetch algorithm</a>, the user agent <em class="rfc2119">SHALL</em> run the <a href="#media-may-contain-encrypted-blocks">Media Data May Contain Encrypted Blocks</a>
            algorithm.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-99"><div role="heading" class="note-title marker" id="h-note-99" aria-level="3"><span>Note</span></div><p class="">
            For some container formats, such indication is separate from <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-11">Initialization Data</a>.
          </p></div>
          <div class="note" role="note" id="issue-container-generatedID-100"><div role="heading" class="note-title marker" id="h-note-100" aria-level="3"><span>Note</span></div><p class="">
            The algorithm is to be run after parsing the relevant container data, including running
            the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-encountered" class="internalDFN" id="ref-for-dfn-initialization-data-encountered-1">Initialization Data Encountered</a> algorithm, but before decoding starts.
          </p></div>
        </li>
        <li>
          <p>
            When the user agent encounters <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-12">Initialization Data</a> in the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> during the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#concept-media-load-resource">resource fetch algorithm</a>, the user agent <em class="rfc2119">SHALL</em> run the
            <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-encountered" class="internalDFN" id="ref-for-dfn-initialization-data-encountered-2">Initialization Data Encountered</a> algorithm.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-101"><div role="heading" class="note-title marker" id="h-note-101" aria-level="3"><span>Note</span></div><p class="">
            Some container formats may support encrypted media data that does not contain
            <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-13">Initialization Data</a> and thus support media data that does not trigger this
            algorithm.
          </p></div>
        </li>
        <li>
          <p>
            For each block of encrypted <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> encountered during the
            <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#concept-media-load-resource">resource fetch algorithm</a>, the user agent <em class="rfc2119">SHALL</em> run the <a data-link-type="dfn|abstract-op" href="#dfn-encrypted-block-encountered" class="internalDFN" id="ref-for-dfn-encrypted-block-encountered-1">Encrypted Block Encountered</a> algorithm in the order the encrypted blocks were encountered.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-102"><div role="heading" class="note-title marker" id="h-note-102" aria-level="3"><span>Note</span></div><p class="">
            The above step provides flexibility for user agent implementations to perform
            decryption at any time after an encrypted block is encountered before it is needed for
            playback.
          </p></div>
        </li>
        <li>
          <p>
            When one of the following occurs while the <var>decryption blocked waiting for
            key</var> value is <code>true</code>, the user agent <em class="rfc2119">SHALL</em> run the <a data-link-type="dfn|abstract-op" href="#dfn-wait-for-key" class="internalDFN" id="ref-for-dfn-wait-for-key-1">Wait for Key</a>
            algorithm.
          </p>
          <ul>
            <li>
              <p>
                The user agent cannot advance the <a href="https://html.spec.whatwg.org/multipage/#current-playback-position">current playback position</a> in the <a href="https://html.spec.whatwg.org/multipage/#direction-of-playback">direction of playback</a>.
              </p>
            </li>
            <li>
              <p>
                The user agent cannot provide data for the <a href="https://html.spec.whatwg.org/multipage/#current-playback-position">current playback position</a>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-103"><div role="heading" class="note-title marker" id="h-note-103" aria-level="3"><span>Note</span></div><p class="">
                For example, at the beginning of playback or after <a href="https://html.spec.whatwg.org/multipage/#seeking">seeking</a>.
              </p></div>
            </li>
          </ul>
        </li>
        <li>
          <p>
            Additional attributes and a method are added, as specified below.
          </p>
        </li>
      </ul>
      <p>
        For methods that return a promise, all errors are reported asynchronously by rejecting the
        returned Promise. This includes [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] type mapping errors.
      </p>
      <p>
        The steps of an algorithm are always aborted when rejecting a promise.
      </p>
      <pre class="idl def" id="webidl-1869224078"><span class="idlHeader"><a class="self-link" href="#webidl-1869224078">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-htmlmediaelement-partial-1" data-title="HTMLMediaElement">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>] partial interface <a class="internalDFN idlID" data-link-type="interface" href="#dom-htmlmediaelement" id="ref-for-dom-htmlmediaelement-11"><code>HTMLMediaElement</code></a> {<span data-idl="" class="idlAttribute" id="idl-def-htmlmediaelement-mediakeys" data-title="mediaKeys" data-dfn-for="HTMLMediaElement">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>] readonly        attribute<span class="idlType"> <a data-link-type="idl" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-27"><code>MediaKeys</code></a>?</span>   <a class="internalDFN idlName" data-link-type="attribute" href="#dom-htmlmediaelement-mediakeys" id="ref-for-dom-htmlmediaelement-mediakeys-2"><code>mediaKeys</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-htmlmediaelement-onencrypted" data-title="onencrypted" data-dfn-for="HTMLMediaElement">
                                  attribute<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-htmlmediaelement-onencrypted" id="ref-for-dom-htmlmediaelement-onencrypted-1"><code>onencrypted</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-htmlmediaelement-onwaitingforkey" data-title="onwaitingforkey" data-dfn-for="HTMLMediaElement">
                                  attribute<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-htmlmediaelement-onwaitingforkey" id="ref-for-dom-htmlmediaelement-onwaitingforkey-1"><code>onwaitingforkey</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-htmlmediaelement-setmediakeys-mediakeys" data-title="setMediaKeys" data-dfn-for="HTMLMediaElement">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>]<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-htmlmediaelement-setmediakeys" id="ref-for-dom-htmlmediaelement-setmediakeys-2"><code>setMediaKeys</code></a> (<span class="idlType"><a data-link-type="idl" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-28"><code>MediaKeys</code></a>?</span> <span class="idlParamName">mediaKeys</span>);</span>
};</span></code></pre>
      <section id="attributes-3"><div class="header-wrapper"><h3 id="x7-1-attributes"><bdi class="secno">7.1 </bdi>
          Attributes
        </h3><a class="self-link" href="#attributes-3" aria-label="Permalink for Section 7.1"></a></div>
        
        <dl class="attributes" data-dfn-for="HTMLMediaElement">
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-htmlmediaelement-mediakeys" data-idl="attribute" data-title="mediaKeys" data-dfn-for="HTMLMediaElement" data-type="MediaKeys" data-lt="mediaKeys" data-local-lt="HTMLMediaElement.mediaKeys" tabindex="0" aria-haspopup="dialog"><code>mediaKeys</code></dfn> of type <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-29"><code>MediaKeys</code></a>, readonly, nullable
          </dt>
          <dd>
            <p>
              The <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-30"><code>MediaKeys</code></a> being used when decrypting encrypted <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> for this media element.
            </p>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-htmlmediaelement-onencrypted" data-idl="attribute" data-title="onencrypted" data-dfn-for="HTMLMediaElement" data-type="EventHandler" data-lt="onencrypted" data-local-lt="HTMLMediaElement.onencrypted" tabindex="0" aria-haspopup="dialog"><code>onencrypted</code></dfn> of type <a data-link-type="idl" data-lt="EventHandler" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a>
          </dt>
          <dd>
            <p>
              Event handler for the <a data-link-type="idl" data-lt="encrypted" href="#dfn-encrypted" class="internalDFN" id="ref-for-dfn-encrypted-4"><code><code>encrypted</code></code></a> event. It <em class="rfc2119">MUST</em> be supported by all
              <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-12"><code>HTMLMediaElement</code></a>s as both a content attribute and an IDL attribute.
            </p>
          </dd>
          <dt>
            <dfn data-export="" data-dfn-type="attribute" id="dom-htmlmediaelement-onwaitingforkey" data-idl="attribute" data-title="onwaitingforkey" data-dfn-for="HTMLMediaElement" data-type="EventHandler" data-lt="onwaitingforkey" data-local-lt="HTMLMediaElement.onwaitingforkey" tabindex="0" aria-haspopup="dialog"><code>onwaitingforkey</code></dfn> of type <a data-link-type="idl" data-lt="EventHandler" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a>
          </dt>
          <dd>
            <p>
              Event handler for the <a data-link-type="idl" data-lt="waitingforkey" href="#dfn-waitingforkey" class="internalDFN" id="ref-for-dfn-waitingforkey-1"><code><code>waitingforkey</code></code></a> event. It <em class="rfc2119">MUST</em> be supported by all
              <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-13"><code>HTMLMediaElement</code></a>s as both a content attribute and an IDL attribute.
            </p>
          </dd>
        </dl>
      </section>
      <section id="methods-4"><div class="header-wrapper"><h3 id="x7-2-methods"><bdi class="secno">7.2 </bdi>
          Methods
        </h3><a class="self-link" href="#methods-4" aria-label="Permalink for Section 7.2"></a></div>
        
        <dl class="methods" data-dfn-for="HTMLMediaElement">
          <dt>
            <dfn data-export="" data-dfn-type="method" id="dom-htmlmediaelement-setmediakeys" data-idl="operation" data-title="setMediaKeys()" data-dfn-for="HTMLMediaElement" data-type="Promise" data-lt="setMediaKeys()|setMediaKeys(mediaKeys)" data-local-lt="HTMLMediaElement.setMediaKeys|HTMLMediaElement.setMediaKeys()|setMediaKeys" tabindex="0" aria-haspopup="dialog"><code>setMediaKeys()</code></dfn>
          </dt>
          <dd>
            <p>
              Provides the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-31"><code>MediaKeys</code></a> to use when decrypting media data during playback.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-104"><div role="heading" class="note-title marker" id="h-note-104" aria-level="4"><span>Note</span></div><p class="">
              Support for clearing or replacing the associated <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-32"><code>MediaKeys</code></a> object during playback
              is a quality of implementation issue. In many cases it will result in a bad user
              experience or rejected promise.
            </p></div>
            <p>
              When this method is invoked, the user agent <em class="rfc2119">MUST</em> run the following steps:
            </p>
            <ol class="method-algorithm">
              
              <li>
                <p>
                  If this object's <var>attaching media keys</var> value is true, return a promise
                  rejected with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-11"><code><code>InvalidStateError</code></code></a>.
                </p>
              </li>
              <li>
                <p>
                  If <var>mediaKeys</var> and the <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-3"><code>mediaKeys</code></a> attribute are the
                  same object, return a resolved promise.
                </p>
              </li>
              <li>
                <p>
                  Let this object's <var>attaching media keys</var> value be true.
                </p>
              </li>
              <li>
                <p>
                  Let <var>promise</var> be a new promise.
                </p>
              </li>
              <li>
                <p>
                  Run the following steps in parallel:
                </p>
                <ol>
                  <li>
                    <p>
                      If all the following conditions hold:
                    </p>
                    <ul>
                      <li>
                        <p>
                          <var>mediaKeys</var> is not null,
                        </p>
                      </li>
                      <li>
                        <p>
                          the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-79">CDM</a> instance represented by <var>mediaKeys</var> is already in
                          use by another media element
                        </p>
                      </li>
                      <li>
                        <p>
                          the user agent is unable to use it with this element
                        </p>
                      </li>
                    </ul>
                    <p>
                      then let this object's <var>attaching media keys</var> value be false and
                      reject <var>promise</var> with a <a data-link-type="idl" data-lt="QuotaExceededError" href="#dfn-quotaexceedederror" class="internalDFN" id="ref-for-dfn-quotaexceedederror-4"><code><code>QuotaExceededError</code></code></a>.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-4"><code>mediaKeys</code></a> attribute is not null, run the
                      following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          If the user agent or <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-80">CDM</a> do not support removing the association, let
                          this object's <var>attaching media keys</var> value be false and reject
                          <var>promise</var> with a <a data-link-type="idl" data-lt="NotSupportedError" href="#dfn-notsupportederror" class="internalDFN" id="ref-for-dfn-notsupportederror-8"><code><code>NotSupportedError</code></code></a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If the association cannot currently be removed, let this object's
                          <var>attaching media keys</var> value be false and reject
                          <var>promise</var> with an <a data-link-type="idl" data-lt="InvalidStateError" href="#dfn-invalidstateerror" class="internalDFN" id="ref-for-dfn-invalidstateerror-12"><code><code>InvalidStateError</code></code></a>.
                        </p>
                        <div class="note" role="note" id="issue-container-generatedID-105"><div role="heading" class="note-title marker" id="h-note-105" aria-level="4"><span>Note</span></div><p class="">
                          For example, some implementations may not allow removal during playback.
                        </p></div>
                      </li>
                      <li>
                        <p>
                          Stop using the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-81">CDM</a> instance represented by the
                          <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-5"><code>mediaKeys</code></a> attribute to decrypt
                          <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> and remove the association with the media
                          element.
                        </p>
                      </li>
                      <li>
                        <p>
                          If the preceding step failed, let this object's <var>attaching media
                          keys</var> value be false and reject <var>promise</var> with the
                          appropriate <a href="#error-names">error name</a>.
                        </p>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      If <var>mediaKeys</var> is not null, run the following steps:
                    </p>
                    <ol>
                      <li>
                        <p>
                          Associate the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-82">CDM</a> instance represented by <var>mediaKeys</var> with
                          the media element for decrypting <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>.
                        </p>
                      </li>
                      <li>
                        <p>
                          If the preceding step failed, run the following steps:
                        </p>
                        <ol>
                          <li>
                            <p>
                              Set the <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-6"><code>mediaKeys</code></a> attribute to null.
                            </p>
                          </li>
                          
                          <li>
                            <p>
                              Let this object's <var>attaching media keys</var> value be false.
                            </p>
                          </li>
                          <li>
                            <p>
                              Reject <var>promise</var> with a new <a data-link-type="idl" data-lt="DOMException" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMException"><code>DOMException</code></a> whose name is
                              the appropriate <a href="#error-names">error name</a>.
                            </p>
                          </li>
                        </ol>
                      </li>
                      <li>
                        <p>
                          <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to run the <a data-link-type="dfn|abstract-op" href="#dfn-attempt-to-resume-playback-if-necessary" class="internalDFN" id="ref-for-dfn-attempt-to-resume-playback-if-necessary-2">Attempt to Resume Playback If Necessary</a>
                          algorithm on the media element.
                        </p>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      Set the <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-7"><code>mediaKeys</code></a> attribute to <var>mediaKeys</var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let this object's <var>attaching media keys</var> value be false.
                    </p>
                  </li>
                  <li>
                    <p>
                      Resolve <var>promise</var>.
                    </p>
                  </li>
                </ol>
              </li>
              <li>
                <p>
                  Return <var>promise</var>.
                </p>
              </li>
            </ol>
          </dd>
        </dl>
      </section>
      <section id="mediaencryptedevent"><div class="header-wrapper"><h3 id="x7-3-mediaencryptedevent"><bdi class="secno">7.3 </bdi>
          <a href="#dom-mediaencryptedevent" class="internalDFN" data-link-type="idl" id="ref-for-dom-mediaencryptedevent-1"><code>MediaEncryptedEvent</code></a>
        </h3><a class="self-link" href="#mediaencryptedevent" aria-label="Permalink for Section 7.3"></a></div>
        
        <p>
          The MediaEncryptedEvent object is used for the <a data-link-type="idl" data-lt="encrypted" href="#dfn-encrypted" class="internalDFN" id="ref-for-dfn-encrypted-5"><code><code>encrypted</code></code></a> event.
        </p>
        <pre class="idl def" id="webidl-1395593112"><span class="idlHeader"><a class="self-link" href="#webidl-1395593112">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-mediaencryptedevent" data-title="MediaEncryptedEvent">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-mediaencryptedevent" data-idl="interface" data-title="MediaEncryptedEvent" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>MediaEncryptedEvent</code></dfn> : <span class="idlSuperclass"><a data-link-type="idl" data-type="interface" href="https://dom.spec.whatwg.org/#event">Event</a></span> {<span data-idl="" class="idlConstructor" id="idl-def-mediaencryptedevent-constructor-type-eventinitdict" data-title="constructor" data-dfn-for="MediaEncryptedEvent">
    <dfn data-export="" data-dfn-type="constructor" id="dom-mediaencryptedevent-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="MediaEncryptedEvent" data-lt="constructor()|constructor(type)|constructor(type, eventInitDict)" data-local-lt="MediaEncryptedEvent.constructor|MediaEncryptedEvent.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">type</span>, optional<span class="idlType"> <a data-link-type="idl" href="#dom-mediaencryptedeventinit" class="internalDFN" id="ref-for-dom-mediaencryptedeventinit-1"><code>MediaEncryptedEventInit</code></a></span> <span class="idlParamName">eventInitDict</span> = {});</span><span data-idl="" class="idlAttribute" id="idl-def-mediaencryptedevent-initdatatype" data-title="initDataType" data-dfn-for="MediaEncryptedEvent">
    readonly        attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span>    <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediaencryptedevent-initdatatype" id="ref-for-dom-mediaencryptedevent-initdatatype-1"><code>initDataType</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-mediaencryptedevent-initdata" data-title="initData" data-dfn-for="MediaEncryptedEvent">
    readonly        attribute<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a>?</span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-mediaencryptedevent-initdata" id="ref-for-dom-mediaencryptedevent-initdata-2"><code>initData</code></a>;</span>
};</span></code></pre>
        <section id="attributes-4"><div class="header-wrapper"><h4 id="x7-3-1-attributes"><bdi class="secno">7.3.1 </bdi>
            Attributes
          </h4><a class="self-link" href="#attributes-4" aria-label="Permalink for Section 7.3.1"></a></div>
          
          <dl class="attributes" data-dfn-for="MediaEncryptedEvent">
            <dt>
              <dfn data-export="" data-dfn-type="attribute" id="dom-mediaencryptedevent-initdatatype" data-idl="attribute" data-title="initDataType" data-dfn-for="MediaEncryptedEvent" data-type="DOMString" data-lt="initDataType" data-local-lt="MediaEncryptedEvent.initDataType" tabindex="0" aria-haspopup="dialog"><code>initDataType</code></dfn> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, readonly
            </dt>
            <dd>
              Indicates the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-6">Initialization Data Type</a> of the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-14">Initialization Data</a> contained
              in the <a data-link-type="idl" href="#dom-mediaencryptedevent-initdata" class="internalDFN" id="ref-for-dom-mediaencryptedevent-initdata-3"><code>initData</code></a> attribute.
            </dd>
            <dt>
              <dfn data-export="" data-dfn-type="attribute" id="dom-mediaencryptedevent-initdata" data-idl="attribute" data-title="initData" data-dfn-for="MediaEncryptedEvent" data-type="ArrayBuffer" data-lt="initData" data-local-lt="MediaEncryptedEvent.initData" tabindex="0" aria-haspopup="dialog"><code>initData</code></dfn> of type <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a>, readonly, nullable
            </dt>
            <dd>
              The <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-15">Initialization Data</a> for the event.
            </dd>
          </dl>
        </section>
        <section id="mediaencryptedeventinit"><div class="header-wrapper"><h4 id="x7-3-2-mediaencryptedeventinit"><bdi class="secno">7.3.2 </bdi>
            <dfn data-export="" data-dfn-type="dictionary" id="dom-mediaencryptedeventinit" data-idl="dictionary" data-title="MediaEncryptedEventInit" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>MediaEncryptedEventInit</code></dfn>
          </h4><a class="self-link" href="#mediaencryptedeventinit" aria-label="Permalink for Section 7.3.2"></a></div>
          
          <pre class="idl def" id="webidl-51354785"><span class="idlHeader"><a class="self-link" href="#webidl-51354785">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-mediaencryptedeventinit" data-title="MediaEncryptedEventInit">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dom-mediaencryptedeventinit" id="ref-for-dom-mediaencryptedeventinit-2"><code>MediaEncryptedEventInit</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a></span> {<span data-idl="" class="idlMember" id="idl-def-mediaencryptedeventinit-initdatatype" data-title="initDataType" data-dfn-for="MediaEncryptedEventInit"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span>    <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediaencryptedeventinit-initdatatype" id="ref-for-dom-mediaencryptedeventinit-initdatatype-1"><code>initDataType</code></a> = "";</span><span data-idl="" class="idlMember" id="idl-def-mediaencryptedeventinit-initdata" data-title="initData" data-dfn-for="MediaEncryptedEventInit"><span class="idlType">
  <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer">ArrayBuffer</a>?</span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dom-mediaencryptedeventinit-initdata" id="ref-for-dom-mediaencryptedeventinit-initdata-1"><code>initData</code></a> = null;</span>
};</span></code></pre>
          <section id="dictionary-mediaencryptedeventinit-members"><div class="header-wrapper"><h5 id="x7-3-2-1-dictionary-mediaencryptedeventinit-members"><bdi class="secno">7.3.2.1 </bdi>
              Dictionary <a class="idlType internalDFN" href="#dom-mediaencryptedeventinit" data-link-type="idl" id="ref-for-dom-mediaencryptedeventinit-3"><code>MediaEncryptedEventInit</code></a> Members
            </h5><a class="self-link" href="#dictionary-mediaencryptedeventinit-members" aria-label="Permalink for Section 7.3.2.1"></a></div>
            
            <dl class="dictionary-members" data-dfn-for="MediaEncryptedEventInit">
              <dt>
                <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediaencryptedeventinit-initdatatype" data-idl="field" data-title="initDataType" data-dfn-for="MediaEncryptedEventInit" data-type="DOMString" tabindex="0" aria-haspopup="dialog">initDataType</dfn></code> of type <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a>, defaulting to
                <code>""</code>
              </dt>
              <dd>
                The <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-7">Initialization Data Type</a>.
              </dd>
              <dt>
                <code><dfn data-export="" data-dfn-type="dict-member" id="dom-mediaencryptedeventinit-initdata" data-idl="field" data-title="initData" data-dfn-for="MediaEncryptedEventInit" data-type="ArrayBuffer" tabindex="0" aria-haspopup="dialog">initData</dfn></code> of type <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a>, nullable, defaulting to
                <code>null</code>
              </dt>
              <dd>
                The <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-16">Initialization Data</a>.
              </dd>
            </dl>
          </section>
        </section>
      </section>
      <section id="htmlmediaelement-events" class="informative"><div class="header-wrapper"><h3 id="x7-4-event-summary"><bdi class="secno">7.4 </bdi>
          Event Summary
        </h3><a class="self-link" href="#htmlmediaelement-events" aria-label="Permalink for Section 7.4"></a></div><p><em>This section is non-normative.</em></p>
        
        <table class="old-table">
          <thead>
            <tr>
              <th>
                Event name
              </th>
              <th>
                Interface
              </th>
              <th>
                Dispatched when...
              </th>
              <th>
                Preconditions
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <code><dfn id="dfn-encrypted" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">encrypted</dfn></code>
              </td>
              <td>
                <a data-link-type="idl" data-lt="MediaEncryptedEvent" href="#dom-mediaencryptedevent" class="internalDFN" id="ref-for-dom-mediaencryptedevent-2"><code>MediaEncryptedEvent</code></a>
              </td>
              <td>
                The user agent encounters <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-17">Initialization Data</a> in the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>.
              </td>
              <td>
                The element's <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> is equal to or greater than
                <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_metadata"><code>HAVE_METADATA</code></a>.
                <div class="note" role="note" id="issue-container-generatedID-106"><div role="heading" class="note-title marker" id="h-note-106" aria-level="4"><span>Note</span></div><p class="">
                  It is possible that the element is playing or has played.
                </p></div>
              </td>
            </tr>
            <tr>
              <td>
                <code><dfn id="dfn-waitingforkey" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">waitingforkey</dfn></code>
              </td>
              <td>
                <a data-link-type="idl" data-lt="Event" data-type="interface" href="https://dom.spec.whatwg.org/#event"><code>Event</code></a>
              </td>
              <td>
                Playback is blocked waiting for a key.
              </td>
              <td>
                The <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> is equal to or less than
                <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_current_data"><code>HAVE_CURRENT_DATA</code></a>. The element's <var>playback blocked waiting
                for key</var> value is newly <code>true</code>.
              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section id="htmlmediaelement-algorithms"><div class="header-wrapper"><h3 id="x7-5-algorithms"><bdi class="secno">7.5 </bdi>
          Algorithms
        </h3><a class="self-link" href="#htmlmediaelement-algorithms" aria-label="Permalink for Section 7.5"></a></div>
        
        <section id="media-may-contain-encrypted-blocks"><div class="header-wrapper"><h4 id="x7-5-1-media-data-may-contain-encrypted-blocks"><bdi class="secno">7.5.1 </bdi>
            Media Data May Contain Encrypted Blocks
          </h4><a class="self-link" href="#media-may-contain-encrypted-blocks" aria-label="Permalink for Section 7.5.1"></a></div>
          
          <p>
            The Media Data May Contain Encrypted Blocks algorithm pauses playback if the user agent
            requires specification of a <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-33"><code>MediaKeys</code></a> object before playing the media data.
            Requests to run this algorithm include a target <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-14"><code>HTMLMediaElement</code></a> object.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>media element</var> be the specified <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-15"><code>HTMLMediaElement</code></a> object.
              </p>
            </li>
            <li>
              <p>
                If the <var>media element</var>'s <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-8"><code>mediaKeys</code></a> attribute is null
                and the implementation requires specification of a <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-34"><code>MediaKeys</code></a> object before
                decoding potentially-encrypted <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>, run the following
                steps:
              </p>
              <div class="note" role="note" id="issue-container-generatedID-107"><div role="heading" class="note-title marker" id="h-note-107" aria-level="5"><span>Note</span></div><p class="">
                These steps may be reached when the application provides <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> before calling <a data-link-type="idl" data-lt="setMediaKeys()" href="#dom-htmlmediaelement-setmediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-setmediakeys-3"><code>setMediaKeys</code></a><code>()</code> to provide a
                <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-35"><code>MediaKeys</code></a> object. Selecting a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-83">CDM</a> may affect the pipeline and/or decoders
                used, so some implementations may delay playback of media data that may contain
                encrypted blocks until a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-84">CDM</a> is specified by passing a <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-36"><code>MediaKeys</code></a> object to
                <a data-link-type="idl" data-lt="setMediaKeys()" href="#dom-htmlmediaelement-setmediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-setmediakeys-4"><code>setMediaKeys</code></a><code>()</code>.
              </p></div>
              <ol>
                <li>
                  <p>
                    Run the <a data-link-type="dfn|abstract-op" href="#dfn-wait-for-key" class="internalDFN" id="ref-for-dfn-wait-for-key-2">Wait for Key</a> algorithm on the <var>media element</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Wait for a signal to resume playback.
                  </p>
                </li>
              </ol>
            </li>
          </ol>
        </section>
        <section id="initdata-encountered"><div class="header-wrapper"><h4 id="x7-5-2-initialization-data-encountered"><bdi class="secno">7.5.2 </bdi>
            <dfn class="export" data-export="" id="dfn-initialization-data-encountered" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Initialization Data Encountered</dfn>
          </h4><a class="self-link" href="#initdata-encountered" aria-label="Permalink for Section 7.5.2"></a></div>
          
          <p>
            The Initialization Data Encountered algorithm queues an <a data-link-type="idl" data-lt="encrypted" href="#dfn-encrypted" class="internalDFN" id="ref-for-dfn-encrypted-6"><code><code>encrypted</code></code></a> event for
            <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-18">Initialization Data</a> encountered in the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>. Requests to
            run this algorithm include a target <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-16"><code>HTMLMediaElement</code></a> object.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>media element</var> be the specified <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-17"><code>HTMLMediaElement</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Let <var>initDataType</var> be the empty string.
              </p>
            </li>
            <li>
              <p>
                Let <var>initData</var> be null.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> is <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-same-origin">CORS-same-origin</a> and <em>not</em>
                <a data-link-type="dfn|abstract-op" data-lt="mixed content limitations" href="#dfn-mixed-content-limitations" class="internalDFN" id="ref-for-dfn-mixed-content-limitations-1">mixed content</a>, run the following steps:
              </p>
              <ol>
                <li>
                  <p>
                    Let <var>initDataType</var> be the string representing the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-8">Initialization Data Type</a> of the Initialization Data.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>initData</var> be the Initialization Data.
                  </p>
                </li>
              </ol>
              <div class="note" role="note" id="issue-container-generatedID-108"><div role="heading" class="note-title marker" id="h-note-108" aria-level="5"><span>Note</span></div><p class="">
                While the media element may allow loading of "Upgradeable Content"
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-mixed-content" title="Mixed Content">MIXED-CONTENT</a></cite>], the user agent <em class="rfc2119">MUST NOT</em> expose Initialization Data from such
                media data to the application.
              </p></div>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to create an event named <a data-link-type="idl" data-lt="encrypted" href="#dfn-encrypted" class="internalDFN" id="ref-for-dfn-encrypted-7"><code><code>encrypted</code></code></a> that does not bubble and is
                not cancellable using the <a href="#dom-mediaencryptedevent" class="internalDFN" data-link-type="idl" id="ref-for-dom-mediaencryptedevent-3"><code>MediaEncryptedEvent</code></a> interface with its
                <var>type</var> attribute set to <code>encrypted</code> and its
                <var>isTrusted</var> attribute initialized to <code>true</code>, and dispatch it at
                the <var>media element</var>.
              </p>
              <p>
                The event interface <a href="#dom-mediaencryptedevent" class="internalDFN" data-link-type="idl" id="ref-for-dom-mediaencryptedevent-4"><code>MediaEncryptedEvent</code></a> has:
              </p>
              <ul style="list-style-type:none">
                <li><a data-link-type="idl" href="#dom-mediaencryptedevent-initdatatype" class="internalDFN" id="ref-for-dom-mediaencryptedevent-initdatatype-2"><code>initDataType</code></a> = <var>initDataType</var><br>
                  <br>
                  <a data-link-type="idl" href="#dom-mediaencryptedevent-initdata" class="internalDFN" id="ref-for-dom-mediaencryptedevent-initdata-4"><code>initData</code></a> = <var>initData</var>
                </li>
              </ul>
              <div class="note" role="note" id="issue-container-generatedID-109"><div role="heading" class="note-title marker" id="h-note-109" aria-level="5"><span>Note</span></div><p class="">
                <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> is <em>not</em> changed and no algorithms are
                aborted. This event merely provides information.
              </p></div>
              <div class="note" role="note" id="issue-container-generatedID-110"><div role="heading" class="note-title marker" id="h-note-110" aria-level="5"><span>Note</span></div><p class="">
                The <a data-link-type="idl" href="#dom-mediaencryptedevent-initdata" class="internalDFN" id="ref-for-dom-mediaencryptedevent-initdata-5"><code>initData</code></a> attribute will be null if the media data is
                <em>not</em> <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-same-origin">CORS-same-origin</a> or is <a data-link-type="dfn|abstract-op" data-lt="mixed content limitations" href="#dfn-mixed-content-limitations" class="internalDFN" id="ref-for-dfn-mixed-content-limitations-2">mixed content</a>. Applications may retrieve the Initialization Data from an alternate
                source.
              </p></div>
            </li>
          </ol>
        </section>
        <section id="encrypted-block-encountered"><div class="header-wrapper"><h4 id="x7-5-3-encrypted-block-encountered"><bdi class="secno">7.5.3 </bdi>
            <dfn class="export" data-export="" id="dfn-encrypted-block-encountered" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Encrypted Block Encountered</dfn>
          </h4><a class="self-link" href="#encrypted-block-encountered" aria-label="Permalink for Section 7.5.3"></a></div>
          
          <p>
            The Encrypted Block Encountered algorithm queues a block of encrypted media data for
            decryption and attempts to decrypt if possible. Requests to run this algorithm include
            a target <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-18"><code>HTMLMediaElement</code></a> object.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>media element</var> be the specified <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-19"><code>HTMLMediaElement</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Let <var>block</var> be the block of encrypted media data.
              </p>
            </li>
            <li>
              <p>
                Add <var>block</var> to the end of the <var>media element</var>'s <var>encrypted
                block queue</var>.
              </p>
            </li>
            <li>
              <p>
                If the <var>media element</var>'s <var>decryption blocked waiting for key</var>
                value is <code>false</code>, run the <a data-link-type="dfn|abstract-op" href="#dfn-attempt-to-decrypt" class="internalDFN" id="ref-for-dfn-attempt-to-decrypt-1">Attempt to Decrypt</a> algorithm.
              </p>
              
            </li>
          </ol>
        </section>
        <section id="attempt-to-decrypt"><div class="header-wrapper"><h4 id="x7-5-4-attempt-to-decrypt"><bdi class="secno">7.5.4 </bdi>
            <dfn id="dfn-attempt-to-decrypt" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Attempt to Decrypt</dfn>
          </h4><a class="self-link" href="#attempt-to-decrypt" aria-label="Permalink for Section 7.5.4"></a></div>
          
          <p>
            The Attempt to Decrypt algorithm attempts to decrypt media data that is queued for
            decryption. Requests to run this algorithm include a target <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-20"><code>HTMLMediaElement</code></a>
            object.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>media element</var> be the specified <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-21"><code>HTMLMediaElement</code></a> object.
              </p>
            </li>
            <li>
              <p>
                If the <var>media element</var>'s <var>encrypted block queue</var> is empty, abort
                these steps.
              </p>
            </li>
            <li>
              <p>
                If the <var>media element</var>'s <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-9"><code>mediaKeys</code></a> attribute is not
                null, run the following steps:
              </p>
              <ol>
                <li>
                  <p>
                    Let <var>media keys</var> be the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-37"><code>MediaKeys</code></a> object referenced by that
                    attribute.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>cdm</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-85">CDM</a> instance represented by <var>media
                    keys</var>'s <var>cdm instance</var> value.
                  </p>
                </li>
                <li>
                  <p>
                    If <var>cdm</var> is no longer usable for any reason, run the following steps:
                  </p>
                  <div class="note" role="note" id="issue-container-generatedID-111"><div role="heading" class="note-title marker" id="h-note-111" aria-level="5"><span>Note</span></div><p class="">
                    These steps are intended to be run on unrecoverable failures of the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-86">CDM</a>.
                  </p></div>
                  <ol>
                    <li>
                      <p>
                        Run the <a href="https://html.spec.whatwg.org/multipage/#fatal-decode-error">media data is corrupted</a>
                        steps of the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#concept-media-load-resource">resource fetch algorithm</a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Run the <a data-link-type="dfn|abstract-op" href="#dfn-cdm-unavailable" class="internalDFN" id="ref-for-dfn-cdm-unavailable-2">CDM Unavailable</a> algorithm on <var>media keys</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Abort these steps.
                      </p>
                    </li>
                  </ol>
                </li>
                <li>
                  <p>
                    If there is at least one <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-41"><code>MediaKeySession</code></a> created by the <var>media
                    keys</var> that is not <a data-link-type="dfn|abstract-op" href="#dfn-closed" class="internalDFN" id="ref-for-dfn-closed-10">closed</a>, run the following steps:
                  </p>
                  <div class="note" role="note" id="issue-container-generatedID-112"><div role="heading" class="note-title marker" id="h-note-112" aria-level="5"><span>Note</span></div><p class="">
                    This check ensures the <var>cdm</var> has finished loading and is a
                    prerequisite for a matching key being available.
                  </p></div>
                  <ol>
                    <li>
                      <p>
                        Let <var>block</var> be the first entry in the <var>media element</var>'s
                        <var>encrypted block queue</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let the <var>block key ID</var> be the key ID of <var>block</var>.
                      </p>
                      <div class="note" role="note" id="issue-container-generatedID-113"><div role="heading" class="note-title marker" id="h-note-113" aria-level="5"><span>Note</span></div><p class="">
                        The key ID is generally specified by the container.
                      </p></div>
                    </li>
                    <li>
                      <p>
                        Use the <var>cdm</var> to execute the following steps:
                      </p>
                      <ol>
                        <li>
                          <p>
                            Let <var>available keys</var> be the union of keys in sessions that
                            were created by the <var>media keys</var>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>block key</var> be null.
                          </p>
                        </li>
                        <li>
                          <p>
                            If any of the <var>available keys</var> corresponds to the <var>block
                            key ID</var> and is <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-8">usable for decryption</a>, let <var>session</var>
                            be a <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-42"><code>MediaKeySession</code></a> object containing that key and let <var>block
                            key</var> be that key.
                          </p>
                          <div class="note" role="note" id="issue-container-generatedID-114"><div role="heading" class="note-title marker" id="h-note-114" aria-level="5"><span>Note</span></div><p class="">
                            If multiple sessions contain a key that is <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-9">usable for decryption</a>
                            for the <var>block key ID</var>, which session and key to use is <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-33">Key System</a>-dependent.
                          </p></div>
                        </li>
                        <li>
                          <p>
                            If the status of any of the <var>available keys</var> changed as the
                            result of running the preceding step, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to run the
                            <a data-link-type="dfn|abstract-op" href="#dfn-update-key-statuses" class="internalDFN" id="ref-for-dfn-update-key-statuses-8">Update Key Statuses</a> algorithm on each affected <var>session</var>,
                            providing all <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-13">key ID</a>(s) in the session along with the appropriate
                            <a data-link-type="idl" data-lt="MediaKeyStatus" href="#dom-mediakeystatus" class="internalDFN" id="ref-for-dom-mediakeystatus-17"><code>MediaKeyStatus</code></a> value(s) for each.
                          </p>
                        </li>
                        <li>
                          <p>
                            If <var>block key</var> is not null, run the following steps:
                          </p>
                          <ol>
                            <li>
                              <p>
                                Use the <var>cdm</var> to decrypt <var>block</var> using <var>block
                                key</var>.
                              </p>
                            </li>
                            <li>
                              <p>
                                Follow the steps for the first matching condition from the
                                following list:
                              </p>
                              <dl class="switch">
                                <dt>
                                  If decryption fails
                                </dt>
                                <dd>
                                  <ol>
                                    <li>
                                      <p>
                                        Run the <a href="https://html.spec.whatwg.org/multipage/#fatal-decode-error">media data
                                        is corrupted</a> steps of the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#concept-media-load-resource">resource fetch algorithm</a>.
                                      </p>
                                    </li>
                                    <li>
                                      <p>
                                        If <var>cdm</var> is no longer usable for any reason then
                                        run the <a data-link-type="dfn|abstract-op" href="#dfn-cdm-unavailable" class="internalDFN" id="ref-for-dfn-cdm-unavailable-3">CDM Unavailable</a> algorithm on <var>media
                                        keys</var>.
                                      </p>
                                    </li>
                                    <li>
                                      <p>
                                        Abort these steps.
                                      </p>
                                    </li>
                                  </ol>
                                </dd>
                                <dt>
                                  Otherwise
                                </dt>
                                <dd>
                                  <ol>
                                    <li>
                                      <p>
                                        Remove <var>block</var> from the front of the <var>media
                                        element</var>'s <var>encrypted block queue</var>.
                                      </p>
                                    </li>
                                    <li>
                                      <p>
                                        Process the decrypted block as normal.
                                      </p>
                                      <div class="note" role="note" id="issue-container-generatedID-115"><div role="heading" class="note-title marker" id="h-note-115" aria-level="5"><span>Note</span></div><p class="">
                                        In other words, decode the block.
                                      </p></div>
                                    </li>
                                    <li>
                                      <p>
                                        Return to the beginning of this algorithm.
                                      </p>
                                    </li>
                                  </ol>
                                </dd>
                              </dl>
                              <div class="note" role="note" id="issue-container-generatedID-116"><div role="heading" class="note-title marker" id="h-note-116" aria-level="5"><span>Note</span></div><p class="">
                                Not all decryption problems (e.g., using the wrong key) will result
                                in a decryption failure. In such cases, no error is fired here but
                                one may be fired during decode.
                              </p></div>
                            </li>
                          </ol>
                          <div class="note" role="note" id="issue-container-generatedID-117"><div role="heading" class="note-title marker" id="h-note-117" aria-level="5"><span>Note</span></div><p class="">
                            Otherwise, there is no key for the <var>block key ID</var> in any
                            session so continue.
                          </p></div>
                        </li>
                      </ol>
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
            <li>
              <p>
                Set the <var>media element</var>'s <var>decryption blocked waiting for key</var>
                value to <code>true</code>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-118"><div role="heading" class="note-title marker" id="h-note-118" aria-level="5"><span>Note</span></div><p class="">
                This step is reached when there is no key that is <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-10">usable for decryption</a> for
                <var>block</var>.
              </p></div>
              <div class="note" role="note" id="issue-container-generatedID-119"><div role="heading" class="note-title marker" id="h-note-119" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  Once the user agent has rendered the blocks preceding the block that cannot be
                  decrypted (as much as it can, such as, all complete video frames), it will run
                  the <a data-link-type="dfn|abstract-op" href="#dfn-wait-for-key" class="internalDFN" id="ref-for-dfn-wait-for-key-3">Wait for Key</a> algorithm.
                </p>
                <p>
                  That algorithm is not run directly here in order to allow implementations to
                  decrypt and decode media data ahead of the ahead of the current playback position
                  without affecting the visible behavior.
                </p>
              </div></div>
            </li>
          </ol>
          <div class="note" role="note" id="issue-container-generatedID-120"><div role="heading" class="note-title marker" id="h-note-120" aria-level="5"><span>Note</span></div><div class="">
            <p>
              For frame-based encryption, this may be implemented as follows when the media element
              attempts to decode a frame as part of the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#concept-media-load-resource">resource fetch algorithm</a>:
            </p>
            <ol>
              <li>
                <p>
                  Let <var>encrypted</var> be false.
                </p>
              </li>
              <li>
                <p>
                  Detect whether the frame is encrypted.
                </p>
                <dl class="switch">
                  <dt>
                    If the frame is encrypted
                  </dt>
                  <dd>
                    Run the steps above.
                  </dd>
                  <dt>
                    Otherwise
                  </dt>
                  <dd>
                    Continue.
                  </dd>
                </dl>
              </li>
              <li>
                <p>
                  Decode the frame.
                </p>
              </li>
              <li>
                <p>
                  Provide the frame for rendering.
                </p>
              </li>
            </ol>
          </div></div>
        </section>
        <section id="wait-for-key"><div class="header-wrapper"><h4 id="x7-5-5-wait-for-key"><bdi class="secno">7.5.5 </bdi>
            <dfn id="dfn-wait-for-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Wait for Key</dfn>
          </h4><a class="self-link" href="#wait-for-key" aria-label="Permalink for Section 7.5.5"></a></div>
          
          <p>
            The Wait for Key algorithm queues a <a data-link-type="idl" data-lt="waitingforkey" href="#dfn-waitingforkey" class="internalDFN" id="ref-for-dfn-waitingforkey-2"><code><code>waitingforkey</code></code></a> event and updates
            <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a>. It should only be called when the <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-22"><code>HTMLMediaElement</code></a>
            object is <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#potentially-playing">potentially playing</a> and its <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a>
            is equal to <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_future_data"><code>HAVE_FUTURE_DATA</code></a> or greater. Requests to run this
            algorithm include a target <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-23"><code>HTMLMediaElement</code></a> object.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>media element</var> be the specified <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-24"><code>HTMLMediaElement</code></a> object.
              </p>
            </li>
            <li>
              <p>
                If the <var>media element</var>'s <var>playback blocked waiting for key</var> value
                is <code>true</code>, abort these steps.
              </p>
            </li>
            <li>
              <p>
                Set the <var>media element</var>'s <var>playback blocked waiting for key</var>
                value to <code>true</code>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-121"><div role="heading" class="note-title marker" id="h-note-121" aria-level="5"><span>Note</span></div><p class="">
                As a result of the above step, the media element will become a <a href="https://html.spec.whatwg.org/multipage/#blocked-media-element">blocked media element</a> if it wasn't already. In
                that case, the media element will stop playback.
              </p></div>
            </li>
            <li>
              <p>
                Follow the steps for the first matching condition from the following list:
              </p>
              <dl class="switch">
                <dt>
                  If data for the immediate <a href="https://html.spec.whatwg.org/multipage/#current-playback-position">current
                  playback position</a> is available
                </dt>
                <dd>
                  <p>
                    Set the <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> of <var>media element</var> to
                    <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_current_data"><code>HAVE_CURRENT_DATA</code></a>.
                  </p>
                </dd>
                <dt>
                  Otherwise
                </dt>
                <dd>
                  <p>
                    Set the <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> of <var>media element</var> to
                    <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_metadata"><code>HAVE_METADATA</code></a>.
                  </p>
                </dd>
              </dl>
              <div class="note" role="note" id="issue-container-generatedID-122"><div role="heading" class="note-title marker" id="h-note-122" aria-level="5"><span>Note</span></div><p class="">
                In other words, if the video frame and audio data for the <a href="https://html.spec.whatwg.org/multipage/#current-playback-position">current playback position</a> have been decoded
                because they were unencrypted and/or successfully decrypted, set
                <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> to <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_current_data"><code>HAVE_CURRENT_DATA</code></a>.
                Otherwise, including if this was previously the case but the data is no longer
                available, set <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> to
                <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_metadata"><code>HAVE_METADATA</code></a>.
              </p></div>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <a data-link-type="idl" data-lt="waitingforkey" href="#dfn-waitingforkey" class="internalDFN" id="ref-for-dfn-waitingforkey-3"><code><code>waitingforkey</code></code></a> at the <var>media
                element</var>.
              </p>
            </li>
            <li>
              <p>
                Suspend playback.
              </p>
            </li>
          </ol>
        </section>
        <section id="resume-playback"><div class="header-wrapper"><h4 id="x7-5-6-attempt-to-resume-playback-if-necessary"><bdi class="secno">7.5.6 </bdi>
            <dfn id="dfn-attempt-to-resume-playback-if-necessary" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Attempt to Resume Playback If Necessary</dfn>
          </h4><a class="self-link" href="#resume-playback" aria-label="Permalink for Section 7.5.6"></a></div>
          
          <p>
            The Attempt to Resume Playback If Necessary algorithm resumes playback if the media
            element is blocked waiting for a key and necessary key is currently <a data-link-type="dfn|abstract-op" href="#dfn-usable-for-decryption" class="internalDFN" id="ref-for-dfn-usable-for-decryption-11">usable for decryption</a> Requests to run this algorithm include a target <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-25"><code>HTMLMediaElement</code></a>
            object.
          </p>
          <p>
            The following steps are run:
          </p>
          <ol>
            <li>
              <p>
                Let the <var>media element</var> be the specified <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-26"><code>HTMLMediaElement</code></a> object.
              </p>
            </li>
            <li>
              <p>
                If the <var>media element</var>'s <var>playback blocked waiting for key</var> is
                <code>false</code>, abort these steps.
              </p>
            </li>
            <li>
              <p>
                Run the <a data-link-type="dfn|abstract-op" href="#dfn-attempt-to-decrypt" class="internalDFN" id="ref-for-dfn-attempt-to-decrypt-2">Attempt to Decrypt</a> algorithm on the <var>media element</var>.
              </p>
            </li>
            <li>
              <p>
                If the user agent can advance the <a href="https://html.spec.whatwg.org/multipage/#current-playback-position">current playback position</a> in the <a href="https://html.spec.whatwg.org/multipage/#direction-of-playback">direction of playback</a>:
              </p>
              <ol>
                <li>
                  <p>
                    Set the <var>media element</var>'s <var>decryption blocked waiting for
                    key</var> value to <code>false</code>.
                  </p>
                </li>
                <li>
                  <p>
                    Set the <var>media element</var>'s <var>playback blocked waiting for key</var>
                    value to <code>false</code>.
                  </p>
                  <div class="note" role="note" id="issue-container-generatedID-123"><div role="heading" class="note-title marker" id="h-note-123" aria-level="5"><span>Note</span></div><p class="">
                    As a result of the above step, the media element may no longer be a
                    <a href="https://html.spec.whatwg.org/multipage/#blocked-media-element">blocked media element</a> and thus
                    playback may resume.
                  </p></div>
                </li>
                <li>
                  <p>
                    Set the <var>media element</var>'s <a data-link-type="idl" data-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate"><code>readyState</code></a> value to
                    <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_current_data"><code>HAVE_CURRENT_DATA</code></a>, <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_future_data"><code>HAVE_FUTURE_DATA</code></a>
                    or <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_enough_data"><code>HAVE_ENOUGH_DATA</code></a> as <a href="https://html.spec.whatwg.org/multipage/#ready-states">appropriate</a>.
                  </p>
                  <div class="note" role="note" id="issue-container-generatedID-124"><div role="heading" class="note-title marker" id="h-note-124" aria-level="5"><span>Note</span></div><div class="">
                    <p>
                      States beyond <a data-link-type="idl" data-type="const" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-have_current_data"><code>HAVE_CURRENT_DATA</code></a> and the
                      <a data-link-type="dfn|abstract-op" data-type="event" href="https://html.spec.whatwg.org/multipage/media.html#event-media-canplaythrough">canplaythrough</a> event do not (or are unlikely to)
                      consider key availability beyond the current key.
                    </p>
                    <p>
                      The change in ready state may also cause <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-27"><code>HTMLMediaElement</code></a> events to be
                      fired as described <a href="https://html.spec.whatwg.org/multipage/#ready-states">here</a>.
                    </p>
                  </div></div>
                </li>
              </ol>
            </li>
          </ol>
        </section>
      </section>
      <section id="media-element-restrictions" class="informative"><div class="header-wrapper"><h3 id="x7-6-media-element-restrictions"><bdi class="secno">7.6 </bdi>
          Media Element Restrictions
        </h3><a class="self-link" href="#media-element-restrictions" aria-label="Permalink for Section 7.6"></a></div><p><em>This section is non-normative.</em></p>
        
        <p>
          Media data processed by a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-87">CDM</a> <em class="rfc2119">MAY</em> be unavailable through web platform APIs in the
          usual way (for example using the <a data-link-type="idl" data-lt="CanvasRenderingContext2D" data-type="interface" href="https://html.spec.whatwg.org/multipage/canvas.html#canvasrenderingcontext2d"><code>CanvasRenderingContext2D</code></a>
          <a data-link-type="idl" data-lt="drawImage()" data-type="method" href="https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-drawimage"><code>drawImage</code></a><code>()</code> method and the <a data-link-type="idl" data-lt="AudioContext" data-type="interface" href="https://www.w3.org/TR/webaudio/#AudioContext"><code>AudioContext</code></a>
          <a data-link-type="idl" data-lt="MediaElementAudioSourceNode" data-type="interface" href="https://www.w3.org/TR/webaudio/#MediaElementAudioSourceNode"><code>MediaElementAudioSourceNode</code></a>). This specification does not define conditions for such
          non-availability of media data, however, if media data is not available to through such
          APIs then they <em class="rfc2119">MAY</em> behave as if no media data was present at all.
        </p>
        <p>
          Where media rendering is not performed by the UA, for example in the case of a
          hardware-based media pipeline, the full set of HTML rendering capabilities, for example
          CSS Transforms, <em class="rfc2119">MAY</em> be unavailable. One likely restriction is that video media <em class="rfc2119">MAY</em> be
          constrained to appear only in rectangular regions with sides parallel to the edges of the
          window and with normal orientation.
        </p>
      </section>
    </section>
    <section id="implementation-requirements"><div class="header-wrapper"><h2 id="x8-implementation-requirements"><bdi class="secno">8. </bdi>
        Implementation Requirements
      </h2><a class="self-link" href="#implementation-requirements" aria-label="Permalink for Section 8."></a></div>
      
      <p>
        This section defines implementation requirements - for both user agents and <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-34">Key Systems</a>, including the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-88">CDM</a> and server(s) - that may not be explicitly addressed in
        the algorithms. The requirements here and throughout the spec apply to all implementations,
        regardless of whether the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-89">CDM</a> is separate from or a part of the user agent.
      </p>
      <section id="cdm-constraint-requirements"><div class="header-wrapper"><h3 id="x8-1-cdm-constraints"><bdi class="secno">8.1 </bdi>
          CDM Constraints
        </h3><a class="self-link" href="#cdm-constraint-requirements" aria-label="Permalink for Section 8.1"></a></div>
        
        <p>
          User agent implementers <em class="rfc2119">MUST</em> ensure that <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-90">CDMs</a> do not access any information, storage
          or system capabilities that are not reasonably required for playback of protected media
          using the features of this specification. Specifically, the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-91">CDM</a> <em class="rfc2119">SHALL NOT</em>:
        </p>
        <ul>
          <li>
            <p>
              Access network resources, either local or remote, except via the user agent as
              explicitly permitted by this specification.
            </p>
          </li>
          <li>
            <p>
              Access storage (e.g., disk or memory), except where reasonably required for playback
              of protected media using the features of this specification.
            </p>
          </li>
          <li>
            <p>
              Access user data other than <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-92">CDM</a> state and <a href="#persistent-state-requirements">persistent data</a>.
            </p>
          </li>
          <li>
            <p>
              Access hardware components or devices, except where reasonably required for playback
              of protected media using the features of this specification.
            </p>
          </li>
        </ul>
        <p>
          User Agent implementers may use various techniques to meet the above requirements. For
          example, a User Agent implementer also implementing their own <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-93">CDM</a> may include the
          above as design requirements for that component. A User Agent implementer making use of a
          third party <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-94">CDM</a> may ensure that it executes in a constrained environment (e.g.,
          "sandbox") without access to the prohibited information and components.
        </p>
      </section>
      <section id="messaging-requirements"><div class="header-wrapper"><h3 id="x8-2-messages-and-communication"><bdi class="secno">8.2 </bdi>
          Messages and Communication
        </h3><a class="self-link" href="#messaging-requirements" aria-label="Permalink for Section 8.2"></a></div>
        
        <p>
          All messages and communication to and from the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-95">CDM</a>, such as between the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-96">CDM</a> and a
          license server, <em class="rfc2119">MUST</em> be passed through the user agent. The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-97">CDM</a> <em class="rfc2119">MUST NOT</em> make direct
          out-of band network requests. All messages and communication other than those described
          in <a href="#direct-individualization">Direct Individualization</a> <em class="rfc2119">MUST</em> be passed
          through the application via the APIs defined in this specification. Specifically, all
          communication that contains application-, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>-, or content-specific information or
          is sent to a URL specified by the application or based on its origin, <em class="rfc2119">MUST</em> pass through
          the APIs. This includes all license exchange messages.
        </p>
      </section>
      <section id="persistent-state-requirements"><div class="header-wrapper"><h3 id="x8-3-persistent-data"><bdi class="secno">8.3 </bdi>
          Persistent Data
        </h3><a class="self-link" href="#persistent-state-requirements" aria-label="Permalink for Section 8.3"></a></div>
        
        <p>
          Persistent Data includes all data stored by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-98">CDM</a>, or by the User Agent on behalf
          of the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-99">CDM</a>, that exists after the destruction of the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-38"><code>MediaKeys</code></a> object.
          Specifically, it includes any identifiers (including <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-14">Distinctive Identifier(s)</a>),
          licenses, keys, key IDs, or <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-12">records of license destruction</a> stored by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-100">CDM</a> or
          by the User Agent on behalf of the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-101">CDM</a>.
        </p>
        <section id="use-origin-specific-key-system-storage"><div class="header-wrapper"><h4 id="x8-3-1-use-origin-specific-and-browsing-profile-specific-key-system-storage"><bdi class="secno">8.3.1 </bdi>
            Use origin-specific and browsing profile-specific <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-35">Key System</a> storage
          </h4><a class="self-link" href="#use-origin-specific-key-system-storage" aria-label="Permalink for Section 8.3.1"></a></div>
          
          <p>
            Persistent Data that might impact messages or behavior in an application- or license
            server-visible way <em class="rfc2119">MUST</em> be stored in an <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>-specific and <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-3">browsing profile</a>-specific way and <em class="rfc2119">MUST NOT</em> leak to or from private browsing sessions.
            Specifically but not exhaustively, session data, licenses, keys and per-origin
            identifiers <em class="rfc2119">MUST</em> be stored per-<a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and per-<a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-4">browsing profile</a>.
          </p>
          <p>
            See <a href="#session-storage">Session Storage and Persistence</a>.
          </p>
        </section>
        <section id="allow-persistent-data-cleared"><div class="header-wrapper"><h4 id="x8-3-2-allow-persistent-data-to-be-cleared"><bdi class="secno">8.3.2 </bdi>
            Allow Persistent Data to Be Cleared
          </h4><a class="self-link" href="#allow-persistent-data-cleared" aria-label="Permalink for Section 8.3.2"></a></div>
          
          <p>
            Implementations that use Persistent Data <em class="rfc2119">MUST</em> allow the user to clear that data such
            that it is no longer retrievable both outside, such as via the APIs defined in this
            specification, and on the client device.
          </p>
          <p>
            User Agents <em class="rfc2119">SHOULD</em>:
          </p>
          <ul>
            <li>
              <p>
                Treat Persistent Data like other site data, such as cookies [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>].
                Specifically:
              </p>
              <ul>
                <li>
                  <p id="allow-persistent-data-cleared-with-cookies">
                    Allow users to clear Persistent Data along with cookies [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>] and other
                    site data.
                  </p>
                </li>
                <li>
                  <p>
                    Allow users to clear Persistent Data as part of user agent features to clear
                    browsing history.
                  </p>
                </li>
                <li>
                  <p>
                    Include Persistent Data in "remove all data" features.
                  </p>
                </li>
                <li>
                  <p>
                    Present Persistent Data in the same UI locations as other site data.
                  </p>
                </li>
              </ul>
            </li>
            <li>
              <p>
                Allow users to clear Persistent Data on a per-<a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and per-<a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-5">browsing profile</a> basis, particularly as part of a "Forget about this site" feature that
                forgets cookies [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>], databases, etc. associated with a particular site.
              </p>
            </li>
            <li>
              <p>
                Ensure that operations which clear Persistent Data are sufficiently atomic to
                prevent a "cookie resurrection" type of recorrelation of a new identifier with the
                old by relying on another type of locally stored data that did not get cleared at
                the same time. See <a href="#incomplete-clearing">incomplete clearing of data</a>.
              </p>
            </li>
            <li>
              <p>
                Present these interfaces in a way that helps users to understand the possibility of
                <a href="#incomplete-clearing">incomplete clearing of data</a> and enables them to
                delete data associated with all features that persist data, including cookies
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>] and web storage, simultaneously.
              </p>
            </li>
            <li>
              <p>
                Present the interfaces for disabling and re-enabling a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-36">Key System</a> in a way that
                helps users to understand the possibility of <a href="#incomplete-clearing">incomplete clearing of data</a> and enables them to delete
                all such data in all persistent storage features simultaneously.
              </p>
            </li>
            <li>
              <p>
                Allow users to specifically delete Persistent Data, by <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and/or for all
                origins.
              </p>
            </li>
          </ul>
        </section>
        <section id="encrypt-or-obfuscate-persistent-data"><div class="header-wrapper"><h4 id="x8-3-3-encrypt-or-obfuscate-persistent-data"><bdi class="secno">8.3.3 </bdi>
            Encrypt or obfuscate Persistent Data
          </h4><a class="self-link" href="#encrypt-or-obfuscate-persistent-data" aria-label="Permalink for Section 8.3.3"></a></div>
          
          <p>
            User agents <em class="rfc2119">SHOULD</em> treat Persistent Data as potentially sensitive; it is quite possible
            for user privacy to be compromised by the release of this information. To this end,
            user agents <em class="rfc2119">SHOULD</em> ensure that Persistent Data is securely stored and when deleting
            data, it is promptly deleted from the underlying storage.
          </p>
        </section>
      </section>
      <section id="exposed-value-requirements"><div class="header-wrapper"><h3 id="x8-4-values-exposed-to-the-application"><bdi class="secno">8.4 </bdi>
          Values Exposed to the Application
        </h3><a class="self-link" href="#exposed-value-requirements" aria-label="Permalink for Section 8.4"></a></div>
        
        <p>
          Values exposed to or inferable by, such as via its use by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-102">CDM</a>, the application
          could be used to identify the client or user, regardless of whether they are designed to
          be identifiers. This section defines requirements for avoiding or at least mitigating
          such concerns. There are additional requirements for <a href="#identifier-requirements">Identifiers</a>.
        </p>
        <section id="per-origin-per-profile-values"><div class="header-wrapper"><h4 id="x8-4-1-use-per-origin-per-profile-values"><bdi class="secno">8.4.1 </bdi>
            Use Per-Origin Per-Profile Values
          </h4><a class="self-link" href="#per-origin-per-profile-values" aria-label="Permalink for Section 8.4.1"></a></div>
          
          <p>
            All <a data-link-type="dfn|abstract-op" href="#dfn-distinctive" class="internalDFN" id="ref-for-dfn-distinctive-3">Distinctive Values</a> exposed to or inferable by the application <em class="rfc2119">MUST</em> be unique
            per <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-6">browsing profile</a>. That is, the value(s) used for one <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>
            using the APIs defined in this specification <em class="rfc2119">MUST</em> be different from those used for any
            other origin using the APIs, and value(s) used in one <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-7">browsing profile</a> <em class="rfc2119">MUST</em> be
            different from those used for any other profile, regardless of origin. Such values <em class="rfc2119">MUST NOT</em> leak to or from private browsing sessions.
          </p>
          <p>
            Values across origins and profiles <em class="rfc2119">MUST</em> be <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-3">non-associable by applications</a>, meaning
            it <em class="rfc2119">MUST NOT</em> be possible to correlate values from multiple origins or profiles, such as
            to determine that they came from the same client or user. Specifically, implementations
            that derive per-origin values from an origin-independent and/or profile-independent
            value, <em class="rfc2119">MUST</em> do so in a way that ensures the above non-associability property, such as
            by using derivation functions with appropriate non-reversible properties.
          </p>
        </section>
        <section id="allow-values-to-be-cleared"><div class="header-wrapper"><h4 id="x8-4-2-allow-values-to-be-cleared"><bdi class="secno">8.4.2 </bdi>
            Allow Values to Be Cleared
          </h4><a class="self-link" href="#allow-values-to-be-cleared" aria-label="Permalink for Section 8.4.2"></a></div>
          
          <p>
            As a consequence of the requirements in <a href="#allow-persistent-data-cleared">Allow
            Persistent Data to Be Cleared</a>, all persisted values exposed to the application <em class="rfc2119">MUST</em>
            be clearable such that the values are no longer retrievable, observable, or inferable
            both outside, such as via the APIs defined in this specification, and on the client
            device.
          </p>
          <p>
            Once cleared, new <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-4">non-associable by applications</a> value(s) <em class="rfc2119">MUST</em> be generated when
            values are subsequently needed.
          </p>
        </section>
      </section>
      <section id="identifier-requirements"><div class="header-wrapper"><h3 id="x8-5-identifiers"><bdi class="secno">8.5 </bdi>
          Identifiers
        </h3><a class="self-link" href="#identifier-requirements" aria-label="Permalink for Section 8.5"></a></div>
        
        <p>
          The use of identifiers, especially <a data-link-type="dfn|abstract-op" data-lt="uses Distinctive Identifier(s) or Distinctive Permanent Identifier(s)" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-5">Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a>, by implementations presents a privacy concern. This section defines
          requirements for avoiding or at least mitigating such concerns. The requirements for
          <a href="#exposed-value-requirements">Values Exposed to the Application</a> also apply to
          identifiers exposed to the application.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-125"><div role="heading" class="note-title marker" id="h-note-125" aria-level="4"><span>Note</span></div><div class="">
          <p>
            In summary:
          </p>
          <ul>
            <li>
              <p>
                <a href="#limit-or-avoid-use-of-distinctive-identifiers-and-permanent-identifiers">Limit or
                Avoid use of Distinctive Identifiers and Permanent Identifiers</a>.
              </p>
            </li>
            <li>
              <p>
                All identifers except <a data-link-type="dfn|abstract-op" href="#dfn-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-permanent-identifier-s-2">Permanent Identifiers</a> <em class="rfc2119">MUST</em> be <a href="#per-origin-per-profile-identifiers">unique per origin and profile</a>, <a href="#non-associable-identifiers">non-associable</a>, and <a href="#allow-identifiers-cleared">clearable</a>.
              </p>
            </li>
            <li>
              <p>
                All identifers <em class="rfc2119">SHOULD</em> be <a href="#encrypt-identifiers">encrypted</a> when exposed
                outside the client.
              </p>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-15">Distinctive Identifiers</a> <em class="rfc2119">MUST</em> be <a href="#encrypt-identifiers">encrypted</a>
                when exposed outside the client, <a href="#per-origin-per-profile-identifiers">unique per origin and profile</a>, and
                <a href="#allow-identifiers-cleared">clearable</a>.
              </p>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-20">Distinctive Permanent Identifiers</a> <em class="rfc2119">MUST</em> be <a href="#encrypt-identifiers">encrypted</a> when exposed outside the client and <em class="rfc2119">MUST NOT</em>
                be exposed to the application.
              </p>
            </li>
            <li>
              <p>
                All potential identifiers or <a data-link-type="dfn|abstract-op" href="#dfn-distinctive" class="internalDFN" id="ref-for-dfn-distinctive-4">Distinctive Values</a> not covered above that are
                generated as a result of use of the APIs defined in this specification <em class="rfc2119">MUST</em> be
                <a href="#per-origin-per-profile-identifiers">unique per origin and profile</a> and
                <a href="#allow-identifiers-cleared">clearable</a>. This includes but is not
                limited to random identifiers, session data, and other <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-103">CDM</a> data.
              </p>
            </li>
          </ul>
        </div></div>
        <section id="limit-or-avoid-use-of-distinctive-identifiers-and-permanent-identifiers"><div class="header-wrapper"><h4 id="x8-5-1-limit-or-avoid-use-of-distinctive-identifiers-and-permanent-identifiers"><bdi class="secno">8.5.1 </bdi>
            Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers
          </h4><a class="self-link" href="#limit-or-avoid-use-of-distinctive-identifiers-and-permanent-identifiers" aria-label="Permalink for Section 8.5.1"></a></div>
          
          <ul>
            <li>
              <p>
                Implementations <em class="rfc2119">SHOULD</em> avoid <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-6">use of Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-126"><div role="heading" class="note-title marker" id="h-note-126" aria-level="5"><span>Note</span></div><p class="">
                For example, use identifiers or other values that apply to a group of clients or
                devices rather than individual clients.
              </p></div>
            </li>
            <li>
              <p>
                Implementations <em class="rfc2119">SHOULD</em> only <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-7">use Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a> when necessary to enforce the policies related to the
                specific <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-104">CDM</a> instance and session.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-127"><div role="heading" class="note-title marker" id="h-note-127" aria-level="5"><span>Note</span></div><p class="">
                For example, "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-12"><code>temporary</code></a>" and
                "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-7"><code>persistent-license</code></a>" sessions may have different
                requirements.
              </p></div>
            </li>
            <li>
              <p>
                Implementations that <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-8">use Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a> <em class="rfc2119">SHOULD</em> support the option to not use them. Implementations with
                such support <em class="rfc2119">SHOULD</em> expose the ability for the user to select this option.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-128"><div role="heading" class="note-title marker" id="h-note-128" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  When supported, applications can select for this mode using
                  <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-23"><code>distinctiveIdentifier</code></a> =
                  "<a data-link-type="idl" href="#dom-mediakeysrequirement-not-allowed" class="internalDFN" id="ref-for-dom-mediakeysrequirement-not-allowed-14"><code>not-allowed</code></a>". Selecting such an option may affect the
                  results of the <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-12"><code>requestMediaKeySystemAccess</code></a><code>()</code> call and/or the
                  license requests that are generated from subsequently generated sessions.
                </p>
                <p>
                  Providing the user access to select or choose this implementation capability may
                  allow the user to access content while maintaining a higher degree of privacy.
                </p>
              </div></div>
            </li>
          </ul>
        </section>
        <section id="encrypt-identifiers"><div class="header-wrapper"><h4 id="x8-5-2-encrypt-identifiers"><bdi class="secno">8.5.2 </bdi>
            Encrypt Identifiers
          </h4><a class="self-link" href="#encrypt-identifiers" aria-label="Permalink for Section 8.5.2"></a></div>
          
          <p>
            <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-16">Distinctive Identifiers</a> and <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-21">Distinctive Permanent Identifiers</a> <em class="rfc2119">MUST</em> be encrypted
            at the message exchange level when exposed outside the client. All other identifiers
            <em class="rfc2119">SHOULD</em> be encrypted at the message exchange level when exposed outside the client. The
            encryption <em class="rfc2119">MUST</em> ensure that any two instances of the identifier ciphertext are
            <a data-link-type="dfn|abstract-op" data-lt="associable by an entity" href="#dfn-associable-by-an-entity" class="internalDFN" id="ref-for-dfn-associable-by-an-entity-5">associable</a> only by an entity in possession of the
            decryption key.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-129"><div role="heading" class="note-title marker" id="h-note-129" aria-level="5"><span>Note</span></div><div class="">
            <p>
              Identifiers may be exposed in the following ways:
            </p>
            <ul>
              <li>
                <p>
                  To the application via a <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-7"><code><code>message</code></code></a> event.
                </p>
              </li>
              <li>
                <p>
                  In a message from a server, such as one that is passed to
                  <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-13"><code>update</code></a><code>()</code>.
                </p>
              </li>
              <li>
                <p>
                  As part of <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-12">individualization</a>.
                </p>
              </li>
            </ul>
          </div></div>
          <p>
            The <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-105">CDM</a> <em class="rfc2119">MUST</em> verify that the encryption key belongs to a valid server for its <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-37">Key System</a>. For identifers exposed to the application, this <em class="rfc2119">MAY</em> be implemented using a
            <a href="#server-certificate">server certificate</a>.
          </p>
          <p>
            The server <em class="rfc2119">MUST NOT</em> expose a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-17">Distinctive Identifier</a> to any entity other than the
            <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-106">CDM</a> that sent it.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-130"><div role="heading" class="note-title marker" id="h-note-130" aria-level="5"><span>Note</span></div><p class="">
            Specifically, it should not be provided to the application or included unencrypted in
            messages to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-107">CDM</a>. This can be accomplished by encrypting the identifier or
            message with the identifier or such that it is only decryptable by that specific
            <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-108">CDM</a>.
          </p></div>
          <div class="note" role="note" id="issue-container-generatedID-131"><div role="heading" class="note-title marker" id="h-note-131" aria-level="5"><span>Note</span></div><div class="">
            <p>
              Among other things, this means that:
            </p>
            <ul>
              <li>
                <p>
                  Every signature made with device-specific or user-specific keys <em class="rfc2119">MUST</em> be
                  different, even given the same plaintext.
                </p>
              </li>
              <li>
                <p>
                  Identifiers, keys, or certificates relating to device-specific or user-specific
                  keys <em class="rfc2119">MUST</em> be encrypted for the license or <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-13">individualization</a> server.
                </p>
              </li>
              <li>
                <p>
                  Messages from the license server to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-109">CDM</a> <em class="rfc2119">MUST NOT</em> expose recipient-unique
                  identifiers, such as the ID of the intended decryption key, on the outside of the
                  encryption envelope.
                </p>
              </li>
            </ul>
          </div></div>
        </section>
        <section id="per-origin-per-profile-identifiers"><div class="header-wrapper"><h4 id="x8-5-3-use-per-origin-per-profile-identifiers"><bdi class="secno">8.5.3 </bdi>
            Use Per-Origin Per-Profile Identifiers
          </h4><a class="self-link" href="#per-origin-per-profile-identifiers" aria-label="Permalink for Section 8.5.3"></a></div>
          
          <p>
            All identifiers except <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-22">Distinctive Permanent Identifiers</a> <em class="rfc2119">MUST</em> be unique per
            <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-8">browsing profile</a>. See <a href="#per-origin-per-profile-values" class="sec-ref"><bdi class="secno">8.4.1 </bdi>
            Use Per-Origin Per-Profile Values</a>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-132"><div role="heading" class="note-title marker" id="h-note-132" aria-level="5"><span>Note</span></div><div class="">
            <p>
              This includes but is not limited to <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-18">Distinctive Identifiers</a>.
            </p>
            <p>
              <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-23">Distinctive Permanent Identifiers</a> <em class="rfc2119">MUST NOT</em> be exposed to the application or
              origin.
            </p>
          </div></div>
        </section>
        <section id="non-associable-identifiers"><div class="header-wrapper"><h4 id="x8-5-4-use-non-associable-identifiers"><bdi class="secno">8.5.4 </bdi>
            Use Non-Associable Identifiers
          </h4><a class="self-link" href="#non-associable-identifiers" aria-label="Permalink for Section 8.5.4"></a></div>
          
          <p>
            All identifiers, including <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-19">Distinctive Identifiers</a>, exposed by the implementation
            to applications, even in encrypted form, <em class="rfc2119">MUST</em> be <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-5">non-associable by application</a>(s)
            across <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origins</a>, <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-9">browsing profiles</a>, and <a href="#allow-identifiers-cleared">clearing of identifiers</a>.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-133"><div role="heading" class="note-title marker" id="h-note-133" aria-level="5"><span>Note</span></div><p class="">
            For all such identifiers, it <em class="rfc2119">MUST NOT</em> be possible for one or more applications,
            including related license or other servers to achieve such correlation or association.
          </p></div>
        </section>
        <section id="allow-identifiers-cleared"><div class="header-wrapper"><h4 id="x8-5-5-allow-identifiers-to-be-cleared"><bdi class="secno">8.5.5 </bdi>
            Allow Identifiers to Be Cleared
          </h4><a class="self-link" href="#allow-identifiers-cleared" aria-label="Permalink for Section 8.5.5"></a></div>
          
          <p>
            As a consequence of the requirements in <a href="#allow-persistent-data-cleared">Allow
            Persistent Data to Be Cleared</a>, all potential identifiers or <a data-link-type="dfn|abstract-op" href="#dfn-distinctive" class="internalDFN" id="ref-for-dfn-distinctive-5">Distinctive Values</a>
            except <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-24">Distinctive Permanent Identifiers</a> <em class="rfc2119">MUST</em> be clearable such that the values are
            no longer retrievable, observable, or inferable both outside, such as via the APIs
            defined in this specification, and on the client device.
          </p>
          <p>
            Implementations that <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-3">use Distinctive Identifier(s)</a> <em class="rfc2119">MUST</em> allow the user to clear the
            <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-20">Distinctive Identifier(s)</a>. Implementations that <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-permanent-identifier-s-2">use Distinctive Permanent Identifier(s)</a> <em class="rfc2119">MUST</em> allow the user to clear values associated with the <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-25">Distinctive Permanent Identifier(s)</a>.
          </p>
          <p>
            Once cleared, new <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-6">non-associable by applications</a> value(s) <em class="rfc2119">MUST</em> be generated when
            values, such as <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-21">Distinctive Identifiers</a>, are subsequently needed.
          </p>
        </section>
      </section>
      <section id="individualization"><div class="header-wrapper"><h3 id="x8-6-individualization"><bdi class="secno">8.6 </bdi>
          <dfn id="dfn-individualization" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Individualization</dfn>
        </h3><a class="self-link" href="#individualization" aria-label="Permalink for Section 8.6"></a></div>
        
        <p>
          Identifiers, especially <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-22">Distinctive Identifiers</a>, are sometimes generated or obtained
          via a process called individualization or provisioning. The resulting identifier(s) <em class="rfc2119">MUST</em>
          be <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-7">non-associable by applications</a> and <a data-link-type="dfn|abstract-op" data-lt="use of Distinctive Identifier(s)" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-4">use of them</a> <em class="rfc2119">MUST</em> only be exposed to a <a href="#per-origin-per-profile-identifiers">single
          origin from a single profile</a>. This process <em class="rfc2119">MAY</em> be performed multiple times, such as
          after identifier(s) are <a href="#allow-identifiers-cleared">cleared</a>.
        </p>
        <p>
          This process <em class="rfc2119">MUST</em> be performed either <a data-link-type="dfn|abstract-op" data-lt="direct individualization" href="#dfn-direct-individualization" class="internalDFN" id="ref-for-dfn-direct-individualization-1">directly by the user agent</a> or <a data-link-type="dfn|abstract-op" data-lt="app-assisted individualization" href="#dfn-app-assisted-individualization" class="internalDFN" id="ref-for-dfn-app-assisted-individualization-2">through the application</a>. The mechanisms,
          flow, and restrictions for the two types of individualization are different, as described
          in the following sections. Which method is used depends on the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-110">CDM</a> implementation and
          application of the requirements of this specification, especially those below.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-134"><div role="heading" class="note-title marker" id="h-note-134" aria-level="4"><span>Note</span></div><p class="">
          <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-24"><code>distinctiveIdentifier</code></a> controls whether <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-23">Distinctive Identifiers</a> and <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-26">Distinctive Permanent Identifiers</a> may be <a data-link-type="dfn|abstract-op" data-lt="use Distinctive Identifier(s) or Distinctive Permanent Identifier(s)" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-9">used</a>, including for
          individualization. Specifically, such identifiers may only be <a data-link-type="dfn|abstract-op" data-lt="use Distinctive Identifier(s) or Distinctive Permanent Identifier(s)" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-10">used</a> when the value of the
          <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-25"><code>distinctiveIdentifier</code></a> member of the
          <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-16"><code>MediaKeySystemAccess</code></a> used to create the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-39"><code>MediaKeys</code></a> object is
          "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-18"><code>required</code></a>".
        </p></div>
        <section id="direct-individualization"><div class="header-wrapper"><h4 id="x8-6-1-direct-individualization"><bdi class="secno">8.6.1 </bdi>
            <dfn id="dfn-direct-individualization" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Direct Individualization</dfn>
          </h4><a class="self-link" href="#direct-individualization" aria-label="Permalink for Section 8.6.1"></a></div>
          
          <p>
            Direct Individualization is performed between the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-111">CDM</a> and an origin- and
            application-independent server. Although the server is origin-independent, the result
            of the individualization enables the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-112">CDM</a> to provide origin-specific identifiers per
            the other requirements of this specification. The process <em class="rfc2119">MUST</em> be performed by the user
            agent and <em class="rfc2119">MUST NOT</em> use the APIs defined in this specification.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-135"><div role="heading" class="note-title marker" id="h-note-135" aria-level="5"><span>Note</span></div><p class="">
            For example, such a process may initialize a client device and/or obtain a <a href="#per-origin-per-profile-identifiers">per-origin</a> <a href="#allow-identifiers-cleared">clearable</a> identifier for <a href="#per-origin-per-profile-identifiers">a single browsing profile</a> by communicating
            with a pre-determined server hosted by the user agent or CDM vendor, possibly <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-permanent-identifier-s-3">using Distinctive Permanent Identifier(s)</a> or other <a data-link-type="dfn|abstract-op" href="#dfn-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-permanent-identifier-s-3">Permanent Identifier(s)</a> from the
            client device.
          </p></div>
          <p>
            For such individualization, all message exchanges:
          </p>
          <ul>
            <li>
              <p>
                <em class="rfc2119">MUST</em> be handled by the user agent and performed by the user agent via the user
                agent's network stack.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST NOT</em> be performed directly by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-113">CDM</a>.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST NOT</em> be passed to or through the application via the APIs defined in this
                specification.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST</em> be sent to a URL selected independently of any origin and application.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST</em> encrypt all <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-24">Distinctive Identifiers</a> and <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-27">Distinctive Permanent Identifiers</a>.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST</em> use TLS.
              </p>
            </li>
          </ul>
          <p>
            Implementations <em class="rfc2119">MUST NOT</em> expose, even in encrypted form, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>(s), origin- or
            application-specific information, or values that are <a data-link-type="dfn|abstract-op" href="#dfn-associable" class="internalDFN" id="ref-for-dfn-associable-2">associable</a> with origin(s) to
            centralized servers since this could create a central record of all origins visited by
            a user or device.
          </p>
        </section>
        <section id="app-assisted-individualization"><div class="header-wrapper"><h4 id="x8-6-2-app-assisted-individualization"><bdi class="secno">8.6.2 </bdi>
            <dfn id="dfn-app-assisted-individualization" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">App-Assisted Individualization</dfn>
          </h4><a class="self-link" href="#app-assisted-individualization" aria-label="Permalink for Section 8.6.2"></a></div>
          
          <p>
            App-Assisted Individualization is performed between the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-114">CDM</a> and the application,
            including an application-selected server, and results in a per-origin identifier. The
            process <em class="rfc2119">MUST</em> be performed via the APIs defined in this specification and <em class="rfc2119">MUST NOT</em>
            involve other methods of communication. As with all other uses of the APIs, the process
            <em class="rfc2119">MAY</em> <a data-link-type="dfn|abstract-op" data-lt="use Distinctive Identifier(s)" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-5">use one or more Distinctive Identifier(s)</a>, but it
            <em class="rfc2119">MUST NOT</em> <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-permanent-identifier-s-4">use Distinctive Permanent Identifier(s)</a> or non-origin-specific values,
            even in encrypted form. If the process <a data-link-type="dfn|abstract-op" data-lt="uses Distinctive Identifier(s)" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-6">uses one or more Distinctive Identifier(s)</a>, the resulting identifier is by definition also a
            <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-25">Distinctive Identifier</a>.
          </p>
          <p>
            For such individualization, all message exchanges:
          </p>
          <ul>
            <li>
              <p>
                <em class="rfc2119">MUST</em> be passed to or through the application via the APIs defined in this
                specification.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">SHALL</em> use the message type "<a data-link-type="idl" href="#dom-mediakeymessagetype-individualization-request" class="internalDFN" id="ref-for-dom-mediakeymessagetype-individualization-request-4"><code>individualization-request</code></a>" for
                all related <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-8"><code><code>message</code></code></a> events.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST NOT</em> be performed by the user agent.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST NOT</em> be performed directly by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-115">CDM</a>.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST NOT</em> contain or otherwise <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-permanent-identifier-s-5">use Distinctive Permanent Identifier(s)</a>.
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST NOT</em> contain non-origin-specific per-client information
              </p>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST</em> adhere to the <a href="#identifier-requirements">identifier requirements</a>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-136"><div role="heading" class="note-title marker" id="h-note-136" aria-level="5"><span>Note</span></div><p class="">
                This includes only using values that are <a href="#per-origin-per-profile-identifiers">unique per origin and profile</a> and
                <a href="#allow-identifiers-cleared">clearable</a> and <a href="#encrypt-identifiers">encrypting</a> them as required.
              </p></div>
            </li>
            <li>
              <p>
                <em class="rfc2119">MUST NOT</em> provide executable code to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-116">CDM</a>.
              </p>
            </li>
          </ul>
          <p>
            When <a data-link-type="dfn|abstract-op" href="#dfn-associable" class="internalDFN" id="ref-for-dfn-associable-3">associable</a> values, including <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-26">Distinctive Identifier(s)</a>, are <a data-link-type="dfn|abstract-op" data-lt="uses Distinctive Identifier(s)" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-7">used</a> in the process, implementations <em class="rfc2119">MUST NOT</em> expose, even
            in encrypted form, <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>(s)-, origin- or application-specific information, or
            values that are <a data-link-type="dfn|abstract-op" href="#dfn-associable" class="internalDFN" id="ref-for-dfn-associable-4">associable</a> with origin(s) to centralized servers since this could
            create a central record of all origins visited by a user or device.
          </p>
          <p>
            With appropriate precautions, such individualization can provide better privacy than
            <a data-link-type="dfn|abstract-op" href="#dfn-direct-individualization" class="internalDFN" id="ref-for-dfn-direct-individualization-2">Direct Individualization</a>, though not as good as models that do not <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-8">use Distinctive Identifier(s)</a>. To preserve the benefits of such a design and to avoid
            introducing other privacy concerns, such implementations and the applications that
            support them <em class="rfc2119">SHOULD</em> avoid deferring or forwarding individualization messages to a
            central server or other server not controlled by the application author.
          </p>
        </section>
      </section>
      <section id="support-multiple-keys"><div class="header-wrapper"><h3 id="x8-7-support-multiple-keys"><bdi class="secno">8.7 </bdi>
          Support Multiple Keys
        </h3><a class="self-link" href="#support-multiple-keys" aria-label="Permalink for Section 8.7"></a></div>
        
        <p>
          Implementations <em class="rfc2119">MUST</em> support multiple keys in each <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-43"><code>MediaKeySession</code></a> object.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-137"><div role="heading" class="note-title marker" id="h-note-137" aria-level="4"><span>Note</span></div><p class="">
          The mechanics of how multiple keys are supported is an implementation detail, but it <em class="rfc2119">MUST</em>
          be transparent to the application and the APIs defined in this specification.
        </p></div>
        <p>
          Implementations <em class="rfc2119">MUST</em> support seamless switching between keys during playback. This
          includes both keys in the same <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-44"><code>MediaKeySession</code></a> and keys in separate
          <a data-link-type="idl" data-lt="MediaKeySession" href="#dom-mediakeysession" class="internalDFN" id="ref-for-dom-mediakeysession-45"><code>MediaKeySession</code></a> objects.
        </p>
      </section>
      <section id="initialization-data-type-support-requirements"><div class="header-wrapper"><h3 id="x8-8-initialization-data-type-support"><bdi class="secno">8.8 </bdi>
          Initialization Data Type Support
        </h3><a class="self-link" href="#initialization-data-type-support-requirements" aria-label="Permalink for Section 8.8"></a></div>
        
        <section id="licenses-generated-are-independent-of-content-type"><div class="header-wrapper"><h4 id="x8-8-1-licenses-generated-are-independent-of-content-type"><bdi class="secno">8.8.1 </bdi>
            Licenses Generated are Independent of Content Type
          </h4><a class="self-link" href="#licenses-generated-are-independent-of-content-type" aria-label="Permalink for Section 8.8.1"></a></div>
          
          <p>
            Implementations <em class="rfc2119">SHOULD</em> allow licenses generated with any <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-9">Initialization Data Type</a>
            they support to be used with any content type.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-138"><div role="heading" class="note-title marker" id="h-note-138" aria-level="5"><span>Note</span></div><p class="">
            Otherwise, the <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-13"><code>requestMediaKeySystemAccess</code></a><code>()</code> algorithm might, for
            example, reject a <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-11"><code>MediaKeySystemConfiguration</code></a> because one of the
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-initdatatypes" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-initdatatypes-5"><code>initDataTypes</code></a> is not supported with one of the
            <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-videocapabilities" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-videocapabilities-9"><code>videoCapabilities</code></a>.
          </p></div>
        </section>
        <section id="support-extraction-from-media-data"><div class="header-wrapper"><h4 id="x8-8-2-support-extraction-from-media-data"><bdi class="secno">8.8.2 </bdi>
            Support Extraction From Media Data
          </h4><a class="self-link" href="#support-extraction-from-media-data" aria-label="Permalink for Section 8.8.2"></a></div>
          
          <p>
            For any supported <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-10">Initialization Data Type</a> that may appear in a supported
            container, the user agents <em class="rfc2119">MUST</em> support <a href="#initdata-encountered">extracting</a>
            that type of <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-19">Initialization Data</a> from each such supported container.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-139"><div role="heading" class="note-title marker" id="h-note-139" aria-level="5"><span>Note</span></div><p class="">
            In other words, indicating support for an <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-type" class="internalDFN" id="ref-for-dfn-initialization-data-type-11">Initialization Data Type</a> implies both
            <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-117">CDM</a> support for generating license requests and, for container-specific types, user
            agent support for extracting it from the container. This does <strong>not</strong> mean
            that implementations must be able to parse <em>any</em> supported <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-20">Initialization Data</a> from <em>any</em> supported content type.
          </p></div>
        </section>
      </section>
      <section id="media-requirements"><div class="header-wrapper"><h3 id="x8-9-supported-media"><bdi class="secno">8.9 </bdi>
          Supported Media
        </h3><a class="self-link" href="#media-requirements" aria-label="Permalink for Section 8.9"></a></div>
        
        <p>
          This section defines properties of content (<a href="https://html.spec.whatwg.org/multipage/#media-resource">media
          resource</a>) supported by implementations of this specification.
        </p>
        <section id="unencrypted-container"><div class="header-wrapper"><h4 id="x8-9-1-unencrypted-container"><bdi class="secno">8.9.1 </bdi>
            Unencrypted Container
          </h4><a class="self-link" href="#unencrypted-container" aria-label="Permalink for Section 8.9.1"></a></div>
          
          <p>
            The media container <em class="rfc2119">MUST NOT</em> be encrypted. This specification relies on the user
            agent's ability to parse the media container without having to decrypt any of the media
            data. This includes the <a data-link-type="dfn|abstract-op" href="#dfn-encrypted-block-encountered" class="internalDFN" id="ref-for-dfn-encrypted-block-encountered-2">Encrypted Block Encountered</a> and <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data-encountered" class="internalDFN" id="ref-for-dfn-initialization-data-encountered-3">Initialization Data Encountered</a> algorithms as well as supporting standard <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-28"><code>HTMLMediaElement</code></a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>]
            functionality, such as <a href="https://html.spec.whatwg.org/multipage/#seeking">seeking</a>.
          </p>
        </section>
        <section id="interoperably-encrypted"><div class="header-wrapper"><h4 id="x8-9-2-interoperably-encrypted"><bdi class="secno">8.9.2 </bdi>
            Interoperably Encrypted
          </h4><a class="self-link" href="#interoperably-encrypted" aria-label="Permalink for Section 8.9.2"></a></div>
          
          <p>
            <a href="https://html.spec.whatwg.org/multipage/#media-resource">Media resources</a>, including all tracks, <em class="rfc2119">MUST</em> be
            encrypted and packaged per a container-specific "common encryption" specification that
            allows the content to be decrypted in a fully specified and compatible way when a key
            or keys are provided.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-140"><div role="heading" class="note-title marker" id="h-note-140" aria-level="5"><span>Note</span></div><p class="">
            The <cite><a data-matched-text="[[[EME-STREAM-REGISTRY]]]" href="https://www.w3.org/TR/eme-stream-registry/">Encrypted Media Extensions Stream Format Registry</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-eme-stream-registry" title="Encrypted Media Extensions Stream Format Registry">EME-STREAM-REGISTRY</a></cite>] provides references to such
            stream formats.
          </p></div>
        </section>
        <section id="unencrypted-in-band-support-content"><div class="header-wrapper"><h4 id="x8-9-3-unencrypted-in-band-support-content"><bdi class="secno">8.9.3 </bdi>
            Unencrypted In-band Support Content
          </h4><a class="self-link" href="#unencrypted-in-band-support-content" aria-label="Permalink for Section 8.9.3"></a></div>
          
          <p>
            In-band support content, such as captions, described audio, and transcripts, <em class="rfc2119">SHOULD NOT</em>
            be encrypted.
          </p>
          <div class="note" role="note" id="issue-container-generatedID-141"><div role="heading" class="note-title marker" id="h-note-141" aria-level="5"><span>Note</span></div><p class="">
            Decryption of such tracks - especially such that they can be provided back the user
            agent - is not generally supported by implementations. Thus, encrypting such tracks
            would prevent them from being widely available for use with accessibility features in
            user agent implementations.
          </p></div>
          <p>
            To ensure accessibility information is available in usable form, for implementations
            that choose to support encrypted in-band support content: a) the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-118">CDM</a> <em class="rfc2119">MUST</em> provide
            the decrypted data to the user agent and b) the user agent <em class="rfc2119">MUST</em> process it in the same
            way as equivalent unencrypted support content. For example, to be exposed as
            <a href="https://html.spec.whatwg.org/multipage/#timed-text-tracks">timed text tracks</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>].
          </p>
        </section>
      </section>
    </section>
    <section id="common-key-systems"><div class="header-wrapper"><h2 id="x9-common-key-systems"><bdi class="secno">9. </bdi>
        <dfn id="dfn-common-key-systems" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Common Key Systems</dfn>
      </h2><a class="self-link" href="#common-key-systems" aria-label="Permalink for Section 9."></a></div>
      
      <p>
        All user agents <em class="rfc2119">MUST</em> support the common <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-38">Key Systems</a> described in this section.
      </p>
      <div class="note" role="note" id="issue-container-generatedID-142"><div role="heading" class="note-title marker" id="h-note-142" aria-level="3"><span>Note</span></div><p class="">
        This ensures that there is a common baseline level of functionality that is guaranteed to
        be supported in all user agents, including those that are entirely open source. Thus,
        content providers that need only basic decryption can build simple applications that will
        work on all platforms without needing to work with any content protection providers.
      </p></div>
      <section id="clear-key"><div class="header-wrapper"><h3 id="x9-1-clear-key"><bdi class="secno">9.1 </bdi>
          <dfn id="dfn-clear-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Clear Key</dfn>
        </h3><a class="self-link" href="#clear-key" aria-label="Permalink for Section 9.1"></a></div>
        
        <p>
          The <code>"org.w3.clearkey"</code> <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-39">Key System</a> uses plain-text clear (unencrypted)
          key(s) to decrypt the source. No additional client-side content protection is required.
          This <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-40">Key System</a> is described below.
        </p>
        <section id="clear-key-capabilities"><div class="header-wrapper"><h4 id="x9-1-1-capabilities"><bdi class="secno">9.1.1 </bdi>
            Capabilities
          </h4><a class="self-link" href="#clear-key-capabilities" aria-label="Permalink for Section 9.1.1"></a></div>
          
          <p>
            The following describe how <a data-link-type="dfn|abstract-op" href="#dfn-clear-key" class="internalDFN" id="ref-for-dfn-clear-key-2">Clear Key</a> supports <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-41">Key System</a>-specific capabilities:
          </p>
          <ul>
            <li>
              <p>
                <a data-link-type="idl" data-lt="MediaKeySystemConfiguration" href="#dom-mediakeysystemconfiguration" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-12"><code>MediaKeySystemConfiguration</code></a>:
              </p>
              <ol>
                <li>
                  <p>
                    <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-encryptionscheme" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-encryptionscheme-5"><code>encryptionScheme</code></a>: Implementations <em class="rfc2119">MUST</em>
                    support the <code><a data-link-type="dfn|abstract-op" href="#scheme-cenc" class="internalDFN" id="ref-for-scheme-cenc-1"><code>"cenc"</code></a></code> scheme, and <em class="rfc2119">MAY</em> support other schemes.
                  </p>
                </li>
                <li>
                  <p>
                    <a data-link-type="idl" href="#dom-mediakeysystemmediacapability-robustness" class="internalDFN" id="ref-for-dom-mediakeysystemmediacapability-robustness-4"><code>robustness</code></a>: Only the empty string is
                    supported.
                  </p>
                </li>
                <li>
                  <p>
                    <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-26"><code>distinctiveIdentifier</code></a>:
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-19"><code>required</code></a>" is not supported.
                  </p>
                </li>
                <li>
                  <p>
                    <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-12"><code>persistentState</code></a>: Not
                    "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-20"><code>required</code></a>" unless the application intends to create
                    non-"<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-13"><code>temporary</code></a>" sessions, if supported.
                  </p>
                </li>
              </ol>
            </li>
            <li>
              <p>
                The "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-8"><code>persistent-license</code></a>" <a data-link-type="idl" data-lt="MediaKeySessionType" href="#dom-mediakeysessiontype" class="internalDFN" id="ref-for-dom-mediakeysessiontype-6"><code>MediaKeySessionType</code></a>:
                Implementations <em class="rfc2119">MAY</em> support this type.
              </p>
            </li>
            <li>
              <p>
                The <a data-link-type="idl" data-lt="setServerCertificate()" href="#dom-mediakeys-setservercertificate" class="internalDFN" id="ref-for-dom-mediakeys-setservercertificate-2"><code>setServerCertificate</code></a><code>()</code> method: Not supported.
              </p>
            </li>
            <li>
              <p>
                The <a data-link-type="idl" data-lt="setMediaKeys()" href="#dom-htmlmediaelement-setmediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-setmediakeys-5"><code>setMediaKeys</code></a><code>()</code> method: Implementations <em class="rfc2119">MAY</em> support
                associating the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-40"><code>MediaKeys</code></a> object with more than one <a data-link-type="idl" data-lt="HTMLMediaElement" href="#dom-htmlmediaelement" class="internalDFN" id="ref-for-dom-htmlmediaelement-29"><code>HTMLMediaElement</code></a>.
              </p>
            </li>
          </ul>
        </section>
        <section id="clear-key-behavior"><div class="header-wrapper"><h4 id="x9-1-2-behavior"><bdi class="secno">9.1.2 </bdi>
            Behavior
          </h4><a class="self-link" href="#clear-key-behavior" aria-label="Permalink for Section 9.1.2"></a></div>
          
          <p>
            The following describe how <a data-link-type="dfn|abstract-op" href="#dfn-clear-key" class="internalDFN" id="ref-for-dfn-clear-key-3">Clear Key</a> implements <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-42">Key System</a>-specific behaviors:
          </p>
          <ul>
            <li>
              <p>
                In the <a data-link-type="idl" data-lt="generateRequest()" href="#dom-mediakeysession-generaterequest" class="internalDFN" id="ref-for-dom-mediakeysession-generaterequest-6"><code>generateRequest</code></a><code>()</code> algorithm:
              </p>
              <ul>
                <li>
                  <p>
                    The generated <var>message</var> is a JSON object encoded in UTF-8 as described
                    in <a href="#clear-key-request-format">License Request Format</a>.
                  </p>
                </li>
                <li>
                  <p>
                    The request is generated by extracting the key IDs from the <var>sanitized init
                    data</var>.
                  </p>
                </li>
                <li>
                  <p>
                    The "type" member value is the value of the <var>sessionType</var> parameter.
                  </p>
                </li>
              </ul>
            </li>
            <li>
              <p>
                The <a data-link-type="idl" href="#dom-mediakeysession-sessionid" class="internalDFN" id="ref-for-dom-mediakeysession-sessionid-8"><code>sessionId</code></a> attribute is a numerical value representable by a
                32-bit integer.
              </p>
            </li>
            <li>
              <p>
                The <a data-link-type="idl" href="#dom-mediakeysession-expiration" class="internalDFN" id="ref-for-dom-mediakeysession-expiration-5"><code>expiration</code></a> attribute is always <code>NaN</code>.
              </p>
            </li>
            <li>
              <p>
                In the <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-14"><code>update</code></a><code>()</code> algorithm:
              </p>
              <ul>
                <li>
                  <p>
                    The <var>response</var> parameter is either a JWK Set as described in <a href="#clear-key-license-format">License Format</a>, or a JSON object encoded in
                    UTF-8 as described in <a href="#clear-key-release-ack-format">License Release
                    Acknowledgement Format</a>.
                  </p>
                </li>
                <li>
                  <p>
                    In the first case, <var>sanitized response</var> is considered invalid if it is
                    not a valid JWK Set with at least one valid JWK key of a valid length for the
                    audio/video type. In the second case <var>sanitized response</var> is
                    considered invalid if it is not a valid JSON object.
                  </p>
                </li>
              </ul>
            </li>
            <li>
              <p>
                For sessions of type "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-9"><code>persistent-license</code></a>", in the
                <a data-link-type="idl" data-lt="remove()" href="#dom-mediakeysession-remove" class="internalDFN" id="ref-for-dom-mediakeysession-remove-4"><code>remove</code></a><code>()</code> algorithm, the <var>message</var> reflecting the
                <var>record of license destruction</var> is a JSON object encoded in UTF-8 as
                described in <a href="#clear-key-release-format">License Release Format</a>.
              </p>
            </li>
            <li>
              <p>
                The <a data-link-type="idl" href="#dom-mediakeysession-keystatuses" class="internalDFN" id="ref-for-dom-mediakeysession-keystatuses-5"><code>keyStatuses</code></a> attribute method initially contains all key IDs
                that have been provided via <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-15"><code>update</code></a><code>()</code>, with status
                "<a data-link-type="idl" href="#dom-mediakeystatus-usable" class="internalDFN" id="ref-for-dom-mediakeystatus-usable-3"><code>usable</code></a>". When the <a data-link-type="idl" data-lt="remove()" href="#dom-mediakeysession-remove" class="internalDFN" id="ref-for-dom-mediakeysession-remove-5"><code>remove</code></a><code>()</code> algorithm is
                executed, the <a data-link-type="idl" href="#dom-mediakeysession-keystatuses" class="internalDFN" id="ref-for-dom-mediakeysession-keystatuses-6"><code>keyStatuses</code></a> attribute will be set to an empty
                list.
              </p>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-21">Initialization Data</a>: Implementations <em class="rfc2119">MAY</em> support any combination of registered
                Initialization Data Types [<cite><a class="bibref" data-link-type="biblio" href="#bib-eme-initdata-registry" title="Encrypted Media Extensions Initialization Data Format Registry">EME-INITDATA-REGISTRY</a></cite>]. Implementations <em class="rfc2119">SHOULD</em> support
                the <code>"keyids"</code> type [<cite><a class="bibref" data-link-type="biblio" href="#bib-eme-initdata-keyids" title="&quot;keyids&quot; Initialization Data Format">EME-INITDATA-KEYIDS</a></cite>] and other types appropriate
                for content types supported by the user agent.
              </p>
            </li>
          </ul>
        </section>
        <section id="clear-key-request-format"><div class="header-wrapper"><h4 id="x9-1-3-license-request-format"><bdi class="secno">9.1.3 </bdi>
            License Request Format
          </h4><a class="self-link" href="#clear-key-request-format" aria-label="Permalink for Section 9.1.3"></a></div>
          
          <p>
            This section describes the format of the license request provided to the application
            via the message attribute of the <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-9"><code><code>message</code></code></a> event.
          </p>
          <p>
            The format is a JSON object containing the following members:
          </p>
          <dl>
            <dt>
              "kids"
            </dt>
            <dd>
              An array of <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-14">key IDs</a>. Each element of the array is the base64url encoding of the
              octet sequence containing the key ID value.
            </dd>
            <dt>
              "type"
            </dt>
            <dd>
              The requested <a data-link-type="idl" data-lt="MediaKeySessionType" href="#dom-mediakeysessiontype" class="internalDFN" id="ref-for-dom-mediakeysessiontype-7"><code>MediaKeySessionType</code></a>.
            </dd>
          </dl>
          <p>
            When contained in the ArrayBuffer <a data-link-type="idl" href="#dom-mediakeymessageevent-message" class="internalDFN" id="ref-for-dom-mediakeymessageevent-message-3"><code>message</code></a> attribute of a
            <a data-link-type="idl" data-lt="MediaKeyMessageEvent" href="#dom-mediakeymessageevent" class="internalDFN" id="ref-for-dom-mediakeymessageevent-5"><code>MediaKeyMessageEvent</code></a> object, the JSON string is encoded in UTF-8 as specified in
            the Encoding specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>]. Applications <em class="rfc2119">MAY</em> decode the contents of the
            ArrayBuffer to a JSON string using the <a data-link-type="idl" data-lt="TextDecoder" data-type="interface" href="https://encoding.spec.whatwg.org/#textdecoder"><code>TextDecoder</code></a> interface [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>].
          </p>
          <section id="clear-key-request-format-example" class="informative"><div class="header-wrapper"><h5 id="x9-1-3-1-example"><bdi class="secno">9.1.3.1 </bdi>
              Example
            </h5><a class="self-link" href="#clear-key-request-format-example" aria-label="Permalink for Section 9.1.3.1"></a></div><p><em>This section is non-normative.</em></p>
            
            <p>
              The following example is a license request for a temporary license for two key IDs.
              (Line breaks are for readability only.)
            </p>
            <div class="example" id="example-1">
        <div class="marker">
    <a class="self-link" href="#example-1">Example<bdi> 1</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"kids"</span>: [
    <span class="hljs-string">"LwVHf8JLtPrv2GUXFW2v_A"</span>,
    <span class="hljs-string">"0DdtU9od-Bh5L3xbv0Xf_A"</span>
  ],
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"temporary"</span>
}</code></pre>
      </div>
          </section>
        </section>
        <section id="clear-key-license-format"><div class="header-wrapper"><h4 id="x9-1-4-license-format"><bdi class="secno">9.1.4 </bdi>
            License Format
          </h4><a class="self-link" href="#clear-key-license-format" aria-label="Permalink for Section 9.1.4"></a></div>
          
          <p>
            This section describes the format of the license to be provided via the
            <var>response</var> parameter of the <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-16"><code>update</code></a><code>()</code> method.
          </p>
          <p>
            The format is a JSON Web Key (JWK) Set containing representation of the symmetric key
            to be used for decryption, as defined in the JSON Web Key (JWK) specification
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>].
          </p>
          <p>
            For each JWK in the set, the parameter values are as follows:
          </p>
          <dl>
            <dt>
              "kty" (key type)
            </dt>
            <dd>
              "oct" (octet sequence).
            </dd>
            <dt>
              "k" (key value)
            </dt>
            <dd>
              The base64url encoding of the octet sequence containing the symmetric <a data-link-type="dfn|abstract-op" href="#dfn-key-s" class="internalDFN" id="ref-for-dfn-key-s-6">key</a> value.
            </dd>
            <dt>
              "kid" (key ID)
            </dt>
            <dd>
              The base64url encoding of the octet sequence containing the <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-15">key ID</a> value.
            </dd>
          </dl>
          <p>
            The JSON object <em class="rfc2119">MAY</em> have an optional "type" member value, which <em class="rfc2119">MUST</em> be one of the
            <a data-link-type="idl" data-lt="MediaKeySessionType" href="#dom-mediakeysessiontype" class="internalDFN" id="ref-for-dom-mediakeysessiontype-8"><code>MediaKeySessionType</code></a> values. If not specified, the default value of
            "<a data-link-type="idl" href="#dom-mediakeysessiontype-temporary" class="internalDFN" id="ref-for-dom-mediakeysessiontype-temporary-14"><code>temporary</code></a>" is used. The <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-17"><code>update</code></a><code>()</code> algorithm
            compares this value to the <var>sessionType</var>.
          </p>
          <p>
            When passed to the <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-18"><code>update</code></a><code>()</code> method as the ArrayBuffer
            <var>response</var> parameter, the JSON string <em class="rfc2119">MUST</em> be encoded in UTF-8 as specified in
            the Encoding specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>]. Applications <em class="rfc2119">MAY</em> encode the JSON string using
            the <a data-link-type="idl" data-lt="TextEncoder" data-type="interface" href="https://encoding.spec.whatwg.org/#textencoder"><code>TextEncoder</code></a> interface [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>].
          </p>
          <section id="clear-key-license-format-example" class="informative"><div class="header-wrapper"><h5 id="x9-1-4-1-example"><bdi class="secno">9.1.4.1 </bdi>
              Example
            </h5><a class="self-link" href="#clear-key-license-format-example" aria-label="Permalink for Section 9.1.4.1"></a></div><p><em>This section is non-normative.</em></p>
            
            <p>
              The following example is a JWK Set containing a single symmetric key. (Line breaks
              are for readability only.)
            </p>
            <div class="example" id="example-2">
        <div class="marker">
    <a class="self-link" href="#example-2">Example<bdi> 2</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"keys"</span>: [{
    <span class="hljs-attr">"kty"</span>: <span class="hljs-string">"oct"</span>,
    <span class="hljs-attr">"k"</span>: <span class="hljs-string">"tQ0bJVWb6b0KPL6KtZIy_A"</span>,
    <span class="hljs-attr">"kid"</span>: <span class="hljs-string">"LwVHf8JLtPrv2GUXFW2v_A"</span>
  }],
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"temporary"</span>
}</code></pre>
      </div>
          </section>
        </section>
        <section id="clear-key-release-format"><div class="header-wrapper"><h4 id="x9-1-5-license-release-format"><bdi class="secno">9.1.5 </bdi>
            License Release Format
          </h4><a class="self-link" href="#clear-key-release-format" aria-label="Permalink for Section 9.1.5"></a></div>
          
          <p>
            This section describes the format of the license release message to be provided via the
            message attribute of the <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-10"><code><code>message</code></code></a> event.
          </p>
          <p>
            The format is a JSON object. For sessions of type
            "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-10"><code>persistent-license</code></a>", the object shall contain the following
            member:
          </p>
          <dl>
            <dt>
              "kids"
            </dt>
            <dd>
              An array of <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-16">key IDs</a>. Each element of the array is the base64url encoding of the
              octet sequence containing the key ID value.
            </dd>
          </dl>
          <p>
            When contained in the ArrayBuffer <a data-link-type="idl" href="#dom-mediakeymessageevent-message" class="internalDFN" id="ref-for-dom-mediakeymessageevent-message-4"><code>message</code></a> attribute of a
            <a data-link-type="idl" data-lt="MediaKeyMessageEvent" href="#dom-mediakeymessageevent" class="internalDFN" id="ref-for-dom-mediakeymessageevent-6"><code>MediaKeyMessageEvent</code></a> object, the JSON string is encoded in UTF-8 as specified in
            the Encoding specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>]. Applications <em class="rfc2119">MAY</em> decode the contents of the
            ArrayBuffer to a JSON string using the <a data-link-type="idl" data-lt="TextDecoder" data-type="interface" href="https://encoding.spec.whatwg.org/#textdecoder"><code>TextDecoder</code></a> interface [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>].
          </p>
          <section id="clear-key-release-format-example-1" class="informative"><div class="header-wrapper"><h5 id="x9-1-5-1-example-message-reflecting-a-record-of-license-destruction"><bdi class="secno">9.1.5.1 </bdi>
              Example message reflecting a <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-13">record of license destruction</a>
            </h5><a class="self-link" href="#clear-key-release-format-example-1" aria-label="Permalink for Section 9.1.5.1"></a></div><p><em>This section is non-normative.</em></p>
            
            <p>
              The following example is a license release for a
              "<a data-link-type="idl" href="#dom-mediakeysessiontype-persistent-license" class="internalDFN" id="ref-for-dom-mediakeysessiontype-persistent-license-11"><code>persistent-license</code></a>" session that contained two keys. (Line
              breaks are for readability only.)
            </p>
            <div class="example" id="example-3">
        <div class="marker">
    <a class="self-link" href="#example-3">Example<bdi> 3</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"kids"</span>: [ <span class="hljs-string">"LwVHf8JLtPrv2GUXFW2v_A"</span>, <span class="hljs-string">"0DdtU9od-Bh5L3xbv0Xf_A"</span> ]
}</code></pre>
      </div>
          </section>
        </section>
        <section id="clear-key-release-ack-format"><div class="header-wrapper"><h4 id="x9-1-6-license-release-acknowledgement-format"><bdi class="secno">9.1.6 </bdi>
            License Release Acknowledgement Format
          </h4><a class="self-link" href="#clear-key-release-ack-format" aria-label="Permalink for Section 9.1.6"></a></div>
          
          <p>
            This section describes the format of the license release acknowledgement provided via
            the <var>response</var> parameter of the <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-19"><code>update</code></a><code>()</code> method.
          </p>
          <p>
            The format is a JSON object containing the following members:
          </p>
          <dl>
            <dt>
              "kids"
            </dt>
            <dd>
              An array of <a data-link-type="dfn|abstract-op" href="#dfn-decryption-key-id" class="internalDFN" id="ref-for-dfn-decryption-key-id-17">key IDs</a>. Each element of the array is the base64url encoding of the
              octet sequence containing the key ID value.
            </dd>
          </dl>
          <p>
            When passed to the <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-20"><code>update</code></a><code>()</code> method as the ArrayBuffer
            <var>response</var> parameter, the JSON string <em class="rfc2119">MUST</em> be encoded in UTF-8 as specified in
            the Encoding specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>]. Applications <em class="rfc2119">MAY</em> encode the JSON string using
            the <a data-link-type="idl" data-lt="TextEncoder" data-type="interface" href="https://encoding.spec.whatwg.org/#textencoder"><code>TextEncoder</code></a> interface [<cite><a class="bibref" data-link-type="biblio" href="#bib-encoding" title="Encoding Standard">ENCODING</a></cite>].
          </p>
          <section id="clear-key-release-ack-format-example" class="informative"><div class="header-wrapper"><h5 id="x9-1-6-1-example"><bdi class="secno">9.1.6.1 </bdi>
              Example
            </h5><a class="self-link" href="#clear-key-release-ack-format-example" aria-label="Permalink for Section 9.1.6.1"></a></div><p><em>This section is non-normative.</em></p>
            
            <p>
              The following example is a license request for a temporary license for two key IDs.
              (Line breaks are for readability only.)
            </p>
            <div class="example" id="example-4">
        <div class="marker">
    <a class="self-link" href="#example-4">Example<bdi> 4</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"kids"</span>: [
    <span class="hljs-string">"LwVHf8JLtPrv2GUXFW2v_A"</span>,
    <span class="hljs-string">"0DdtU9od-Bh5L3xbv0Xf_A"</span>
  ]
}</code></pre>
      </div>
          </section>
        </section>
        <section id="using-base64url" class="informative"><div class="header-wrapper"><h4 id="x9-1-7-using-base64url"><bdi class="secno">9.1.7 </bdi>
            Using base64url
          </h4><a class="self-link" href="#using-base64url" aria-label="Permalink for Section 9.1.7"></a></div><p><em>This section is non-normative.</em></p>
          
          <p>
            For more information on base64url and working with it, see the "Base64url Encoding"
            terminology definition and "Notes on implementing base64url encoding without padding"
            in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7515" title="JSON Web Signature (JWS)">RFC7515</a></cite>]. Specifically, there is no '=' padding, and the characters '-' and '_'
            <em class="rfc2119">MUST</em> be used instead of '+' and '/', respectively.
          </p>
        </section>
      </section>
    </section>
    <section id="security"><div class="header-wrapper"><h2 id="x10-security"><bdi class="secno">10. </bdi>
        Security
      </h2><a class="self-link" href="#security" aria-label="Permalink for Section 10."></a></div>
      
      <section id="input-data-security"><div class="header-wrapper"><h3 id="x10-1-input-data-attacks-and-vulnerabilities"><bdi class="secno">10.1 </bdi>
          Input Data Attacks and Vulnerabilities
        </h3><a class="self-link" href="#input-data-security" aria-label="Permalink for Section 10.1"></a></div>
        
        <p>
          User Agent and <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-43">Key System</a> implementations <em class="rfc2119">MUST</em> consider <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a>, <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-22">Initialization Data</a>, data passed to <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-21"><code>update</code></a><code>()</code>, licenses,
          key data, and all other data provided by the application as untrusted content and
          potential attack vectors. They <em class="rfc2119">MUST</em> use appropriate safeguards to mitigate any associated
          threats and take care to safely parse, decrypt, etc. such data. User Agents <em class="rfc2119">SHOULD</em>
          validate data before passing it to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-119">CDM</a>.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-143"><div role="heading" class="note-title marker" id="h-note-143" aria-level="4"><span>Note</span></div><p class="">
          Such validation is especially important if the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-120">CDM</a> does not run in the same
          (sandboxed) context as, for example, the DOM.
        </p></div>
        <p>
          Implementations <em class="rfc2119">MUST NOT</em> return active content or passive content that affects program
          control flow to the application.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-144"><div role="heading" class="note-title marker" id="h-note-144" aria-level="4"><span>Note</span></div><p class="">
          For example, it is not safe to expose URLs or other information that may have come from
          media data, such as is the case for the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-23">Initialization Data</a> passed to
          <a data-link-type="idl" data-lt="generateRequest()" href="#dom-mediakeysession-generaterequest" class="internalDFN" id="ref-for-dom-mediakeysession-generaterequest-7"><code>generateRequest</code></a><code>()</code>. Applications must determine the URLs to use. The
          <a data-link-type="idl" href="#dom-mediakeymessageevent-messagetype" class="internalDFN" id="ref-for-dom-mediakeymessageevent-messagetype-3"><code>messageType</code></a> attribute of the <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-11"><code><code>message</code></code></a> event can be used by
          the application to select among a set of URLs if applicable.
        </p></div>
      </section>
      <section id="cdm-security"><div class="header-wrapper"><h3 id="x10-2-cdm-attacks-and-vulnerabilities"><bdi class="secno">10.2 </bdi>
          CDM Attacks and Vulnerabilities
        </h3><a class="self-link" href="#cdm-security" aria-label="Permalink for Section 10.2"></a></div>
        
        <p>
          User Agents are responsible for providing users with a secure way to browse the web. This
          responsibility applies to any functionality used by User Agents, including
          functionalities from third parties. User agent implementers <em class="rfc2119">MUST</em> obtain sufficient
          information from <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-44">Key System</a> implementers to enable them to properly assess the
          security implications of integrating with the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-45">Key System</a>. User agent implementers
          <em class="rfc2119">MUST</em> ensure <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-121">CDM</a> implementations provide and/or support sufficient controls for the
          user agent to provide security for the user. User agent implementers <em class="rfc2119">MUST</em> ensure <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-122">CDM</a>
          implementations can and will be quickly and proactively updated in the event of security
          vulnerabilities.
        </p>
        <p>
          Exploiting a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-123">CDM</a> implementation that is not fully sandboxed and/or uses platform
          features may allow an attacker to access OS or platform features, elevate privilege
          (e.g., to run as system or root), and/or access drivers, kernel, firmware, hardware, etc.
          Such features, software, and hardware may not be written to be robust against hostile
          software or web-based attacks and may not be updated with security fixes, especially
          compared to the user agent. Lack of, infrequent, or slow updates for fixes to security
          vulnerabilities in <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-124">CDM</a> implementations increases the risk. Such <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-125">CDM</a>
          implementations and UAs that expose them <em class="rfc2119">MUST</em> be especially careful in all areas of
          security, including parsing of <a href="#input-data-security">all data</a>.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-145"><div role="heading" class="note-title marker" id="h-note-145" aria-level="4"><span>Note</span></div><p class="">
          User agents should be especially diligent when using a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-126">CDM</a> or underlying mechanism
          that is part of or provided by the client OS, platform and/or hardware.
        </p></div>
        <p>
          If a user agent chooses to support a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-46">Key System</a> implementation that cannot be
          sufficiently sandboxed or otherwise secured, the user agent <em class="rfc2119">SHOULD</em> <a href="#security-consent">ensure that users are fully informed and/or give explicit consent</a>
          before loading or invoking it.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-146"><div role="heading" class="note-title marker" id="h-note-146" aria-level="4"><span>Note</span></div><p class="">
          Granting permissions to unauthenticated origins is equivalent to granting the permissions
          to any origin in the presence of a network attacker. See <a href="#persisted-consent-abuse">abuse of persisted consent</a>.
        </p></div>
      </section>
      <section id="network-attacks"><div class="header-wrapper"><h3 id="x10-3-network-attacks"><bdi class="secno">10.3 </bdi>
          Network Attacks
        </h3><a class="self-link" href="#network-attacks" aria-label="Permalink for Section 10.3"></a></div>
        
        <section class="informative" id="potential-attacks"><div class="header-wrapper"><h4 id="x10-3-1-potential-attacks"><bdi class="secno">10.3.1 </bdi>
            Potential Attacks
          </h4><a class="self-link" href="#potential-attacks" aria-label="Permalink for Section 10.3.1"></a></div><p><em>This section is non-normative.</em></p>
          
          <p>
            Potential network attacks and their implications include:
          </p>
          <ul>
            <li>
              <p>
                DNS spoofing attacks: One cannot guarantee that a host claiming to be in a certain
                domain (<a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>) really is from that domain.
              </p>
            </li>
            <li>
              <p>
                Passive network attacks: One cannot guarantee that data, including <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-27">Distinctive Identifiers</a> and <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-28">Distinctive Permanent Identifiers</a>, transmitted between the
                client and server is not viewed by other entities. See <a href="#user-tracking">User Tracking</a>.
              </p>
            </li>
            <li>
              <p>
                Active network attacks: One cannot guarantee that Additional scripts or iframes are
                not injected into pages (both those that use the APIs defined in this specification
                for legitimate purposes and pages that do not use them). The consequences are that:
              </p>
              <ul>
                <li>
                  <p>
                    Calls to the APIs defined in this specification can be injected into any page.
                  </p>
                </li>
                <li>
                  <p>
                    Calls to the APIs defined in this specification from pages using them for
                    legitimate reasons can be manipulated, including modifying the requested
                    functionality, modifying or adding calls, and modifying or injecting data. See
                    also <a href="#input-data-security">Input Data Attacks and Vulnerabilities</a>
                  </p>
                </li>
                <li>
                  <p>
                    Data, including <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-28">Distinctive Identifiers</a> and <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-29">Distinctive Permanent Identifiers</a>, transmitted between the client and server can be viewed and/or
                    modified by other entities. See <a href="#user-tracking">User Tracking</a>.
                  </p>
                </li>
              </ul>
            </li>
            <li>
              <p>
                <span id="persisted-consent-abuse">Abuse of persisted consent</span>: One cannot
                guarantee that the host requesting use of the APIs defined in this specification is
                the host to which the user previously provided consent. The consequences are that
                granting permissions to unauthenticated origins is equivalent to granting the
                permissions to any origin in the presence of a network attacker.
              </p>
            </li>
          </ul>
        </section>
        <section id="mitigations"><div class="header-wrapper"><h4 id="x10-3-2-mitigations"><bdi class="secno">10.3.2 </bdi>
            Mitigations
          </h4><a class="self-link" href="#mitigations" aria-label="Permalink for Section 10.3.2"></a></div>
          
          <p>
            The following techniques may mitigate the risks:
          </p>
          <dl>
            <dt>
              Use TLS
            </dt>
            <dd>
              <p>
                Applications using TLS can be sure that only the user, software working on behalf
                of the user, and other pages using TLS that have certificates identifying them as
                being from the same domain, can interact with that application. Furthermore,
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>-specific permissions in combination with a secure origin, ensure that
                permissions granted to an application cannot be abused by a network attacker.
              </p>
              <p>
                The APIs defined in this specification are only exposed on secure contexts. See
                also <a href="#privacy-secureorigin">Secure Origin and Transport</a>.
              </p>
            </dd>
            <dt>
              Block Mixed Content
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">MUST</em> properly handle Mixed Content [<cite><a class="bibref" data-link-type="biblio" href="#bib-mixed-content" title="Mixed Content">MIXED-CONTENT</a></cite>], including
                blocking "Blockable Content" [<cite><a class="bibref" data-link-type="biblio" href="#bib-mixed-content" title="Mixed Content">MIXED-CONTENT</a></cite>] to avoid potential exposure to
                insecure content. Such exposure could compromise other mitigations, such as use of
                TLS.
              </p>
              <p>
                User agents <em class="rfc2119">MAY</em> choose to block all Mixed Content, including "Optionally-blockable
                Content" [<cite><a class="bibref" data-link-type="biblio" href="#bib-mixed-content" title="Mixed Content">MIXED-CONTENT</a></cite>] to further increase security by preventing <a href="#input-data-security">untrusted media data</a> from being passed to the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-127">CDM</a>
                (see <a href="#cdm-security">CDM Attacks and Vulnerabilities</a>).
              </p>
            </dd>
            <dt id="security-consent">
              Fully inform users and/or require explicit user consent
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">SHOULD</em> ensure that users are fully informed and/or give explicit
                consent before a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-47">Key System</a> that presents security concerns that are greater
                than other user agent features (e.g., DOM content) may be accessed by an
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>.
              </p>
              <p>
                Such mechanisms <em class="rfc2119">MUST</em> be per <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> to avoid valid uses enabling subsequent
                malicious access and <em class="rfc2119">MUST</em> be per <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-10">browsing profile</a>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-147"><div role="heading" class="note-title marker" id="h-note-147" aria-level="5"><span>Note</span></div><p class="">
                The restriction of the APIs defined in this specification to secure contexts
                ensures that a <a href="#network-attacks">network attacker</a> cannot exploit
                permissions granted to an unauthenticated origin. See <a href="#persisted-consent-abuse">abuse of persisted consent</a>.
              </p></div>
            </dd>
          </dl>
        </section>
      </section>
      <section id="iframe-attacks"><div class="header-wrapper"><h3 id="x10-4-iframe-attacks"><bdi class="secno">10.4 </bdi>
          <code>iframe</code> Attacks
        </h3><a class="self-link" href="#iframe-attacks" aria-label="Permalink for Section 10.4"></a></div>
        
        <section class="informative" id="potential-attacks-0"><div class="header-wrapper"><h4 id="x10-4-1-potential-attacks"><bdi class="secno">10.4.1 </bdi>
            Potential Attacks
          </h4><a class="self-link" href="#potential-attacks-0" aria-label="Permalink for Section 10.4.1"></a></div><p><em>This section is non-normative.</em></p>
          
          <p>
            Malicious pages could host legitimate applications in an iframe in an attempt hide an
            attack or deceive the user as to the source, such as making the use appear to be from a
            legitimate content provider. This is especially relevent for implementations that
            <a href="#security-consent">inform the user or require consent</a>, such as for
            security and/or <a href="#privacy-consent">privacy reasons</a>. In addition to <a href="#network-attacks">Network Attacks</a>, attackers could try to exploit legitimate uses
            of the APIs defined in this specification by hosting them in an <code>iframe</code>. By
            having the legitimate application performing the actions, the attacker can reuse
            existing granted permissions (or whitelisting) and/or appear to be a legitimate request
            or use.
          </p>
        </section>
        <section id="mitigations-0"><div class="header-wrapper"><h4 id="x10-4-2-mitigations"><bdi class="secno">10.4.2 </bdi>
            Mitigations
          </h4><a class="self-link" href="#mitigations-0" aria-label="Permalink for Section 10.4.2"></a></div>
          
          <p>
            User agents that <a href="#security-consent">inform the user or require consent</a>,
            including for security and/or <a href="#privacy-consent">privacy reasons</a>, <em class="rfc2119">SHOULD</em>
            base the UI and persistence of consent on the combination of <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of the
            top-level <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> and the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> using the APIs defined in this specification.
            This ensures that users are informed of the main document making the request and that
            persisting a permission for one (legitimate) combination does not inadvertently allow
            malicious use to go undetected.
          </p>
          <p>
            Authors <em class="rfc2119">SHOULD</em> prevent other entities from hosting their applications in
            <code>iframe</code>s. Applications that must support being hosted for legitimate
            application-design reasons <em class="rfc2119">SHOULD NOT</em> allow hosting documents to provide <a href="#input-data-security">any data to be passed to the CDM</a> - either via the APIs
            defined in this specification or as media data - and <em class="rfc2119">SHOULD NOT</em> allow hosting frames to
            invoke the APIs defined in this specification.
          </p>
        </section>
      </section>
      <section id="cross-directory-attacks" class="informative"><div class="header-wrapper"><h3 id="x10-5-cross-directory-attacks"><bdi class="secno">10.5 </bdi>
          Cross-Directory Attacks
        </h3><a class="self-link" href="#cross-directory-attacks" aria-label="Permalink for Section 10.5"></a></div><p><em>This section is non-normative.</em></p>
        
        <p>
          Different authors sharing one host name, for example users hosting content on
          <code>geocities.com</code>, all share one <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>. User agents do not provide features
          to restrict access to APIs by pathname.
        </p>
        <p>
          Using the APIs defined in this specification on shared hosts compromises origin-based
          security and privacy mitigations implemented by user agents. For example, per-origin
          <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-29">Distinctive Identifiers</a> are shared by all authors on one host name, and peristed data
          may be accessed and manipulated by any author on the host. The latter is especially
          important if, for example, modification or deletion of such data could erase a user's
          right to specific content.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-148"><div role="heading" class="note-title marker" id="h-note-148" aria-level="4"><span>Note</span></div><p class="">
          Even if a path-restriction feature was made available by user agents, the usual DOM
          scripting security model would make it trivial to bypass this protection and access the
          data from any path.
        </p></div>
        <p>
          Authors on shared hosts are therefore <em class="rfc2119">RECOMMENDED</em> to avoid using the APIs defined in this
          specification because doing so compromises origin-based security and privacy mitigations
          in user agents.
        </p>
      </section>
    </section>
    <section id="privacy"><div class="header-wrapper"><h2 id="x11-privacy"><bdi class="secno">11. </bdi>
        Privacy
      </h2><a class="self-link" href="#privacy" aria-label="Permalink for Section 11."></a></div>
      
      <p>
        The presence or use of <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-48">Key System(s)</a> on a user's device raises a number of privacy
        issues, falling into two categories: (a) user-specific information that may be disclosed by
        the EME interface itself or within <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-49">Key System</a> messages and (b) user-specific
        information that may be persistently stored on the user's device.
      </p>
      <p>
        User Agents <em class="rfc2119">MUST</em> take responsibility for providing users with adequate control over their
        own privacy. Since User Agents may integrate with third party <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-128">CDM</a> implementations,
        <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-129">CDM</a> implementers <em class="rfc2119">MUST</em> provide sufficient information and controls to user agent
        implementers to enable them to implement appropriate techniques to ensure users have
        control over their privacy, including but not limited to the techniques described below.
      </p>
      <section id="privacy-disclosure"><div class="header-wrapper"><h3 id="x11-1-information-disclosed-by-eme-and-key-systems"><bdi class="secno">11.1 </bdi>
          Information Disclosed by EME and Key Systems
        </h3><a class="self-link" href="#privacy-disclosure" aria-label="Permalink for Section 11.1"></a></div>
        
        <p>
          Concerns regarding information disclosed by EME and <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-50">Key Systems</a> fall into two
          categories: (a) concerns about non-specific information that may nevertheless contribute
          to the possibility of fingerprinting a user agent or device and (b) user-specific
          information that may be used directly for <a href="#user-tracking">user tracking</a>.
        </p>
      </section>
      <section id="privacy-fingerprinting"><div class="header-wrapper"><h3 id="x11-2-fingerprinting"><bdi class="secno">11.2 </bdi>
          Fingerprinting
        </h3><a class="self-link" href="#privacy-fingerprinting" aria-label="Permalink for Section 11.2"></a></div>
        
        <p>
          Malicious applications may be able to fingerprint users or user agents by detecting or
          enumerating the list of <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-51">Key Systems</a> that are supported and related information. If
          proper origin protections are not provided this could include detection of sites that
          have been visited and information stored for those sites. In particular, <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-52">Key Systems</a>
          <em class="rfc2119">MUST</em> not share key or other data between <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origins</a>.
        </p>
      </section>
      <section id="privacy-leakage"><div class="header-wrapper"><h3 id="x11-3-information-leakage"><bdi class="secno">11.3 </bdi>
          Information Leakage
        </h3><a class="self-link" href="#privacy-leakage" aria-label="Permalink for Section 11.3"></a></div>
        
        <section class="informative" id="concerns"><div class="header-wrapper"><h4 id="x11-3-1-concerns"><bdi class="secno">11.3.1 </bdi>
            Concerns
          </h4><a class="self-link" href="#concerns" aria-label="Permalink for Section 11.3.1"></a></div><p><em>This section is non-normative.</em></p>
          
          <p>
            CDMs, especially those implemented outside the user agent, may not have the same
            fundamental isolations as the web platform. It is important that steps be taken to
            avoid information leakage, especially across origins. This includes both in-memory and
            stored data. Failure to do so could lead to information leakage to/from private
            browsing sessions, across <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-11">browsing profiles</a> (including across operating system user
            accounts) and even across different browsers or applications.
          </p>
        </section>
        <section id="mitigations-1"><div class="header-wrapper"><h4 id="x11-3-2-mitigations"><bdi class="secno">11.3.2 </bdi>
            Mitigations
          </h4><a class="self-link" href="#mitigations-1" aria-label="Permalink for Section 11.3.2"></a></div>
          
          <p>
            To avoid such issues, user agent and <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-130">CDM</a> implementations <em class="rfc2119">MUST</em> ensure that:
          </p>
          <ul>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-131">CDMs</a> have a concept of a <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-132">CDM</a> instance that is associated one-to-one with a
                <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-41"><code>MediaKeys</code></a> object.
              </p>
            </li>
            <li>
              <p>
                Keys, licenses, other session data, and the presence of sessions are restricted to
                the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-133">CDM</a> instance associated with the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-42"><code>MediaKeys</code></a> object that created the
                session.
              </p>
            </li>
            <li>
              <p>
                Session data is not shared between <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-43"><code>MediaKeys</code></a> objects or <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-134">CDM</a> instances.
              </p>
            </li>
            <li>
              <p>
                Session data is not shared with media elements not associated with the
                <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-44"><code>MediaKeys</code></a> object that created the session. Among other things, this means a
                session's keys <em class="rfc2119">MUST</em> not be used to decrypt content loaded by a media element whose
                <a data-link-type="idl" href="#dom-htmlmediaelement-mediakeys" class="internalDFN" id="ref-for-dom-htmlmediaelement-mediakeys-10"><code>mediaKeys</code></a> attribute is not that <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-45"><code>MediaKeys</code></a> object.
              </p>
            </li>
            <li>
              <p>
                <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-46"><code>MediaKeys</code></a> objects and the underlying implementation do not expose information
                outside the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>.
              </p>
            </li>
            <li>
              <p>
                Persisted session data, if applicable, is stored on a per-<a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> basis.
              </p>
            </li>
            <li>
              <p>
                Only data stored by the requesting <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> may be loaded.
              </p>
            </li>
            <li>
              <p>
                It is not possible to extract, derive or infer information from the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-135">CDM</a> that is
                not either explicitly described in this specification or available to the page
                through other web platform APIs without user permission. This applies to any
                information that is exposed outside the client device or to the application,
                including, for example, in <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-136">CDM</a> messages.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-149"><div role="heading" class="note-title marker" id="h-note-149" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  The type of information covered by this requirement includes but is not limited
                  to:
                </p>
                <ul>
                  <li>
                    <p>
                      Location, including geolocation
                    </p>
                  </li>
                  <li>
                    <p>
                      Credentials or identifiers other than <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-30">Distinctive Identifiers</a>
                    </p>
                  </li>
                  <li>
                    <p>
                      OS account name and other potential PII
                    </p>
                  </li>
                  <li>
                    <p>
                      Local directory paths, which may contain similar information.
                    </p>
                  </li>
                  <li>
                    <p>
                      Local network details (for example, the device's local IP address)
                    </p>
                  </li>
                  <li>
                    <p>
                      Local devices, including but not limited to Bluetooth, USB, and user media.
                    </p>
                  </li>
                  <li>
                    <p>
                      User state not associated with or stored as a result of the APIs defined in
                      this specification.
                    </p>
                  </li>
                </ul>
              </div></div>
            </li>
          </ul>
        </section>
      </section>
      <section id="user-tracking"><div class="header-wrapper"><h3 id="x11-4-user-tracking"><bdi class="secno">11.4 </bdi>
          User Tracking
        </h3><a class="self-link" href="#user-tracking" aria-label="Permalink for Section 11.4"></a></div>
        
        <section class="informative" id="concerns-0"><div class="header-wrapper"><h4 id="x11-4-1-concerns"><bdi class="secno">11.4.1 </bdi>
            Concerns
          </h4><a class="self-link" href="#concerns-0" aria-label="Permalink for Section 11.4.1"></a></div><p><em>This section is non-normative.</em></p>
          
          <p>
            A third-party host (or any entity, such as an advertiser, capable of getting content
            distributed to multiple sites) could use a <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-31">Distinctive Identifier</a> or persistent
            data, including licenses, keys, key IDs, or <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-14">records of license destruction</a>, stored
            by or on behalf of the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-137">CDM</a> to track a user across multiple sessions (including
            across <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origins</a> and <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-12">browsing profiles</a>), building a profile of the user's
            activities or interests. Such tracking would undermine the privacy protections provided
            by the rest of the web platform and could, for example, enable highly-targeted
            advertising not otherwise possible. In conjunction with a site that is aware of the
            user's real identity (for example, a content provider or e-commerce site that requires
            authenticated credentials), this could allow oppressive groups to target individuals
            with greater accuracy than in a world with purely anonymous web usage.
          </p>
          <p>
            User- or client-specific information that could be obtained via implementations of the
            APIs in this specification includes:
          </p>
          <ul>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-32">Distinctive Identifier(s)</a>
              </p>
            </li>
            <li>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-30">Distinctive Permanent Identifier(s)</a>
              </p>
            </li>
            <li>
              <p>
                Origins visited (via stored or in-memory data, permissions, etc.)
              </p>
            </li>
            <li>
              <p>
                Content viewed (via stored or in-memory licenses, keys, key IDs, <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-15">records of license destruction</a>, etc.)
              </p>
            </li>
          </ul>
          <p>
            This specification presents a specific concern because such information is commonly
            stored outside the user agent (and associated <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-13">browsing profile</a> storage), often in
            the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-138">CDM</a>.
          </p>
          <p>
            Since the content of licenses and <a data-link-type="dfn|abstract-op" href="#dfn-record-s-of-license-destruction" class="internalDFN" id="ref-for-dfn-record-s-of-license-destruction-16">records of license destruction</a> are <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-53">Key System</a>-specific and since key IDs may contain any value, these data items could be
            abused to store user-identifying information.
          </p>
          <p>
            <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-54">Key Systems</a> may access or create persistent or semi-persistent identifier(s) for a
            device or user of a device. In some cases these identifiers may be bound to a specific
            device in a secure manner. If these identifiers are present in <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-55">Key System</a> messages,
            then devices and/or users may be tracked. If the mitigations below are not applied,
            this could include both tracking of users / devices over time and associating multiple
            users of a given device.
          </p>
          <p>
            It is important to note that such identifiers, especially those that are non-clearable,
            non-<a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>-specific, or <a data-link-type="dfn|abstract-op" data-lt="permanent identifier" href="#dfn-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-permanent-identifier-s-4">permanent</a>, exceed the tracking
            impact of existing techniques such as cookies [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>] or session identifiers
            embedded in URLs.
          </p>
          <p>
            If not mitigated, such tracking may take three forms depending on the design of the
            <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-56">Key System</a>:
          </p>
          <ul>
            <li>
              <p>
                In all cases, such identifiers are expected to be available to sites and/or servers
                that fully support the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-57">Key System</a> (and thus can interpret <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-58">Key System</a>
                messages) enabling tracking by such sites.
              </p>
            </li>
            <li>
              <p>
                If identifiers exposed by <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-59">Key Systems</a> are not origin-specific, then two sites
                and/or servers that fully support the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-60">Key System</a> may collude to track the user.
              </p>
            </li>
            <li>
              <p>
                If <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-61">Key System</a> messages contain information derived from a user identifier in a
                consistent manner, for example such that a portion of the initial <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-62">Key System</a>
                message for a specific content item does not change over time and is dependent on
                the user identifier, then this information could be used by any application to
                track the device or user over time.
              </p>
            </li>
          </ul>
          <p>
            In addition, if a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-63">Key System</a> permits keys or other data to be stored and to be
            re-used between origins, then it may be possible for two origins to collude and track a
            unique user by recording their ability to access a common key.
          </p>
          <p>
            Finally, if any user interface for user control of <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-64">Key Systems</a> presents data
            separately from data in HTTP session cookies [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>] or persistent storage, then
            users are likely to modify site authorization or delete data in one and not the others.
            This would allow sites to use the various features as redundant backup for each other,
            defeating a user's attempts to protect his or her privacy.
          </p>
          <p>
            In addition to the potential for sites and other third-parties to track users, the user
            agent implementer, <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-139">CDM</a> vendor, or device vendor could build a profile of the user's
            activities or interests, such as sites using the APIs defined in this specification
            that the user visits. Such tracking would undermine the privacy protections provided by
            the rest of the web platform, especially those related to isolation of origins.
          </p>
          <p>
            Identifiers, such as <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-33">Distinctive Identifiers</a>, may be obtained from a server
            operated or provided by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-140">CDM</a> vendor, such as via an <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-14">individualization</a>
            process. The process may include providing client identifier(s), including
            <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-31">Distinctive Permanent Identifier(s)</a>, to the server. In order to generate a
            per-origin identifier, a value representing the origin may also be provided.
          </p>
          <p>
            In such an implementation, the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-141">CDM</a> vendor may be able to track the activity of the
            user, such as number of origins visited or number of times a new identifier is
            required. If the origin or a value <a data-link-type="dfn|abstract-op" href="#dfn-associable" class="internalDFN" id="ref-for-dfn-associable-5">associable</a> with the origin is provided in the
            identifier request, the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-142">CDM</a> vendor could track the sites visited by the user or
            user(s) of a device.
          </p>
          <p>
            The following section describes techniques that may mitigate the risks of tracking
            without user consent.
          </p>
        </section>
        <section id="mitigations-2"><div class="header-wrapper"><h4 id="x11-4-2-mitigations"><bdi class="secno">11.4.2 </bdi>
            Mitigations
          </h4><a class="self-link" href="#mitigations-2" aria-label="Permalink for Section 11.4.2"></a></div>
          
          <dl>
            <dt>
              Do not <a data-link-type="dfn|abstract-op" data-lt="use Distinctive Identifier(s) or Distinctive Permanent Identifier(s)" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-11">use Distinctive Identifiers or Distinctive Permanent Identifiers</a>
            </dt>
            <dd>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-65">Key System</a> implementations <em class="rfc2119">SHOULD</em> avoid <a data-link-type="dfn|abstract-op" data-lt="using Distinctive Identifier(s) or Distinctive Permanent Identifier(s)" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-12">using Distinctive Identifiers and Distinctive Permanent Identifiers</a> whenever possible and only use them when they meaningfully
                contribute to the robustness of the implementation. See <a href="#limit-or-avoid-use-of-distinctive-identifiers-and-permanent-identifiers">Limit or
                Avoid use of Distinctive Identifiers and Permanent Identifiers</a>.
              </p>
            </dd>
            <dt>
              Do not expose <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-32">Distinctive Permanent Identifiers</a> to the application
            </dt>
            <dd>
              <p>
                Implementations <em class="rfc2119">MUST NOT</em> expose <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-permanent-identifier-s-33">Distinctive Permanent Identifiers</a> to the
                application or origin.
              </p>
            </dd>
            <dt>
              Encrypt <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-34">Distinctive Identifiers</a>
            </dt>
            <dd>
              <p>
                <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-35">Distinctive Identifiers</a> in <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-66">Key System</a> messages <em class="rfc2119">MUST</em> be encrypted, together
                with a timestamp or nonce, such that the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-67">Key System</a> messages are always
                different. This prevents the use of <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-68">Key System</a> messages for tracking except by
                servers fully supporting the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-69">Key System</a>. See <a href="#encrypt-identifiers">Encrypt Identifiers</a>.
              </p>
            </dd>
            <dt id="like-cookies">
              Treat <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-36">Distinctive Identifiers</a> and Key System stored data like cookies / web
              storage
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">SHOULD</em> present the presence of <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-37">Distinctive Identifiers</a> and data
                stored by <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-70">Key Systems</a> to the user in a way that associates them strongly with
                HTTP session cookies [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>], including it in "remove all data", and presenting
                it in the same UI locations. This might encourage users to view such identifiers
                with healthy suspicion. User agents <em class="rfc2119">SHOULD</em> help the user avoid <a href="#incomplete-clearing">Incomplete Clearing of Data</a>.
              </p>
            </dd>
            <dt>
              Do not expose per-origin information to unrelated entities
            </dt>
            <dd>
              <p>
                Do not provide <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>(s) or values <a data-link-type="dfn|abstract-op" href="#dfn-associable" class="internalDFN" id="ref-for-dfn-associable-6">associable</a> with origins to
                individualization servers or other entities not related to the origin. Follow the
                requirements and recommendations in the <a data-link-type="dfn|abstract-op" href="#dfn-individualization" class="internalDFN" id="ref-for-dfn-individualization-15">Individualization</a> section if such a
                process is used by the implementation.
              </p>
            </dd>
            <dt>
              Use non-associable per-origin per-profile values and identifiers
            </dt>
            <dd>
              
              <p>
                For all <a data-link-type="dfn|abstract-op" href="#dfn-distinctive" class="internalDFN" id="ref-for-dfn-distinctive-6">Distinctive Values</a> exposed to the application, implementations <em class="rfc2119">MUST</em> use
                a different <a data-link-type="dfn|abstract-op" href="#dfn-non-associable-by-application" class="internalDFN" id="ref-for-dfn-non-associable-by-application-8">non-associable by applications</a> value for each <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and
                <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-14">browsing profile</a>. See <a href="#per-origin-per-profile-values" class="sec-ref"><bdi class="secno">8.4.1 </bdi>
            Use Per-Origin Per-Profile Values</a>.
              </p>
              <p>
                This is especially important for implementations that <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-9">use Distinctive Identifier(s)</a>. See <a href="#per-origin-per-profile-identifiers" class="sec-ref"><bdi class="secno">8.5.3 </bdi>
            Use Per-Origin Per-Profile Identifiers</a>.
              </p>
            </dd>
            <dt>
              Use origin-specific and browsing profile-specific <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-71">Key System</a> storage
            </dt>
            <dd>
              <p>
                Any data used by the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-143">CDM</a> that might impact messages or behavior in an
                application- or license server-visible way <em class="rfc2119">MUST</em> be partitioned by <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and
                <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-15">browsing profile</a> and <em class="rfc2119">MUST NOT</em> leak to or from private browsing sessions. This
                includes both in-memory and persisted data. Specifically but not exhaustively,
                session data, licenses, keys, and per-origin identifiers <em class="rfc2119">MUST</em> be partitioned
                per-<a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> and per-<a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-16">browsing profile</a>. See <a href="#use-origin-specific-key-system-storage" class="sec-ref"><bdi class="secno">8.3.1 </bdi>
            Use origin-specific and browsing profile-specific <span>Key System</span> storage</a> and <a href="#per-origin-per-profile-values" class="sec-ref"><bdi class="secno">8.4.1 </bdi>
            Use Per-Origin Per-Profile Values</a>.
              </p>
            </dd>
            <dt>
              Provide user deletion of persistent data, including <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-38">Distinctive Identifiers</a>
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">MUST</em> provide users with the ability to clear any persistent data,
                including <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-39">Distinctive Identifiers</a>, maintained by <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-72">Key Systems</a>. See <a href="#allow-persistent-data-cleared">Allow Persistent Data to Be Cleared</a>.
              </p>
            </dd>
            <dt>
              Expire stored data
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">MAY</em>, possibly in a manner configured by the user, automatically delete
                <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-40">Distinctive Identifiers</a> and/or other Key System data after a period of time.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-150"><div role="heading" class="note-title marker" id="h-note-150" aria-level="5"><span>Note</span></div><div class="">
                <p>
                  For example, a user agent could be configured to store such data as session-only
                  storage, deleting the data once the user had closed all the browsing contexts
                  that could access it.
                </p>
                <p>
                  This can restrict the ability of a site to track a user, as the site would then
                  only be able to track the user across multiple sessions when the user
                  authenticates with the site itself (e.g., by making a purchase or signing in to a
                  service).
                </p>
                <p>
                  However, this can also put the user's access to content, especially purchased or
                  rented content, at risk if the user does not fully understand the implications of
                  such expiration.
                </p>
              </div></div>
            </dd>
            <dt>
              Block third-party access
            </dt>
            <dd>
              
              <p>
                User agents <em class="rfc2119">MAY</em> restrict access to <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-73">Key Systems</a> and/or features to scripts
                originating at the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> of the top-level <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">Document</a> of the browsing
                context. For example, <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-14"><code>requestMediaKeySystemAccess</code></a><code>()</code> may deny requests
                for certain configurations for pages from other origins running in
                <code>iframe</code>s.
              </p>
            </dd>
            <dt id="privacy-consent">
              Fully inform users and/or require explicit user consent
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">MUST</em> ensure that users are fully informed and/or give explicit consent
                before <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-13">using Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a>.
              </p>
              <p>
                Such mechanisms <em class="rfc2119">MUST</em> be per <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a> to avoid valid uses enabling subsequent
                malicious access and <em class="rfc2119">MUST</em> be per <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-17">browsing profile</a>.
              </p>
              <div class="note" role="note" id="issue-container-generatedID-151"><div role="heading" class="note-title marker" id="h-note-151" aria-level="5"><span>Note</span></div><p class="">
                The restriction of the APIs defined in this specification to secure contexts
                ensures that a <a href="#network-attacks">network attacker</a> cannot exploit
                permissions granted to an unauthenticated origin. See <a href="#persisted-consent-abuse">abuse of persisted consent</a>.
              </p></div>
            </dd>
            <dt>
              Provide user controls to disable <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-74">Key Systems</a> or <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-75">Key System</a> use of identifiers
            </dt>
            <dd>
              <p>
                User Agents <em class="rfc2119">SHOULD</em> provide users with a global control of whether a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-76">Key System</a>
                is enabled and/or whether <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-77">Key System</a> <a data-link-type="dfn|abstract-op" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" class="internalDFN" id="ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-14">use of Distinctive Identifier(s) or Distinctive Permanent Identifier(s)</a> is enabled (if supported by the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-78">Key System</a>). User agents <em class="rfc2119">SHOULD</em> help the user avoid <a href="#incomplete-clearing">Incomplete Clearing of Data</a>.
              </p>
            </dd>
            <dt>
              Require site-specific whitelisting of access to each <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-79">Key System</a>
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">MAY</em> require the user to explicitly authorize access to each <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-80">Key System</a> - and/or certain features - before a site can use it. User agents <em class="rfc2119">SHOULD</em>
                enable users to revoke this authorization either temporarily or permanently.
              </p>
            </dd>
            <dt>
              Use shared blacklists
            </dt>
            <dd>
              <p>
                User agents <em class="rfc2119">MAY</em> allow users to share blacklists of <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origins</a> and/or <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-81">Key Systems</a>. This would allow communities to act together to protect their privacy.
              </p>
            </dd>
          </dl>
          <div class="note" role="note" id="issue-container-generatedID-152"><div role="heading" class="note-title marker" id="h-note-152" aria-level="5"><span>Note</span></div><p class="">
            While these suggestions prevent trivial use of the APIs defined in this specification
            for user tracking, they do not block it altogether. Within a single origin, a site can
            continue to track the user during a session, and can then pass all this information to
            a third party along with any identifying information (names, credit card numbers,
            addresses) obtained by the site. If a third party cooperates with multiple sites to
            obtain such information, and if identifiers are not 
            <a href="#per-origin-per-profile-identifiers">unique per origin and profile</a>, then a profile
            can still be created.
          </p></div>
        </section>
      </section>
      <section id="privacy-storedinfo"><div class="header-wrapper"><h3 id="x11-5-information-stored-on-user-devices"><bdi class="secno">11.5 </bdi>
          Information Stored on User Devices
        </h3><a class="self-link" href="#privacy-storedinfo" aria-label="Permalink for Section 11.5"></a></div>
        
        <section class="informative" id="concerns-1"><div class="header-wrapper"><h4 id="x11-5-1-concerns"><bdi class="secno">11.5.1 </bdi>
            Concerns
          </h4><a class="self-link" href="#concerns-1" aria-label="Permalink for Section 11.5.1"></a></div><p><em>This section is non-normative.</em></p>
          
          <p>
            <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-82">Key Systems</a> may store information on a user's device, or user agents may store
            information on behalf of Key Systems. Potentially, this could reveal information about
            a user to another user of the same device, including potentially the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origins</a> that
            have used a particular <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-83">Key System</a> (i.e., sites visited) or even the content that
            has been decrypted using a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-84">Key System</a>.
          </p>
          <p>
            If information stored by one origin affects the operation of the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-85">Key System</a> for
            another origin, then potentially the sites visited or content viewed by a user on one
            site may be revealed to another, potentially malicious, site.
          </p>
          <p>
            If information stored for one <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-18">browsing profile</a> on the client device affects the
            operation of the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-86">Key System</a> for other <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-19">browsing profiles</a>, or browsers, then
            potentially the sites visited or content viewed in one may be revealed by or
            correlatable with another <a data-link-type="dfn|abstract-op" href="#dfn-browsing-profile" class="internalDFN" id="ref-for-dfn-browsing-profile-20">browsing profile</a>, even including for different operating
            system user accounts or browsers.
          </p>
        </section>
        <section id="mitigations-3"><div class="header-wrapper"><h4 id="x11-5-2-mitigations"><bdi class="secno">11.5.2 </bdi>
            Mitigations
          </h4><a class="self-link" href="#mitigations-3" aria-label="Permalink for Section 11.5.2"></a></div>
          
          <p>
            Requirements mitigating these concerns are defined in <a href="#persistent-state-requirements" class="sec-ref"><bdi class="secno">8.3 </bdi>
          Persistent Data</a>.
          </p>
        </section>
      </section>
      <section id="incomplete-clearing"><div class="header-wrapper"><h3 id="x11-6-incomplete-clearing-of-data"><bdi class="secno">11.6 </bdi>
          Incomplete Clearing of Data
        </h3><a class="self-link" href="#incomplete-clearing" aria-label="Permalink for Section 11.6"></a></div>
        
        <section class="informative" id="concerns-2"><div class="header-wrapper"><h4 id="x11-6-1-concerns"><bdi class="secno">11.6.1 </bdi>
            Concerns
          </h4><a class="self-link" href="#concerns-2" aria-label="Permalink for Section 11.6.1"></a></div><p><em>This section is non-normative.</em></p>
          
          <p>
            A user's attempts to protect his or her privacy by clearing <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-41">Distinctive Identifiers</a>
            and stored data and/or disabling a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-87">Key System</a> may be defeated if all such data and
            functionality as well as cookies [<cite><a class="bibref" data-link-type="biblio" href="#bib-cookies" title="HTTP State Management Mechanism">COOKIES</a></cite>] and other site data are not cleared and/or
            disabled at the same time. For example:
          </p>
          <ul>
            <li>
              <p>
                If a user clears cookies or other persistent storage without also clearing
                <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-42">Distinctive Identifiers</a> and data stored by Key Systems, sites can defeat those
                attempts by using the various features as redundant backup for each other.
              </p>
            </li>
            <li>
              <p>
                If a user clears <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-43">Distinctive Identifiers</a> without also clearing data stored by
                <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-88">Key Systems</a>, including persistent sessions, as well as cookies and other
                persistent storage, sites can defeat those attempts by using the remaining data to
                associate the old and new identifiers.
              </p>
            </li>
            <li>
              <p>
                If a user disables a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-89">Key System</a>, especially for a specific <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin">origin</a>, without
                also clearing cookies or other persistent storage, sites can defeat those attempts
                by using the remaining features.
              </p>
            </li>
            <li>
              <p>
                If a user disables a <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-90">Key System</a>, then later decide to enable the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-91">Key System</a>, without also clearing cookies or other persistent storage, <a data-link-type="dfn|abstract-op" href="#dfn-distinctive-identifier-s" class="internalDFN" id="ref-for-dfn-distinctive-identifier-s-44">Distinctive Identifiers</a>, and data stored by <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-92">Key Systems</a>, sites may be able to associate
                data prior to the disabling with data and behavior after the <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-93">Key System</a> is
                re-enabled.
              </p>
            </li>
          </ul>
        </section>
        <section id="mitigations-4"><div class="header-wrapper"><h4 id="x11-6-2-mitigations"><bdi class="secno">11.6.2 </bdi>
            Mitigations
          </h4><a class="self-link" href="#mitigations-4" aria-label="Permalink for Section 11.6.2"></a></div>
          
          <p>
            Recommendations mitigating these concerns are defined in <a href="#persistent-state-requirements" class="sec-ref"><bdi class="secno">8.3 </bdi>
          Persistent Data</a>.
          </p>
        </section>
      </section>
      <section id="private-browsing"><div class="header-wrapper"><h3 id="x11-7-private-browsing-modes"><bdi class="secno">11.7 </bdi>
          Private Browsing Modes
        </h3><a class="self-link" href="#private-browsing" aria-label="Permalink for Section 11.7"></a></div>
        
        <p>
          User agents may support a mode (e.g., private browsing) of operation intended to preserve
          user anonymity and/or ensure records of browsing activity are not persisted on the
          client. The privacy concerns discussed in previous sections may be especially concerning
          for users employing such modes.
        </p>
        <p>
          User agent implementers that support such mode(s) <em class="rfc2119">SHOULD</em> carefully consider whether
          access to <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-94">Key Systems</a> should be disabled in these mode(s). For example, such modes
          <em class="rfc2119">MAY</em> prohibit creation of <a data-link-type="idl" data-lt="MediaKeySystemAccess" href="#dom-mediakeysystemaccess" class="internalDFN" id="ref-for-dom-mediakeysystemaccess-17"><code>MediaKeySystemAccess</code></a> objects that support or use
          <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-persistentstate" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-persistentstate-13"><code>persistentState</code></a> or a
          <a data-link-type="idl" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" class="internalDFN" id="ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-27"><code>distinctiveIdentifier</code></a> (either as part of the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-144">CDM</a>
          implementation or because the application indicated they were
          "<a data-link-type="idl" href="#dom-mediakeysrequirement-required" class="internalDFN" id="ref-for-dom-mediakeysrequirement-required-21"><code>required</code></a>"). If implementations do not prohibit such creation,
          they <em class="rfc2119">SHOULD</em> inform the user of the implications and potential consequences for the
          expected privacy properties of such modes before allowing their use.
        </p>
      </section>
      <section id="privacy-secureorigin"><div class="header-wrapper"><h3 id="x11-8-secure-origin-and-transport"><bdi class="secno">11.8 </bdi>
          Secure Origin and Transport
        </h3><a class="self-link" href="#privacy-secureorigin" aria-label="Permalink for Section 11.8"></a></div>
        
        <p>
          The APIs defined in this specification are only supported on secure origins, protecting
          information discussed in previous sections. Identifiers are additionally encrypted as
          specified in <a href="#encrypt-identifiers">Encrypt Identifiers</a>.
        </p>
        <p>
          Applications, including the servers they use, <em class="rfc2119">SHOULD</em> use secure transport for all traffic
          involving or containing data or messages from the <a data-link-type="dfn|abstract-op" href="#dfn-cdm" class="internalDFN" id="ref-for-dfn-cdm-145">CDM</a>, including but is not limited
          to all data passed from <a data-link-type="idl" data-lt="message" href="#dfn-message" class="internalDFN" id="ref-for-dfn-message-12"><code><code>message</code></code></a> events and to <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-22"><code>update</code></a><code>()</code>.
        </p>
        <p>
          All user agents <em class="rfc2119">MUST</em> properly handle Mixed Content [<cite><a class="bibref" data-link-type="biblio" href="#bib-mixed-content" title="Mixed Content">MIXED-CONTENT</a></cite>] to avoid exposure to
          insecure content or transport when the user agent or application wish to enforce secure
          origin and transport.
        </p>
      </section>
    </section>
    <section id="conformance"><div class="header-wrapper"><h2 id="x12-conformance"><bdi class="secno">12. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 12."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, <em class="rfc2119">REQUIRED</em>, <em class="rfc2119">SHALL</em>, <em class="rfc2119">SHALL NOT</em>, <em class="rfc2119">SHOULD</em>, and <em class="rfc2119">SHOULD NOT</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>
    <section id="examples" class="informative"><div class="header-wrapper"><h2 id="x13-examples"><bdi class="secno">13. </bdi>
        Examples
      </h2><a class="self-link" href="#examples" aria-label="Permalink for Section 13."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This section contains example solutions for various use cases using the proposed
        extensions. These are not the only solutions to these use cases. Video elements are used in
        the examples, but the same would apply to all media elements. In some cases, such as using
        synchronous XHR, the examples are simplified to keep the focus on the extensions.
      </p>
      <section id="example-source-and-key-known"><div class="header-wrapper"><h3 id="x13-1-source-and-key-known-at-page-load-clear-key"><bdi class="secno">13.1 </bdi>
          Source and Key Known at Page Load (Clear Key)
        </h3><a class="self-link" href="#example-source-and-key-known" aria-label="Permalink for Section 13.1"></a></div>
        
        <p class="exampledescription">
          In this simple example, the source file and <a href="#clear-key">clear-text license</a>
          are hard-coded in the page. Only one session will ever be created.
        </p>
        <div class="example" id="example-5">
        <div class="marker">
    <a class="self-link" href="#example-5">Example<bdi> 5</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onLoad</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> video = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'video'</span>);

    <span class="hljs-keyword">if</span> (!video.mediaKeys) {
      navigator.requestMediaKeySystemAccess(<span class="hljs-string">'org.w3.clearkey'</span>, [
        { <span class="hljs-attr">initDataTypes</span>: [<span class="hljs-string">'webm'</span>],
          <span class="hljs-attr">videoCapabilities</span>: [{ <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/webm; codecs="vp8"'</span> }] }
      ]).then(
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">keySystemAccess</span>) </span>{
          <span class="hljs-keyword">var</span> promise = keySystemAccess.createMediaKeys();
          promise.catch(
            <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to create MediaKeys'</span>)
          );
          promise.then(
            <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">createdMediaKeys</span>) </span>{
              <span class="hljs-keyword">return</span> video.setMediaKeys(createdMediaKeys);
            }
          ).catch(
            <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to set MediaKeys'</span>)
          );
          promise.then(
            <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">createdMediaKeys</span>) </span>{
              <span class="hljs-keyword">var</span> te = <span class="hljs-keyword">new</span> TextEncoder();
              <span class="hljs-keyword">var</span> initData = te.encode( <span class="hljs-string">'{"kids":["LwVHf8JLtPrv2GUXFW2v_A"]}'</span>);
              <span class="hljs-keyword">var</span> keySession = createdMediaKeys.createSession();
              keySession.addEventListener(<span class="hljs-string">"message"</span>, handleMessage, <span class="hljs-literal">false</span>);
              <span class="hljs-keyword">return</span> keySession.generateRequest(<span class="hljs-string">'keyids'</span>, initData);
            }
          ).catch(
            <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to create or initialize key session'</span>)
          );
        }
      );
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMessage</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-keyword">var</span> keySession = event.target;
    <span class="hljs-keyword">var</span> te = <span class="hljs-keyword">new</span> TextEncoder();
    <span class="hljs-keyword">var</span> license = te.encode(<span class="hljs-string">'{"keys":[{"kty":"oct","k":"tQ0bJVWb6b0KPL6KtZIy_A","kid":"LwVHf8JLtPrv2GUXFW2v_A"}],"type":"temporary"}'</span>);
    keySession.update(license).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'update() failed'</span>)
    );
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">'onLoad()'</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'foo.webm'</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'video'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre>
      </div>
      </section>
      <section id="example-selecting-key-system"><div class="header-wrapper"><h3 id="x13-2-selecting-a-supported-key-system-and-using-initialization-data-from-the-encrypted-event"><bdi class="secno">13.2 </bdi>
          Selecting a Supported Key System and Using Initialization Data from the "encrypted" Event
        </h3><a class="self-link" href="#example-selecting-key-system" aria-label="Permalink for Section 13.2"></a></div>
        
        <p class="exampledescription">
          This example selects a supported <a data-link-type="dfn|abstract-op" href="#dfn-key-system-s" class="internalDFN" id="ref-for-dfn-key-system-s-95">Key System</a> using the
          <a data-link-type="idl" data-lt="requestMediaKeySystemAccess()" href="#dom-navigator-requestmediakeysystemaccess" class="internalDFN" id="ref-for-dom-navigator-requestmediakeysystemaccess-15"><code>requestMediaKeySystemAccess</code></a><code>()</code> method then uses the <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-24">Initialization Data</a>
          from the <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://html.spec.whatwg.org/multipage/media.html#media-data">media data</a> to generate the license request and send it to
          the appropriate license server. One of the supported key systems uses a
          serverCertificate, which is provided proactively.
        </p>
        <div class="example" id="example-6">
        <div class="marker">
    <a class="self-link" href="#example-6">Example<bdi> 6</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">var</span> licenseUrl;
  <span class="hljs-keyword">var</span> serverCertificate;

  <span class="hljs-comment">// Returns a Promise&lt;MediaKeys&gt;.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSupportedKeySystem</span>(<span class="hljs-params"></span>) </span>{
    someSystemOptions = [
     { <span class="hljs-attr">initDataTypes</span>: [<span class="hljs-string">'keyids'</span>, <span class="hljs-string">'webm'</span>],
       <span class="hljs-attr">audioCapabilities</span>: [
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'audio/webm; codecs="opus"'</span> },
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'audio/webm; codecs="vorbis"'</span> }
       ],
       <span class="hljs-attr">videoCapabilities</span>: [
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/webm; codecs="vp9"'</span> },
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/webm; codecs="vp8"'</span> }
       ]
     }
    ];
    clearKeyOptions = [
     { <span class="hljs-attr">initDataTypes</span>: [<span class="hljs-string">'keyids'</span>, <span class="hljs-string">'webm'</span>],
       <span class="hljs-attr">audioCapabilities</span>: [
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'audio/webm; codecs="opus"'</span> },
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'audio/webm; codecs="vorbis"'</span> }
       ],
       <span class="hljs-attr">videoCapabilities</span>: [
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/webm; codecs="vp9"'</span>,
           <span class="hljs-attr">robustness</span>: <span class="hljs-string">'foo'</span> },
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/webm; codecs="vp9"'</span>,
           <span class="hljs-attr">robustness</span>: <span class="hljs-string">'bar'</span> },
         { <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/webm; codecs="vp8"'</span>,
           <span class="hljs-attr">robustness</span>: <span class="hljs-string">'bar'</span> },
       ]
     }
    ];

    <span class="hljs-keyword">return</span> navigator.requestMediaKeySystemAccess(<span class="hljs-string">'com.example.somesystem'</span>, someSystemOptions).then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">keySystemAccess</span>) </span>{
        <span class="hljs-comment">// Not shown:</span>
        <span class="hljs-comment">// 1. Use both attributes of keySystemAccess.getConfiguration().audioCapabilities[0]</span>
        <span class="hljs-comment">//    and both attributes of keySystemAccess.getConfiguration().videoCapabilities[0]</span>
        <span class="hljs-comment">//    to retrieve appropriate stream(s).</span>
        <span class="hljs-comment">// 2. Set video.src.</span>

        licenseUrl = <span class="hljs-string">'https://license.example.com/getkey'</span>;
        serverCertificate = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([ ... ]);
        <span class="hljs-keyword">return</span> keySystemAccess.createMediaKeys();
      }
    ).catch(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
        <span class="hljs-comment">// Try the next key system.</span>
        navigator.requestMediaKeySystemAccess(<span class="hljs-string">'org.w3.clearkey'</span>, clearKeyOptions).then(
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">keySystemAccess</span>) </span>{
            <span class="hljs-comment">// Not shown:</span>
            <span class="hljs-comment">// 1. Use keySystemAccess.getConfiguration().audioCapabilities[0].contentType</span>
            <span class="hljs-comment">//    and keySystemAccess.getConfiguration().videoCapabilities[0].contentType</span>
            <span class="hljs-comment">//    to retrieve appropriate stream(s).</span>
            <span class="hljs-comment">// 2. Set video.src.</span>

            licenseUrl = <span class="hljs-string">'https://license.example.com/clearkey/request'</span>;
            <span class="hljs-keyword">return</span> keySystemAccess.createMediaKeys();
          }
        );
      }
    ).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to instantiate a key system supporting the required combinations'</span>)
    );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleInitData</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-keyword">var</span> video = event.target;
    <span class="hljs-keyword">if</span> (video.mediaKeysObject === <span class="hljs-literal">undefined</span>) {
      video.mediaKeysObject = <span class="hljs-literal">null</span>; <span class="hljs-comment">// Prevent entering this path again.</span>
      video.pendingSessionData = []; <span class="hljs-comment">// Will store all initData until the MediaKeys is ready.</span>
      createSupportedKeySystem().then(
        <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">createdMediaKeys</span>) </span>{
          video.mediaKeysObject = createdMediaKeys;

          <span class="hljs-keyword">if</span> (serverCertificate)
            createdMediaKeys.setServerCertificate(serverCertificate);

          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; video.pendingSessionData.length; i++) {
            <span class="hljs-keyword">var</span> data = video.pendingSessionData[i];
            makeNewRequest(video.mediaKeysObject, data.initDataType, data.initData);
          }
          video.pendingSessionData = [];

          <span class="hljs-keyword">return</span> video.setMediaKeys(createdMediaKeys);
        }
      ).catch(
        <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Failed to create and initialize a MediaKeys object'</span>)
      );
    }
    addSession(video, event.initDataType, event.initData);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addSession</span>(<span class="hljs-params">video, initDataType, initData</span>) </span>{
    <span class="hljs-keyword">if</span> (video.mediaKeysObject) {
      makeNewRequest(video.mediaKeysObject, initDataType, initData);
    } <span class="hljs-keyword">else</span> {
      video.pendingSessionData.push({<span class="hljs-attr">initDataType</span>: initDataType, <span class="hljs-attr">initData</span>: initData});
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNewRequest</span>(<span class="hljs-params">mediaKeys, initDataType, initData</span>) </span>{
    <span class="hljs-keyword">var</span> keySession = mediaKeys.createSession();
    keySession.addEventListener(<span class="hljs-string">"message"</span>, licenseRequestReady, <span class="hljs-literal">false</span>);
    keySession.generateRequest(initDataType, initData).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to create or initialize key session'</span>)
    );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">licenseRequestReady</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-keyword">var</span> request = event.message;

    <span class="hljs-keyword">var</span> xmlhttp = <span class="hljs-keyword">new</span> XMLHttpRequest();
    xmlhttp.keySession = event.target;
    xmlhttp.open(<span class="hljs-string">"POST"</span>, licenseUrl);
    xmlhttp.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (xmlhttp.readyState == <span class="hljs-number">4</span>) {
        <span class="hljs-keyword">var</span> license = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(xmlhttp.response);
        xmlhttp.keySession.update(license).catch(
          <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'update() failed'</span>)
        );
      }
    }
    xmlhttp.send(request);
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">onencrypted</span>=<span class="hljs-string">'handleInitData(event)'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span></code></pre>
      </div>
      </section>
      <section id="example-mediakeys-before-source"><div class="header-wrapper"><h3 id="x13-3-create-mediakeys-before-loading-media"><bdi class="secno">13.3 </bdi>
          Create MediaKeys Before Loading Media
        </h3><a class="self-link" href="#example-mediakeys-before-source" aria-label="Permalink for Section 13.3"></a></div>
        
        <p class="exampledescription">
          Initialization is much simpler if encrypted events do not need to be handled during
          <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-47"><code>MediaKeys</code></a> initialization. This can be accomplished either by providing the
          <a data-link-type="dfn|abstract-op" href="#dfn-initialization-data" class="internalDFN" id="ref-for-dfn-initialization-data-25">Initialization Data</a> in other ways or setting the source after the <a data-link-type="idl" data-lt="MediaKeys" href="#dom-mediakeys" class="internalDFN" id="ref-for-dom-mediakeys-48"><code>MediaKeys</code></a>
          object has been created. This example does the latter.
        </p>
        <div class="example" id="example-7">
        <div class="marker">
    <a class="self-link" href="#example-7">Example<bdi> 7</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">var</span> licenseUrl;
  <span class="hljs-keyword">var</span> serverCertificate;
  <span class="hljs-keyword">var</span> mediaKeys;

  <span class="hljs-comment">// See the previous example for implementations of these functions.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSupportedKeySystem</span>(<span class="hljs-params"></span>) </span>{ ... }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNewRequest</span>(<span class="hljs-params">mediaKeys, initDataType, initData</span>) </span>{ ... }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">licenseRequestReady</span>(<span class="hljs-params">event</span>) </span>{ ... }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleInitData</span>(<span class="hljs-params">event</span>) </span>{
    makeNewRequest(mediaKeys, event.initDataType, event.initData);
  }

  createSupportedKeySystem().then(
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">createdMediaKeys</span>) </span>{
      mediaKeys = createdMediaKeys;
      <span class="hljs-keyword">var</span> video = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"v"</span>);
      video.src = <span class="hljs-string">'foo.webm'</span>;
      <span class="hljs-keyword">if</span> (serverCertificate)
        mediaKeys.setServerCertificate(serverCertificate);
      <span class="hljs-keyword">return</span> video.setMediaKeys(mediaKeys);
    }
  ).catch(
    <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Failed to create and initialize a MediaKeys object'</span>)
  );
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"v"</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">onencrypted</span>=<span class="hljs-string">'handleInitData(event)'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span></code></pre>
      </div>
      </section>
      <section id="example-using-all-events"><div class="header-wrapper"><h3 id="x13-4-using-all-events"><bdi class="secno">13.4 </bdi>
          Using All Events
        </h3><a class="self-link" href="#example-using-all-events" aria-label="Permalink for Section 13.4"></a></div>
        
        <p class="exampledescription">
          This is a more complete example showing all events being used.
        </p>
        <p class="exampledescription">
          Note that <code>handleMessage()</code> could be called multiple times, including in
          response to the <a data-link-type="idl" data-lt="update()" href="#dom-mediakeysession-update" class="internalDFN" id="ref-for-dom-mediakeysession-update-23"><code>update</code></a><code>()</code> call if multiple round trips are required
          and for any other reason the Key System might need to send a message.
        </p>
        <div class="example" id="example-8">
        <div class="marker">
    <a class="self-link" href="#example-8">Example<bdi> 8</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">var</span> licenseUrl;
  <span class="hljs-keyword">var</span> serverCertificate;
  <span class="hljs-keyword">var</span> mediaKeys;

  <span class="hljs-comment">// See previous examples for implementations of these functions.</span>
  <span class="hljs-comment">// createSupportedKeySystem() additionally sets renewalUrl.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSupportedKeySystem</span>(<span class="hljs-params"></span>) </span>{ ... }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleInitData</span>(<span class="hljs-params">event</span>) </span>{ ... }

  <span class="hljs-comment">// This replaces the implementation in the previous example.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNewRequest</span>(<span class="hljs-params">mediaKeys, initDataType, initData</span>) </span>{
    <span class="hljs-keyword">var</span> keySession = mediaKeys.createSession();
    keySession.addEventListener(<span class="hljs-string">'message'</span>, handleMessage, <span class="hljs-literal">false</span>);
    keySession.addEventListener(<span class="hljs-string">'keystatuseschange'</span>, handlekeyStatusesChange, <span class="hljs-literal">false</span>);
    keySession.closed.then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Session'</span>, <span class="hljs-built_in">this</span>.sessionId, <span class="hljs-string">'closed, reason'</span>, reason);
      }.bind(keySession)
    );
    keySession.generateRequest(initDataType, initData).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to create or initialize key session'</span>)
    );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMessageResponse</span>(<span class="hljs-params">keySession, response</span>) </span>{
    <span class="hljs-keyword">var</span> license = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(response);
    keySession.update(license).catch(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'update() failed: '</span> + err);
      }
    );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendMessage</span>(<span class="hljs-params">type, message, keySession</span>) </span>{
    <span class="hljs-keyword">var</span> url = licenseUrl;
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"license-renewal"</span>)
      url = renewalUrl;
    xmlhttp = <span class="hljs-keyword">new</span> XMLHttpRequest();
    xmlhttp.keySession = keySession;
    xmlhttp.open(<span class="hljs-string">'POST'</span>, url);
    xmlhttp.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (xmlhttp.readyState == <span class="hljs-number">4</span>)
        handleMessageResponse(xmlhttp.keySession, xmlhttp.response);
    }
    xmlhttp.send(message);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMessage</span>(<span class="hljs-params">event</span>) </span>{
    sendMessage(event.messageType, event.message, event.target);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handlekeyStatusesChange</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-comment">// Evaluate the current state using one of the map-like methods exposed by</span>
    <span class="hljs-comment">// event.target.keyStatuses.</span>
    <span class="hljs-comment">// For example:</span>
    event.target.keyStatuses.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">status, keyId</span>) </span>{
      <span class="hljs-keyword">switch</span> (status) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"usable"</span>:
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"expired"</span>:
          <span class="hljs-comment">// Report an expired key.</span>
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"status-pending"</span>:
          <span class="hljs-comment">// The status is not yet known. Consider the key unusable until the status is updated.</span>
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
          <span class="hljs-comment">// Do something with |keyId| and |status|.</span>
      }
    })
  }

  createSupportedKeySystem().then(
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">createdMediaKeys</span>) </span>{
      mediaKeys = createdMediaKeys;
      <span class="hljs-keyword">var</span> video = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"v"</span>);
      video.src = <span class="hljs-string">'foo.webm'</span>;
      <span class="hljs-keyword">if</span> (serverCertificate)
        mediaKeys.setServerCertificate(serverCertificate);
      <span class="hljs-keyword">return</span> video.setMediaKeys(mediaKeys);
    }
  ).catch(
    <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Failed to create and initialize a MediaKeys object'</span>)
  );
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"v"</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">onencrypted</span>=<span class="hljs-string">'handleInitData(event)'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span></code></pre>
      </div>
      </section>
      <section id="example-stored-license"><div class="header-wrapper"><h3 id="x13-5-stored-license"><bdi class="secno">13.5 </bdi>
          Stored License
        </h3><a class="self-link" href="#example-stored-license" aria-label="Permalink for Section 13.5"></a></div>
        
        <p class="exampledescription">
          This example requests a persistent license for future use and stores it. It also provides
          functions for later retrieving the license and for destroying it.
        </p>
        <div class="example" id="example-9">
        <div class="marker">
    <a class="self-link" href="#example-9">Example<bdi> 9</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">var</span> licenseUrl;
  <span class="hljs-keyword">var</span> serverCertificate;
  <span class="hljs-keyword">var</span> mediaKeys;

  <span class="hljs-comment">// See the previous examples for implementations of these functions.</span>
  <span class="hljs-comment">// createSupportedKeySystem() additionally sets persistentState: "required" in each options dictionary.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSupportedKeySystem</span>(<span class="hljs-params"></span>) </span>{ ... }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendMessage</span>(<span class="hljs-params">message, keySession</span>) </span>{ ... }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMessage</span>(<span class="hljs-params">event</span>) </span>{ ... }

  <span class="hljs-comment">// Called if the application does not have a stored sessionId for the media resource.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNewRequest</span>(<span class="hljs-params">mediaKeys, initDataType, initData</span>) </span>{
    <span class="hljs-keyword">var</span> keySession = mediaKeys.createSession(<span class="hljs-string">"persistent-license"</span>);
    keySession.addEventListener(<span class="hljs-string">'message'</span>, handleMessage, <span class="hljs-literal">false</span>);
    keySession.closed.then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Session'</span>, <span class="hljs-built_in">this</span>.sessionId, <span class="hljs-string">'closed, reason'</span>, reason);
      }.bind(keySession)
    );
    keySession.generateRequest(initDataType, initData).then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">// Store this.sessionId in the application.</span>
      }.bind(keySession)
    ).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to request a persistent license'</span>)
    );
  }

  <span class="hljs-comment">// Called if the application has a stored sessionId for the media resource.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadStoredSession</span>(<span class="hljs-params">mediaKeys, sessionId</span>) </span>{
    <span class="hljs-keyword">var</span> keySession = mediaKeys.createSession(<span class="hljs-string">"persistent-license"</span>);
    keySession.addEventListener(<span class="hljs-string">'message'</span>, handleMessage, <span class="hljs-literal">false</span>);
    keySession.closed.then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Session'</span>, <span class="hljs-built_in">this</span>.sessionId, <span class="hljs-string">'closed, reason'</span>, reason);
      }.bind(keySession)
    );
    keySession.load(sessionId).then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">loaded</span>) </span>{
        <span class="hljs-keyword">if</span> (!loaded) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'No stored session with the ID '</span> + sessionId + <span class="hljs-string">' was found.'</span>);
          <span class="hljs-comment">// The application should remove its record of |sessionId|.</span>
          <span class="hljs-keyword">return</span>;
        }
      }
    ).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Unable to load or initialize the stored session with the ID '</span> + sessionId)
    );
  }

  <span class="hljs-comment">// Called when the application wants to stop using the session without removing the stored license.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">closeSession</span>(<span class="hljs-params">keySession</span>) </span>{
    keySession.close();
  }

  <span class="hljs-comment">// Called when the application wants to remove the stored license.</span>
  <span class="hljs-comment">// The stored session data has not been completely removed until the promise returned by remove() is fulfilled.</span>
  <span class="hljs-comment">// The remove() call may initiate a series of messages to/from the server that must be completed before this occurs.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeStoredSession</span>(<span class="hljs-params">keySession</span>) </span>{
    keySession.remove().then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Session '</span> + <span class="hljs-built_in">this</span>.sessionId + <span class="hljs-string">' removed'</span>);
        <span class="hljs-comment">// The application should remove its record of this.sessionId.</span>
      }.bind(keySession)
    ).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Failed to remove the session'</span>)
    );
  }

  <span class="hljs-comment">// This replaces the implementation in the previous example.</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMessageResponse</span>(<span class="hljs-params">keySession, response</span>) </span>{
    <span class="hljs-keyword">var</span> license = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(response);
    keySession.update(license).then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">// If this was the last required message from the server, the license is</span>
        <span class="hljs-comment">// now stored. Update the application state as appropriate.</span>
      }
    ).catch(
      <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'update() failed'</span>)
    );
  }

  createSupportedKeySystem().then(
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">createdMediaKeys</span>) </span>{
      mediaKeys = createdMediaKeys;
      <span class="hljs-keyword">var</span> video = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"v"</span>);
      <span class="hljs-keyword">if</span> (serverCertificate)
        mediaKeys.setServerCertificate(serverCertificate);
      <span class="hljs-keyword">return</span> video.setMediaKeys(mediaKeys);
    }
  ).catch(
    <span class="hljs-built_in">console</span>.error.bind(<span class="hljs-built_in">console</span>, <span class="hljs-string">'Failed to create and initialize a MediaKeys object'</span>)
  );
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'v'</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'foo.webm'</span> <span class="hljs-attr">autoplay</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span></code></pre>
      </div>
      </section>
      <section id="example-getStatusForPolicy"><div class="header-wrapper"><h3 id="x13-6-pre-fetch-media-with-hdcp-policy"><bdi class="secno">13.6 </bdi>
          Pre-fetch Media With HDCP Policy
        </h3><a class="self-link" href="#example-getStatusForPolicy" aria-label="Permalink for Section 13.6"></a></div>
        
        <p class="exampledescription">
          If some media will have an HDCP policy in the license, an application can check for that
          version before pre-fetching.
        </p>
        <div class="example" id="example-10">
        <div class="marker">
    <a class="self-link" href="#example-10">Example<bdi> 10</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> video.mediaKeys.getStatusForPolicy({
  <span class="hljs-attr">minHdcpVersion</span>: <span class="hljs-string">'1.4'</span>
});

<span class="hljs-keyword">if</span> (status === <span class="hljs-string">'usable'</span>) {
  <span class="hljs-comment">// Pre-fetch HD content.</span>
} <span class="hljs-keyword">else</span> {  <span class="hljs-comment">// 'output-restricted'</span>
  <span class="hljs-comment">// Pre-fetch SD content.</span>
}</code></pre>
      </div>
      </section>
    </section>
    <section id="acknowledgements"><div class="header-wrapper"><h2 id="x14-acknowledgments"><bdi class="secno">14. </bdi>
        Acknowledgments
      </h2><a class="self-link" href="#acknowledgements" aria-label="Permalink for Section 14."></a></div>
      
      <p>
        The editors would like to thank Aaron Colwell, Alex Russell, Anne van Kesteren, Bob Lund,
        Boris Zbarsky, Chris Needham, Chris Pearce, David Singer, Domenic Denicola, Frank Galligan,
        Glenn Adams, Henri Sivonen, Jer Noble, Joe Steele, Joey Parrish, John Simmons, Mark
        Vickers, Pavel Pergamenshchik, Philip Jägenstedt, Pierre Lemieux, Robert O'Callahan, Ryan
        Sleevi, Steve Heffernan, Steven Robertson Theresa O'Connor, Thomás Inskip, Travis Leithead,
        and Xiaohan Wang for their contributions to this specification. Thank you also to the many
        others who contributed to the specification, including through their participation on the
        mailing list and in the issues.
      </p>
    </section>
  

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-references"><bdi class="secno">A. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="a-1-normative-references"><bdi class="secno">A.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix A.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-cookies">[COOKIES]</dt><dd>
      <a href="https://httpwg.org/specs/rfc6265.html"><cite>HTTP State Management Mechanism</cite></a>. A. Barth.  IETF. April 2011. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc6265.html">https://httpwg.org/specs/rfc6265.html</a>
    </dd><dt id="bib-dom">[dom]</dt><dd>
      <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
    </dd><dt id="bib-ecma-262">[ECMA-262]</dt><dd>
      <a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>.  Ecma International. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
    </dd><dt id="bib-eme-initdata-keyids">[EME-INITDATA-KEYIDS]</dt><dd>
      <a href="https://www.w3.org/TR/eme-initdata-keyids/"><cite>"keyids" Initialization Data Format</cite></a>. David Dorwin; Adrian Bateman; Mark Watson.  W3C. 15 September 2016. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/eme-initdata-keyids/">https://www.w3.org/TR/eme-initdata-keyids/</a>
    </dd><dt id="bib-eme-initdata-registry">[EME-INITDATA-REGISTRY]</dt><dd>
      <a href="https://www.w3.org/TR/eme-initdata-registry/"><cite>Encrypted Media Extensions Initialization Data Format Registry</cite></a>. David Dorwin; Adrian Bateman; Mark Watson.  W3C. 15 September 2016. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/eme-initdata-registry/">https://www.w3.org/TR/eme-initdata-registry/</a>
    </dd><dt id="bib-encoding">[ENCODING]</dt><dd>
      <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
    </dd><dt id="bib-html">[HTML]</dt><dd>
      <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    </dd><dt id="bib-infra">[Infra]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-mimesniff">[mimesniff]</dt><dd>
      <a href="https://mimesniff.spec.whatwg.org/"><cite>MIME Sniffing Standard</cite></a>. Gordon P. Hemsley.  WHATWG. Living Standard. URL: <a href="https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a>
    </dd><dt id="bib-mixed-content">[MIXED-CONTENT]</dt><dd>
      <a href="https://www.w3.org/TR/mixed-content/"><cite>Mixed Content</cite></a>. Emily Stark; Mike West; Carlos IbarraLopez.  W3C. 23 February 2023. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/mixed-content/">https://www.w3.org/TR/mixed-content/</a>
    </dd><dt id="bib-permissions-policy">[PERMISSIONS-POLICY]</dt><dd>
      <a href="https://www.w3.org/TR/permissions-policy-1/"><cite>Permissions Policy</cite></a>. Ian Clelland.  W3C. 18 December 2023. W3C Working Draft. URL: <a href="https://www.w3.org/TR/permissions-policy-1/">https://www.w3.org/TR/permissions-policy-1/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc6381">[RFC6381]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6381"><cite>The 'Codecs' and 'Profiles' Parameters for "Bucket" Media Types</cite></a>. R. Gellens; D. Singer; P. Frojdh.  IETF. August 2011. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6381">https://www.rfc-editor.org/rfc/rfc6381</a>
    </dd><dt id="bib-rfc7517">[RFC7517]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-webidl">[WEBIDL]</dt><dd>
      <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="a-2-informative-references"><bdi class="secno">A.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix A.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-cenc">[CENC]</dt><dd>
      <a href="https://www.iso.org/obp/ui/#iso:std:iso-iec:23001:-7:ed-3:v1"><cite>ISO/IEC 23001-7:2016, Information technology — MPEG systems technologies — Part 7: Common encryption in ISO Base Media File Format files</cite></a>.  ISO/IEC. International Standard. URL: <a href="https://www.iso.org/obp/ui/#iso:std:iso-iec:23001:-7:ed-3:v1">https://www.iso.org/obp/ui/#iso:std:iso-iec:23001:-7:ed-3:v1</a>
    </dd><dt id="bib-eme-stream-registry">[EME-STREAM-REGISTRY]</dt><dd>
      <a href="https://www.w3.org/TR/eme-stream-registry/"><cite>Encrypted Media Extensions Stream Format Registry</cite></a>. David Dorwin; Adrian Bateman; Mark Watson.  W3C. 15 September 2016. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/eme-stream-registry/">https://www.w3.org/TR/eme-stream-registry/</a>
    </dd><dt id="bib-media-source">[MEDIA-SOURCE]</dt><dd>
      <a href="https://www.w3.org/TR/media-source-2/"><cite>Media Source Extensions™</cite></a>. Jean-Yves Avenard; Mark Watson.  W3C. 1 April 2024. W3C Working Draft. URL: <a href="https://www.w3.org/TR/media-source-2/">https://www.w3.org/TR/media-source-2/</a>
    </dd><dt id="bib-rfc6838">[RFC6838]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6838"><cite>Media Type Specifications and Registration Procedures</cite></a>. N. Freed; J. Klensin; T. Hansen.  IETF. January 2013. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>
    </dd><dt id="bib-rfc7515">[RFC7515]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7515"><cite>JSON Web Signature (JWS)</cite></a>. M. Jones; J. Bradley; N. Sakimura.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>
    </dd><dt id="bib-webaudio">[webaudio]</dt><dd>
      <a href="https://www.w3.org/TR/webaudio/"><cite>Web Audio API</cite></a>. Paul Adenot; Hongchan Choi.  W3C. 17 June 2021. W3C Recommendation. URL: <a href="https://www.w3.org/TR/webaudio/">https://www.w3.org/TR/webaudio/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cdm" aria-label="Links in this document to definition: Content Decryption Module (CDM)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cdm" aria-label="Permalink for definition: Content Decryption Module (CDM). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-cdm-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-cdm-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cdm-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-cdm-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-cdm-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-cdm-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-cdm-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-cdm-11" title="Reference 11">(11)</a> <a href="#ref-for-dfn-cdm-12" title="Reference 12">(12)</a> <a href="#ref-for-dfn-cdm-13" title="Reference 13">(13)</a> <a href="#ref-for-dfn-cdm-14" title="Reference 14">(14)</a> <a href="#ref-for-dfn-cdm-15" title="Reference 15">(15)</a> <a href="#ref-for-dfn-cdm-16" title="Reference 16">(16)</a> <a href="#ref-for-dfn-cdm-17" title="Reference 17">(17)</a> <a href="#ref-for-dfn-cdm-18" title="Reference 18">(18)</a> <a href="#ref-for-dfn-cdm-19" title="Reference 19">(19)</a> <a href="#ref-for-dfn-cdm-20" title="Reference 20">(20)</a> <a href="#ref-for-dfn-cdm-21" title="Reference 21">(21)</a> <a href="#ref-for-dfn-cdm-22" title="Reference 22">(22)</a> <a href="#ref-for-dfn-cdm-23" title="Reference 23">(23)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-24" title="§ 3.2.2.4 Get Consent Status">§ 3.2.2.4 Get Consent Status</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-25" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dfn-cdm-26" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-27" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-28" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-29" title="§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members">§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members</a> <a href="#ref-for-dfn-cdm-30" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-31" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-32" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-33" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dfn-cdm-34" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-35" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-36" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-37" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cdm-38" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-39" title="§ 5.2.2 CDM Unavailable">§ 5.2.2 CDM Unavailable</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-40" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dfn-cdm-41" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-42" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-43" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-44" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cdm-45" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-46" title="§ 6.1 Attributes">§ 6.1 Attributes</a> <a href="#ref-for-dfn-cdm-47" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-48" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-cdm-49" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-50" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-51" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-52" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cdm-53" title="Reference 6">(6)</a> <a href="#ref-for-dfn-cdm-54" title="Reference 7">(7)</a> <a href="#ref-for-dfn-cdm-55" title="Reference 8">(8)</a> <a href="#ref-for-dfn-cdm-56" title="Reference 9">(9)</a> <a href="#ref-for-dfn-cdm-57" title="Reference 10">(10)</a> <a href="#ref-for-dfn-cdm-58" title="Reference 11">(11)</a> <a href="#ref-for-dfn-cdm-59" title="Reference 12">(12)</a> <a href="#ref-for-dfn-cdm-60" title="Reference 13">(13)</a> <a href="#ref-for-dfn-cdm-61" title="Reference 14">(14)</a> <a href="#ref-for-dfn-cdm-62" title="Reference 15">(15)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-63" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> <a href="#ref-for-dfn-cdm-64" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-65" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-66" title="§ 6.4.1 Attributes">§ 6.4.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-67" title="§ 6.5 Event Summary">§ 6.5 Event Summary</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-68" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> <a href="#ref-for-dfn-cdm-69" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-70" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-71" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> <a href="#ref-for-dfn-cdm-72" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-73" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-74" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dfn-cdm-75" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-76" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-77" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-78" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-79" title="§ 7.2 Methods">§ 7.2 Methods</a> <a href="#ref-for-dfn-cdm-80" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-81" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-82" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-83" title="§ 7.5.1 Media Data May Contain Encrypted Blocks">§ 7.5.1 Media Data May Contain Encrypted Blocks</a> <a href="#ref-for-dfn-cdm-84" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-85" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> <a href="#ref-for-dfn-cdm-86" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-87" title="§ 7.6 Media Element Restrictions">§ 7.6 Media Element Restrictions</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-88" title="§ 8. Implementation Requirements">§ 8. Implementation Requirements</a> <a href="#ref-for-dfn-cdm-89" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-90" title="§ 8.1 CDM Constraints">§ 8.1 CDM Constraints</a> <a href="#ref-for-dfn-cdm-91" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-92" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-93" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-94" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-95" title="§ 8.2 Messages and Communication">§ 8.2 Messages and Communication</a> <a href="#ref-for-dfn-cdm-96" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-97" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-98" title="§ 8.3 Persistent Data">§ 8.3 Persistent Data</a> <a href="#ref-for-dfn-cdm-99" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-100" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-101" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-102" title="§ 8.4 Values Exposed to the Application">§ 8.4 Values Exposed to the Application</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-103" title="§ 8.5 Identifiers">§ 8.5 Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-104" title="§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers">§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-105" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> <a href="#ref-for-dfn-cdm-106" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-107" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-108" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-109" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-110" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-111" title="§ 8.6.1 Direct Individualization">§ 8.6.1 Direct Individualization</a> <a href="#ref-for-dfn-cdm-112" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-113" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-114" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> <a href="#ref-for-dfn-cdm-115" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-116" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-117" title="§ 8.8.2 Support Extraction From Media Data">§ 8.8.2 Support Extraction From Media Data</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-118" title="§ 8.9.3 Unencrypted In-band Support Content">§ 8.9.3 Unencrypted In-band Support Content</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-119" title="§ 10.1 Input Data Attacks and Vulnerabilities">§ 10.1 Input Data Attacks and Vulnerabilities</a> <a href="#ref-for-dfn-cdm-120" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-121" title="§ 10.2 CDM Attacks and Vulnerabilities">§ 10.2 CDM Attacks and Vulnerabilities</a> <a href="#ref-for-dfn-cdm-122" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-123" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-124" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-125" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cdm-126" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-127" title="§ 10.3.2 Mitigations">§ 10.3.2 Mitigations</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-128" title="§ 11. Privacy">§ 11. Privacy</a> <a href="#ref-for-dfn-cdm-129" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-130" title="§ 11.3.2 Mitigations">§ 11.3.2 Mitigations</a> <a href="#ref-for-dfn-cdm-131" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-132" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-133" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-134" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cdm-135" title="Reference 6">(6)</a> <a href="#ref-for-dfn-cdm-136" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-137" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> <a href="#ref-for-dfn-cdm-138" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cdm-139" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cdm-140" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cdm-141" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cdm-142" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-143" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-144" title="§ 11.7 Private Browsing Modes">§ 11.7 Private Browsing Modes</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-145" title="§ 11.8 Secure Origin and Transport">§ 11.8 Secure Origin and Transport</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-key-system-s" aria-label="Links in this document to definition: Key System">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-key-system-s" aria-label="Permalink for definition: Key System. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-key-system-s-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-key-system-s-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-3" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-key-system-s-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-5" title="§ 3. Obtaining Access to Key Systems">§ 3. Obtaining Access to Key Systems</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-6" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> <a href="#ref-for-dfn-key-system-s-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-8" title="§ 3.2.2.1 Get Supported Configuration">§ 3.2.2.1 Get Supported Configuration</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-9" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-10" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dfn-key-system-s-11" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-12" title="§ 4. MediaKeySystemAccess Interface">§ 4. MediaKeySystemAccess Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-13" title="§ 4.1 Attributes">§ 4.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-14" title="§ 4.2 Methods">§ 4.2 Methods</a> <a href="#ref-for-dfn-key-system-s-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-16" title="Reference 3">(3)</a> <a href="#ref-for-dfn-key-system-s-17" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-18" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-19" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dfn-key-system-s-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-21" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-22" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-23" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-key-system-s-24" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-25" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-26" title="§ 6.4.1 Attributes">§ 6.4.1 Attributes</a> <a href="#ref-for-dfn-key-system-s-27" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-28" title="§ 6.7 Exceptions">§ 6.7 Exceptions</a> <a href="#ref-for-dfn-key-system-s-29" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-30" title="Reference 3">(3)</a> <a href="#ref-for-dfn-key-system-s-31" title="Reference 4">(4)</a> <a href="#ref-for-dfn-key-system-s-32" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-33" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-34" title="§ 8. Implementation Requirements">§ 8. Implementation Requirements</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-35" title="§ 8.3.1 Use origin-specific and browsing profile-specific Key System storage">§ 8.3.1 Use origin-specific and browsing profile-specific Key System storage</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-36" title="§ 8.3.2 Allow Persistent Data to Be Cleared">§ 8.3.2 Allow Persistent Data to Be Cleared</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-37" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-38" title="§ 9. Common Key Systems">§ 9. Common Key Systems</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-39" title="§ 9.1 Clear Key">§ 9.1 Clear Key</a> <a href="#ref-for-dfn-key-system-s-40" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-41" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-42" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-43" title="§ 10.1 Input Data Attacks and Vulnerabilities">§ 10.1 Input Data Attacks and Vulnerabilities</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-44" title="§ 10.2 CDM Attacks and Vulnerabilities">§ 10.2 CDM Attacks and Vulnerabilities</a> <a href="#ref-for-dfn-key-system-s-45" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-46" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-47" title="§ 10.3.2 Mitigations">§ 10.3.2 Mitigations</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-48" title="§ 11. Privacy">§ 11. Privacy</a> <a href="#ref-for-dfn-key-system-s-49" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-50" title="§ 11.1 Information Disclosed by EME and Key Systems">§ 11.1 Information Disclosed by EME and Key Systems</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-51" title="§ 11.2 Fingerprinting">§ 11.2 Fingerprinting</a> <a href="#ref-for-dfn-key-system-s-52" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-53" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> <a href="#ref-for-dfn-key-system-s-54" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-55" title="Reference 3">(3)</a> <a href="#ref-for-dfn-key-system-s-56" title="Reference 4">(4)</a> <a href="#ref-for-dfn-key-system-s-57" title="Reference 5">(5)</a> <a href="#ref-for-dfn-key-system-s-58" title="Reference 6">(6)</a> <a href="#ref-for-dfn-key-system-s-59" title="Reference 7">(7)</a> <a href="#ref-for-dfn-key-system-s-60" title="Reference 8">(8)</a> <a href="#ref-for-dfn-key-system-s-61" title="Reference 9">(9)</a> <a href="#ref-for-dfn-key-system-s-62" title="Reference 10">(10)</a> <a href="#ref-for-dfn-key-system-s-63" title="Reference 11">(11)</a> <a href="#ref-for-dfn-key-system-s-64" title="Reference 12">(12)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-65" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> <a href="#ref-for-dfn-key-system-s-66" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-67" title="Reference 3">(3)</a> <a href="#ref-for-dfn-key-system-s-68" title="Reference 4">(4)</a> <a href="#ref-for-dfn-key-system-s-69" title="Reference 5">(5)</a> <a href="#ref-for-dfn-key-system-s-70" title="Reference 6">(6)</a> <a href="#ref-for-dfn-key-system-s-71" title="Reference 7">(7)</a> <a href="#ref-for-dfn-key-system-s-72" title="Reference 8">(8)</a> <a href="#ref-for-dfn-key-system-s-73" title="Reference 9">(9)</a> <a href="#ref-for-dfn-key-system-s-74" title="Reference 10">(10)</a> <a href="#ref-for-dfn-key-system-s-75" title="Reference 11">(11)</a> <a href="#ref-for-dfn-key-system-s-76" title="Reference 12">(12)</a> <a href="#ref-for-dfn-key-system-s-77" title="Reference 13">(13)</a> <a href="#ref-for-dfn-key-system-s-78" title="Reference 14">(14)</a> <a href="#ref-for-dfn-key-system-s-79" title="Reference 15">(15)</a> <a href="#ref-for-dfn-key-system-s-80" title="Reference 16">(16)</a> <a href="#ref-for-dfn-key-system-s-81" title="Reference 17">(17)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-82" title="§ 11.5.1 Concerns">§ 11.5.1 Concerns</a> <a href="#ref-for-dfn-key-system-s-83" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-84" title="Reference 3">(3)</a> <a href="#ref-for-dfn-key-system-s-85" title="Reference 4">(4)</a> <a href="#ref-for-dfn-key-system-s-86" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-87" title="§ 11.6.1 Concerns">§ 11.6.1 Concerns</a> <a href="#ref-for-dfn-key-system-s-88" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-system-s-89" title="Reference 3">(3)</a> <a href="#ref-for-dfn-key-system-s-90" title="Reference 4">(4)</a> <a href="#ref-for-dfn-key-system-s-91" title="Reference 5">(5)</a> <a href="#ref-for-dfn-key-system-s-92" title="Reference 6">(6)</a> <a href="#ref-for-dfn-key-system-s-93" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-94" title="§ 11.7 Private Browsing Modes">§ 11.7 Private Browsing Modes</a> 
    </li><li>
      <a href="#ref-for-dfn-key-system-s-95" title="§ 13.2 Selecting a Supported Key System and Using Initialization Data from the &quot;encrypted&quot; Event">§ 13.2 Selecting a Supported Key System and Using Initialization Data from the "encrypted" Event</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-key-session" aria-label="Links in this document to definition: Key Session">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-key-session" aria-label="Permalink for definition: Key Session. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-key-session-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-key-session-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dfn-key-session-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-session-4" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-key-session-5" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-key-session-6" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-session-7" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-session-id" aria-label="Links in this document to definition: Session ID">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-session-id" aria-label="Permalink for definition: Session ID. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-session-id-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-session-id-2" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-session-id-3" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-session-id-4" title="§ 6.2 Methods">§ 6.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-session-id-5" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-key-s" aria-label="Links in this document to definition: Key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-key-s" aria-label="Permalink for definition: Key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-key-s-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-key-s-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-key-s-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-key-s-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-key-s-5" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-key-s-6" title="§ 9.1.4 License Format">§ 9.1.4 License Format</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-usable-for-decryption" aria-label="Links in this document to definition: Usable For Decryption">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-usable-for-decryption" aria-label="Permalink for definition: Usable For Decryption. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-usable-for-decryption-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-usable-for-decryption-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-usable-for-decryption-3" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> <a href="#ref-for-dfn-usable-for-decryption-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-usable-for-decryption-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-usable-for-decryption-6" title="Reference 4">(4)</a> <a href="#ref-for-dfn-usable-for-decryption-7" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-usable-for-decryption-8" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> <a href="#ref-for-dfn-usable-for-decryption-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-usable-for-decryption-10" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-usable-for-decryption-11" title="§ 7.5.6 Attempt to Resume Playback If Necessary">§ 7.5.6 Attempt to Resume Playback If Necessary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-decryption-key-id" aria-label="Links in this document to definition: Key ID">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-decryption-key-id" aria-label="Permalink for definition: Key ID. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-decryption-key-id-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-decryption-key-id-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-decryption-key-id-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-decryption-key-id-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-5" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-6" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-decryption-key-id-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-decryption-key-id-8" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-9" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-10" title="§ 6.3.2 Methods">§ 6.3.2 Methods</a> <a href="#ref-for-dfn-decryption-key-id-11" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-12" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-13" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-14" title="§ 9.1.3 License Request Format">§ 9.1.3 License Request Format</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-15" title="§ 9.1.4 License Format">§ 9.1.4 License Format</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-16" title="§ 9.1.5 License Release Format">§ 9.1.5 License Release Format</a> 
    </li><li>
      <a href="#ref-for-dfn-decryption-key-id-17" title="§ 9.1.6 License Release Acknowledgement Format">§ 9.1.6 License Release Acknowledgement Format</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-known" aria-label="Links in this document to definition: Known Key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-known" aria-label="Permalink for definition: Known Key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-known-1" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-known-2" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-known-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-known-4" title="§ 6.3.1 Attributes">§ 6.3.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-known-5" title="§ 6.3.2 Methods">§ 6.3.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-known-6" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> 
    </li><li>
      <a href="#ref-for-dfn-known-7" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> <a href="#ref-for-dfn-known-8" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-license" aria-label="Links in this document to definition: License">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-license" aria-label="Permalink for definition: License. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-license-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-license-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-initialization-data" aria-label="Links in this document to definition: Initialization Data">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-initialization-data" aria-label="Permalink for definition: Initialization Data. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-initialization-data-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-initialization-data-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-initialization-data-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-initialization-data-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-initialization-data-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-initialization-data-6" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-7" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-initialization-data-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-initialization-data-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-initialization-data-10" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-11" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> <a href="#ref-for-dfn-initialization-data-12" title="Reference 2">(2)</a> <a href="#ref-for-dfn-initialization-data-13" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-14" title="§ 7.3.1 Attributes">§ 7.3.1 Attributes</a> <a href="#ref-for-dfn-initialization-data-15" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-16" title="§ 7.3.2.1 Dictionary MediaEncryptedEventInit Members">§ 7.3.2.1 Dictionary MediaEncryptedEventInit Members</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-17" title="§ 7.4 Event Summary">§ 7.4 Event Summary</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-18" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-19" title="§ 8.8.2 Support Extraction From Media Data">§ 8.8.2 Support Extraction From Media Data</a> <a href="#ref-for-dfn-initialization-data-20" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-21" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-22" title="§ 10.1 Input Data Attacks and Vulnerabilities">§ 10.1 Input Data Attacks and Vulnerabilities</a> <a href="#ref-for-dfn-initialization-data-23" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-24" title="§ 13.2 Selecting a Supported Key System and Using Initialization Data from the &quot;encrypted&quot; Event">§ 13.2 Selecting a Supported Key System and Using Initialization Data from the "encrypted" Event</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-25" title="§ 13.3 Create MediaKeys Before Loading Media">§ 13.3 Create MediaKeys Before Loading Media</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-initialization-data-type" aria-label="Links in this document to definition: Initialization Data Type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-initialization-data-type" aria-label="Permalink for definition: Initialization Data Type. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-initialization-data-type-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-initialization-data-type-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-type-3" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dfn-initialization-data-type-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-type-5" title="§ 6.2 Methods">§ 6.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-type-6" title="§ 7.3.1 Attributes">§ 7.3.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-type-7" title="§ 7.3.2.1 Dictionary MediaEncryptedEventInit Members">§ 7.3.2.1 Dictionary MediaEncryptedEventInit Members</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-type-8" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-type-9" title="§ 8.8.1 Licenses Generated are Independent of Content Type">§ 8.8.1 Licenses Generated are Independent of Content Type</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-type-10" title="§ 8.8.2 Support Extraction From Media Data">§ 8.8.2 Support Extraction From Media Data</a> <a href="#ref-for-dfn-initialization-data-type-11" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-associable" aria-label="Links in this document to definition: Associable Value">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-associable" aria-label="Permalink for definition: Associable Value. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-associable-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-associable-2" title="§ 8.6.1 Direct Individualization">§ 8.6.1 Direct Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-associable-3" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> <a href="#ref-for-dfn-associable-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-associable-5" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> 
    </li><li>
      <a href="#ref-for-dfn-associable-6" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-non-associable" aria-label="Links in this document to definition: non-associable">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-non-associable" aria-label="Permalink for definition: non-associable. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-non-associable-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-non-associable-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-associable-by-an-entity" aria-label="Links in this document to definition: associable by an entity">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-associable-by-an-entity" aria-label="Permalink for definition: associable by an entity. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-associable-by-an-entity-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-associable-by-an-entity-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-associable-by-an-entity-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-associable-by-an-entity-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-associable-by-an-entity-5" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-non-associable-by-an-entity" aria-label="Links in this document to definition: non-associable by an entity">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-non-associable-by-an-entity" aria-label="Permalink for definition: non-associable by an entity. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-non-associable-by-an-entity-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-non-associable-by-application" aria-label="Links in this document to definition: non-associable by the application">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-non-associable-by-application" aria-label="Permalink for definition: non-associable by the application. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-non-associable-by-application-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-non-associable-by-application-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-non-associable-by-application-3" title="§ 8.4.1 Use Per-Origin Per-Profile Values">§ 8.4.1 Use Per-Origin Per-Profile Values</a> 
    </li><li>
      <a href="#ref-for-dfn-non-associable-by-application-4" title="§ 8.4.2 Allow Values to Be Cleared">§ 8.4.2 Allow Values to Be Cleared</a> 
    </li><li>
      <a href="#ref-for-dfn-non-associable-by-application-5" title="§ 8.5.4 Use Non-Associable Identifiers">§ 8.5.4 Use Non-Associable Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-non-associable-by-application-6" title="§ 8.5.5 Allow Identifiers to Be Cleared">§ 8.5.5 Allow Identifiers to Be Cleared</a> 
    </li><li>
      <a href="#ref-for-dfn-non-associable-by-application-7" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-non-associable-by-application-8" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-associable-by-the-application" aria-label="Links in this document to definition: associable by the application">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-associable-by-the-application" aria-label="Permalink for definition: associable by the application. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-associable-by-the-application-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-associable-by-the-application-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-associable-by-the-application-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-associable-by-the-application-4" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-distinctive" aria-label="Links in this document to definition: Distinctive Value">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-distinctive" aria-label="Permalink for definition: Distinctive Value. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-distinctive-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-distinctive-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-3" title="§ 8.4.1 Use Per-Origin Per-Profile Values">§ 8.4.1 Use Per-Origin Per-Profile Values</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-4" title="§ 8.5 Identifiers">§ 8.5 Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-5" title="§ 8.5.5 Allow Identifiers to Be Cleared">§ 8.5.5 Allow Identifiers to Be Cleared</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-6" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permanent-identifier-s" aria-label="Links in this document to definition: Permanent Identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permanent-identifier-s" aria-label="Permalink for definition: Permanent Identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-permanent-identifier-s-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-permanent-identifier-s-2" title="§ 8.5 Identifiers">§ 8.5 Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-permanent-identifier-s-3" title="§ 8.6.1 Direct Individualization">§ 8.6.1 Direct Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-permanent-identifier-s-4" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-distinctive-permanent-identifier-s" aria-label="Links in this document to definition: Distinctive Permanent Identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-distinctive-permanent-identifier-s" aria-label="Permalink for definition: Distinctive Permanent Identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-11" title="Reference 11">(11)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-12" title="Reference 12">(12)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-13" title="Reference 13">(13)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-14" title="Reference 14">(14)</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-15" title="Reference 15">(15)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-16" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-17" title="§ 3.2.2.4 Get Consent Status">§ 3.2.2.4 Get Consent Status</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-18" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-19" title="§ 6.6.1 Queue a &quot;message&quot; Event">§ 6.6.1 Queue a "message" Event</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-20" title="§ 8.5 Identifiers">§ 8.5 Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-21" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-22" title="§ 8.5.3 Use Per-Origin Per-Profile Identifiers">§ 8.5.3 Use Per-Origin Per-Profile Identifiers</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-23" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-24" title="§ 8.5.5 Allow Identifiers to Be Cleared">§ 8.5.5 Allow Identifiers to Be Cleared</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-25" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-26" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-27" title="§ 8.6.1 Direct Individualization">§ 8.6.1 Direct Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-28" title="§ 10.3.1 Potential Attacks">§ 10.3.1 Potential Attacks</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-29" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-30" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-31" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-permanent-identifier-s-32" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> <a href="#ref-for-dfn-distinctive-permanent-identifier-s-33" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-distinctive-identifier-s" aria-label="Links in this document to definition: Distinctive Identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-distinctive-identifier-s" aria-label="Permalink for definition: Distinctive Identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-distinctive-identifier-s-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-distinctive-identifier-s-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-distinctive-identifier-s-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-distinctive-identifier-s-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-5" title="§ 3.2.2.1 Get Supported Configuration">§ 3.2.2.1 Get Supported Configuration</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-6" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dfn-distinctive-identifier-s-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-distinctive-identifier-s-8" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-9" title="§ 3.2.2.4 Get Consent Status">§ 3.2.2.4 Get Consent Status</a> <a href="#ref-for-dfn-distinctive-identifier-s-10" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-11" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dfn-distinctive-identifier-s-12" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-13" title="§ 6.6.1 Queue a &quot;message&quot; Event">§ 6.6.1 Queue a "message" Event</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-14" title="§ 8.3 Persistent Data">§ 8.3 Persistent Data</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-15" title="§ 8.5 Identifiers">§ 8.5 Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-16" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> <a href="#ref-for-dfn-distinctive-identifier-s-17" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-18" title="§ 8.5.3 Use Per-Origin Per-Profile Identifiers">§ 8.5.3 Use Per-Origin Per-Profile Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-19" title="§ 8.5.4 Use Non-Associable Identifiers">§ 8.5.4 Use Non-Associable Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-20" title="§ 8.5.5 Allow Identifiers to Be Cleared">§ 8.5.5 Allow Identifiers to Be Cleared</a> <a href="#ref-for-dfn-distinctive-identifier-s-21" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-22" title="§ 8.6 Individualization">§ 8.6 Individualization</a> <a href="#ref-for-dfn-distinctive-identifier-s-23" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-24" title="§ 8.6.1 Direct Individualization">§ 8.6.1 Direct Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-25" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> <a href="#ref-for-dfn-distinctive-identifier-s-26" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-27" title="§ 10.3.1 Potential Attacks">§ 10.3.1 Potential Attacks</a> <a href="#ref-for-dfn-distinctive-identifier-s-28" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-29" title="§ 10.5 Cross-Directory Attacks">§ 10.5 Cross-Directory Attacks</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-30" title="§ 11.3.2 Mitigations">§ 11.3.2 Mitigations</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-31" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> <a href="#ref-for-dfn-distinctive-identifier-s-32" title="Reference 2">(2)</a> <a href="#ref-for-dfn-distinctive-identifier-s-33" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-34" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> <a href="#ref-for-dfn-distinctive-identifier-s-35" title="Reference 2">(2)</a> <a href="#ref-for-dfn-distinctive-identifier-s-36" title="Reference 3">(3)</a> <a href="#ref-for-dfn-distinctive-identifier-s-37" title="Reference 4">(4)</a> <a href="#ref-for-dfn-distinctive-identifier-s-38" title="Reference 5">(5)</a> <a href="#ref-for-dfn-distinctive-identifier-s-39" title="Reference 6">(6)</a> <a href="#ref-for-dfn-distinctive-identifier-s-40" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-distinctive-identifier-s-41" title="§ 11.6.1 Concerns">§ 11.6.1 Concerns</a> <a href="#ref-for-dfn-distinctive-identifier-s-42" title="Reference 2">(2)</a> <a href="#ref-for-dfn-distinctive-identifier-s-43" title="Reference 3">(3)</a> <a href="#ref-for-dfn-distinctive-identifier-s-44" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-use-of-distinctive-identifiers-and-distinctive-permanent-identifiers" aria-label="Links in this document to definition: Use of Distinctive Identifiers and Distinctive Permanent Identifiers">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-use-of-distinctive-identifiers-and-distinctive-permanent-identifiers" aria-label="Permalink for definition: Use of Distinctive Identifiers and Distinctive Permanent Identifiers. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-use-distinctive-identifier-s" aria-label="Links in this document to definition: uses Distinctive Identifier(s)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-use-distinctive-identifier-s" aria-label="Permalink for definition: uses Distinctive Identifier(s). Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-2" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-3" title="§ 8.5.5 Allow Identifiers to Be Cleared">§ 8.5.5 Allow Identifiers to Be Cleared</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-4" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-5" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-8" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-9" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-use-distinctive-permanent-identifier-s" aria-label="Links in this document to definition: uses Distinctive Permanent Identifier(s)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-use-distinctive-permanent-identifier-s" aria-label="Permalink for definition: uses Distinctive Permanent Identifier(s). Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-use-distinctive-permanent-identifier-s-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-permanent-identifier-s-2" title="§ 8.5.5 Allow Identifiers to Be Cleared">§ 8.5.5 Allow Identifiers to Be Cleared</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-permanent-identifier-s-3" title="§ 8.6.1 Direct Individualization">§ 8.6.1 Direct Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-permanent-identifier-s-4" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> <a href="#ref-for-dfn-use-distinctive-permanent-identifier-s-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" aria-label="Links in this document to definition: uses Distinctive Identifier(s) or Distinctive Permanent Identifier(s)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s" aria-label="Permalink for definition: uses Distinctive Identifier(s) or Distinctive Permanent Identifier(s). Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-3" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-4" title="§ 4.2 Methods">§ 4.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-5" title="§ 8.5 Identifiers">§ 8.5 Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-6" title="§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers">§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-8" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-9" title="§ 8.6 Individualization">§ 8.6 Individualization</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-10" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-11" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-12" title="Reference 2">(2)</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-13" title="Reference 3">(3)</a> <a href="#ref-for-dfn-use-distinctive-identifier-s-or-distinctive-permanent-identifier-s-14" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cross-origin-limitations" aria-label="Links in this document to definition: Cross Origin Limitations">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cross-origin-limitations" aria-label="Permalink for definition: Cross Origin Limitations. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-mixed-content-limitations" aria-label="Links in this document to definition: Mixed Content Limitations">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-mixed-content-limitations" aria-label="Permalink for definition: Mixed Content Limitations. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-mixed-content-limitations-1" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> <a href="#ref-for-dfn-mixed-content-limitations-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-time" aria-label="Links in this document to definition: Time">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-time" aria-label="Permalink for definition: Time. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-time-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-time-2" title="§ 6.6.3 Update Expiration">§ 6.6.3 Update Expiration</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-expiration" aria-label="Links in this document to definition: Expiration Time">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-expiration" aria-label="Permalink for definition: Expiration Time. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-expiration-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-expiration-2" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-expiration-3" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-expiration-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-expiration-5" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-expiration-6" title="§ 6.6.3 Update Expiration">§ 6.6.3 Update Expiration</a> 
    </li><li>
      <a href="#ref-for-dfn-expiration-7" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-browsing-profile" aria-label="Links in this document to definition: Browsing Profile">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-browsing-profile" aria-label="Permalink for definition: Browsing Profile. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-browsing-profile-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-2" title="§ 5.3 Storage and Persistence">§ 5.3 Storage and Persistence</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-3" title="§ 8.3.1 Use origin-specific and browsing profile-specific Key System storage">§ 8.3.1 Use origin-specific and browsing profile-specific Key System storage</a> <a href="#ref-for-dfn-browsing-profile-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-5" title="§ 8.3.2 Allow Persistent Data to Be Cleared">§ 8.3.2 Allow Persistent Data to Be Cleared</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-6" title="§ 8.4.1 Use Per-Origin Per-Profile Values">§ 8.4.1 Use Per-Origin Per-Profile Values</a> <a href="#ref-for-dfn-browsing-profile-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-8" title="§ 8.5.3 Use Per-Origin Per-Profile Identifiers">§ 8.5.3 Use Per-Origin Per-Profile Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-9" title="§ 8.5.4 Use Non-Associable Identifiers">§ 8.5.4 Use Non-Associable Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-10" title="§ 10.3.2 Mitigations">§ 10.3.2 Mitigations</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-11" title="§ 11.3.1 Concerns">§ 11.3.1 Concerns</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-12" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> <a href="#ref-for-dfn-browsing-profile-13" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-14" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> <a href="#ref-for-dfn-browsing-profile-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-browsing-profile-16" title="Reference 3">(3)</a> <a href="#ref-for-dfn-browsing-profile-17" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-browsing-profile-18" title="§ 11.5.1 Concerns">§ 11.5.1 Concerns</a> <a href="#ref-for-dfn-browsing-profile-19" title="Reference 2">(2)</a> <a href="#ref-for-dfn-browsing-profile-20" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-valid-media-mime-type" aria-label="Links in this document to definition: Valid Media MIME Type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-valid-media-mime-type" aria-label="Permalink for definition: Valid Media MIME Type. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-valid-media-mime-type-1" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> 
    </li><li>
      <a href="#ref-for-dfn-valid-media-mime-type-2" title="§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members">§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-encrypted-media" aria-label="Links in this document to definition: encrypted-media">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-encrypted-media" aria-label="Permalink for definition: encrypted-media. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-encrypted-media-1" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-navigator" aria-label="Links in this document to definition: Navigator">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-navigator" aria-label="Permalink for definition: Navigator. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-navigator-1" title="§ 3.2 Navigator Extension: requestMediaKeySystemAccess()">§ 3.2 Navigator Extension: requestMediaKeySystemAccess()</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-navigator-requestmediakeysystemaccess" aria-label="Links in this document to definition: requestMediaKeySystemAccess()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-navigator-requestmediakeysystemaccess" aria-label="Permalink for definition: requestMediaKeySystemAccess(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-571417346">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-1" title="§ 3.1 Permissions Policy Integration">§ 3.1 Permissions Policy Integration</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-2" title="§ 3.2 Navigator Extension: requestMediaKeySystemAccess()">§ 3.2 Navigator Extension: requestMediaKeySystemAccess()</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-3" title="§ 3.2.2.1 Get Supported Configuration">§ 3.2.2.1 Get Supported Configuration</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-4" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-5" title="Reference 2">(2)</a> <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-6" title="Reference 3">(3)</a> <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-7" title="Reference 4">(4)</a> <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-8" title="Reference 5">(5)</a> <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-9" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-10" title="§ 4.2 Methods">§ 4.2 Methods</a> <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-11" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-12" title="§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers">§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-13" title="§ 8.8.1 Licenses Generated are Independent of Content Type">§ 8.8.1 Licenses Generated are Independent of Content Type</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-14" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> 
    </li><li>
      <a href="#ref-for-dom-navigator-requestmediakeysystemaccess-15" title="§ 13.2 Selecting a Supported Key System and Using Initialization Data from the &quot;encrypted&quot; Event">§ 13.2 Selecting a Supported Key System and Using Initialization Data from the "encrypted" Event</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-get-supported-configuration" aria-label="Links in this document to definition: Get Supported Configuration">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-get-supported-configuration" aria-label="Permalink for definition: Get Supported Configuration. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-get-supported-configuration-1" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-get-supported-configuration-and-consent" aria-label="Links in this document to definition: Get Supported Configuration and Consent">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-get-supported-configuration-and-consent" aria-label="Permalink for definition: Get Supported Configuration and Consent. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-get-supported-configuration-and-consent-1" title="§ 3.2.2.1 Get Supported Configuration">§ 3.2.2.1 Get Supported Configuration</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-get-supported-capabilities-for-audio-video-type" aria-label="Links in this document to definition: Get Supported Capabilities for Audio/Video Type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-get-supported-capabilities-for-audio-video-type" aria-label="Permalink for definition: Get Supported Capabilities for Audio/Video Type. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-get-supported-capabilities-for-audio-video-type-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dfn-get-supported-capabilities-for-audio-video-type-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-get-consent-status" aria-label="Links in this document to definition: Get Consent Status">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-get-consent-status" aria-label="Permalink for definition: Get Consent Status. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-get-consent-status-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration" aria-label="Links in this document to definition: MediaKeySystemConfiguration">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration" aria-label="Permalink for definition: MediaKeySystemConfiguration. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-1" title="§ 3.2 Navigator Extension: requestMediaKeySystemAccess()">§ 3.2 Navigator Extension: requestMediaKeySystemAccess()</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-2" title="§ 3.2.2.1 Get Supported Configuration">§ 3.2.2.1 Get Supported Configuration</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-3" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-5" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-6" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysystemconfiguration-7" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-8" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-9" title="§ 4. MediaKeySystemAccess Interface">§ 4. MediaKeySystemAccess Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-10" title="§ 4.2 Methods">§ 4.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-11" title="§ 8.8.1 Licenses Generated are Independent of Content Type">§ 8.8.1 Licenses Generated are Independent of Content Type</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-12" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysrequirement" aria-label="Links in this document to definition: MediaKeysRequirement">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysrequirement" aria-label="Permalink for definition: MediaKeysRequirement. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1197737164">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysrequirement-1" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysrequirement-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysrequirement-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysrequirement-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysrequirement-5" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysrequirement-6" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-7" title="§ 4.2 Methods">§ 4.2 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysrequirement-required" aria-label="Links in this document to definition: required">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysrequirement-required" aria-label="Permalink for definition: required. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1197737164">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysrequirement-required-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dom-mediakeysrequirement-required-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysrequirement-required-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-4" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysrequirement-required-5" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysrequirement-required-6" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysrequirement-required-7" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysrequirement-required-8" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysrequirement-required-9" title="Reference 6">(6)</a> <a href="#ref-for-dom-mediakeysrequirement-required-10" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-11" title="§ 3.2.2.4 Get Consent Status">§ 3.2.2.4 Get Consent Status</a> <a href="#ref-for-dom-mediakeysrequirement-required-12" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-13" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysrequirement-required-14" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-15" title="§ 4.2 Methods">§ 4.2 Methods</a> <a href="#ref-for-dom-mediakeysrequirement-required-16" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-17" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-18" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-19" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> <a href="#ref-for-dom-mediakeysrequirement-required-20" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-required-21" title="§ 11.7 Private Browsing Modes">§ 11.7 Private Browsing Modes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysrequirement-optional" aria-label="Links in this document to definition: optional">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysrequirement-optional" aria-label="Permalink for definition: optional. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1197737164">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysrequirement-optional-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysrequirement-optional-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysrequirement-optional-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysrequirement-optional-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysrequirement-optional-5" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysrequirement-optional-6" title="Reference 6">(6)</a> <a href="#ref-for-dom-mediakeysrequirement-optional-7" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-optional-8" title="§ 3.2.2.4 Get Consent Status">§ 3.2.2.4 Get Consent Status</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-optional-9" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysrequirement-optional-10" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-optional-11" title="§ 4.2 Methods">§ 4.2 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysrequirement-not-allowed" aria-label="Links in this document to definition: not-allowed">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysrequirement-not-allowed" aria-label="Permalink for definition: not-allowed. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1197737164">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysrequirement-not-allowed-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-5" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-6" title="Reference 6">(6)</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-7" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-not-allowed-8" title="§ 3.2.2.4 Get Consent Status">§ 3.2.2.4 Get Consent Status</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-9" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-10" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-not-allowed-11" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-12" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysrequirement-not-allowed-13" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysrequirement-not-allowed-14" title="§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers">§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration-label" aria-label="Links in this document to definition: label">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration-label" aria-label="Permalink for definition: label. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-label-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-label-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-label-3" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration-initdatatypes" aria-label="Links in this document to definition: initDataTypes">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration-initdatatypes" aria-label="Permalink for definition: initDataTypes. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-initdatatypes-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-initdatatypes-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-initdatatypes-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-initdatatypes-4" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-initdatatypes-5" title="§ 8.8.1 Licenses Generated are Independent of Content Type">§ 8.8.1 Licenses Generated are Independent of Content Type</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration-audiocapabilities" aria-label="Links in this document to definition: audioCapabilities">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration-audiocapabilities" aria-label="Permalink for definition: audioCapabilities. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-5" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-6" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-7" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysystemconfiguration-audiocapabilities-8" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration-videocapabilities" aria-label="Links in this document to definition: videoCapabilities">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration-videocapabilities" aria-label="Permalink for definition: videoCapabilities. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-5" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-6" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-7" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-8" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-videocapabilities-9" title="§ 8.8.1 Licenses Generated are Independent of Content Type">§ 8.8.1 Licenses Generated are Independent of Content Type</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration-distinctiveidentifier" aria-label="Links in this document to definition: distinctiveIdentifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration-distinctiveidentifier" aria-label="Permalink for definition: distinctiveIdentifier. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-5" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-6" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-7" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-8" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-9" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-10" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-11" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-12" title="Reference 6">(6)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-13" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-14" title="§ 3.2.2.4 Get Consent Status">§ 3.2.2.4 Get Consent Status</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-15" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-16" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-17" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-18" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-19" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-20" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-21" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-22" title="§ 4.2 Methods">§ 4.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-23" title="§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers">§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-24" title="§ 8.6 Individualization">§ 8.6 Individualization</a> <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-25" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-26" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-distinctiveidentifier-27" title="§ 11.7 Private Browsing Modes">§ 11.7 Private Browsing Modes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration-persistentstate" aria-label="Links in this document to definition: persistentState">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration-persistentstate" aria-label="Permalink for definition: persistentState. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-5" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-6" title="Reference 6">(6)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-7" title="Reference 7">(7)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-8" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-9" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-10" title="§ 4.2 Methods">§ 4.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-11" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-12" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-persistentstate-13" title="§ 11.7 Private Browsing Modes">§ 11.7 Private Browsing Modes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemconfiguration-sessiontypes" aria-label="Links in this document to definition: sessionTypes">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemconfiguration-sessiontypes" aria-label="Permalink for definition: sessionTypes. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-798704963">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-sessiontypes-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dom-mediakeysystemconfiguration-sessiontypes-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemconfiguration-sessiontypes-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-sessiontypes-4" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemconfiguration-sessiontypes-5" title="§ 4.2 Methods">§ 4.2 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemmediacapability" aria-label="Links in this document to definition: MediaKeySystemMediaCapability">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemmediacapability" aria-label="Permalink for definition: MediaKeySystemMediaCapability. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1151374081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-1" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> <a href="#ref-for-dom-mediakeysystemmediacapability-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemmediacapability-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemmediacapability-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-5" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysystemmediacapability-6" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemmediacapability-7" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemmediacapability-8" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-9" title="§ 3.4 MediaKeySystemMediaCapability dictionary">§ 3.4 MediaKeySystemMediaCapability dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-10" title="§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members">§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemmediacapability-contenttype" aria-label="Links in this document to definition: contentType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemmediacapability-contenttype" aria-label="Permalink for definition: contentType. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1151374081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-contenttype-1" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-contenttype-2" title="§ 3.4 MediaKeySystemMediaCapability dictionary">§ 3.4 MediaKeySystemMediaCapability dictionary</a> <a href="#ref-for-dom-mediakeysystemmediacapability-contenttype-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemmediacapability-encryptionscheme" aria-label="Links in this document to definition: encryptionScheme">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemmediacapability-encryptionscheme" aria-label="Permalink for definition: encryptionScheme. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1151374081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-encryptionscheme-1" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-encryptionscheme-2" title="§ 3.4 MediaKeySystemMediaCapability dictionary">§ 3.4 MediaKeySystemMediaCapability dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-encryptionscheme-3" title="§ 4.2 Methods">§ 4.2 Methods</a> <a href="#ref-for-dom-mediakeysystemmediacapability-encryptionscheme-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-encryptionscheme-5" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-scheme-cenc" aria-label="Links in this document to definition: cenc">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#scheme-cenc" aria-label="Permalink for definition: cenc. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-scheme-cenc-1" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-scheme-cbcs" aria-label="Links in this document to definition: cbcs">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#scheme-cbcs" aria-label="Permalink for definition: cbcs. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-scheme-cbcs-1" title="§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members">§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cbcs-1-9" aria-label="Links in this document to definition: cbcs-1-9">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cbcs-1-9" aria-label="Permalink for definition: cbcs-1-9. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemmediacapability-robustness" aria-label="Links in this document to definition: robustness">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemmediacapability-robustness" aria-label="Permalink for definition: robustness. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1151374081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-robustness-1" title="§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type">§ 3.2.2.3 Get Supported Capabilities for Audio/Video Type</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-robustness-2" title="§ 3.4 MediaKeySystemMediaCapability dictionary">§ 3.4 MediaKeySystemMediaCapability dictionary</a> <a href="#ref-for-dom-mediakeysystemmediacapability-robustness-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemmediacapability-robustness-4" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemaccess" aria-label="Links in this document to definition: MediaKeySystemAccess">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemaccess" aria-label="Permalink for definition: MediaKeySystemAccess. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1780138428">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemaccess-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dom-mediakeysystemaccess-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemaccess-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-4" title="§ 3.2 Navigator Extension: requestMediaKeySystemAccess()">§ 3.2 Navigator Extension: requestMediaKeySystemAccess()</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-5" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> <a href="#ref-for-dom-mediakeysystemaccess-6" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemaccess-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-8" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysystemaccess-9" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysystemaccess-10" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysystemaccess-11" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-12" title="§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members">§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-13" title="§ 4. MediaKeySystemAccess Interface">§ 4. MediaKeySystemAccess Interface</a> <a href="#ref-for-dom-mediakeysystemaccess-14" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-15" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-16" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-17" title="§ 11.7 Private Browsing Modes">§ 11.7 Private Browsing Modes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemaccess-keysystem" aria-label="Links in this document to definition: keySystem">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemaccess-keysystem" aria-label="Permalink for definition: keySystem. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1780138428">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemaccess-keysystem-1" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-keysystem-2" title="§ 4. MediaKeySystemAccess Interface">§ 4. MediaKeySystemAccess Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemaccess-getconfiguration" aria-label="Links in this document to definition: getConfiguration()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemaccess-getconfiguration" aria-label="Permalink for definition: getConfiguration(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1780138428">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemaccess-getconfiguration-1" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysystemaccess-getconfiguration-2" title="§ 4. MediaKeySystemAccess Interface">§ 4. MediaKeySystemAccess Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysystemaccess-createmediakeys" aria-label="Links in this document to definition: createMediaKeys()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysystemaccess-createmediakeys" aria-label="Permalink for definition: createMediaKeys(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1780138428">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysystemaccess-createmediakeys-1" title="§ 4. MediaKeySystemAccess Interface">§ 4. MediaKeySystemAccess Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeys" aria-label="Links in this document to definition: MediaKeys">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeys" aria-label="Permalink for definition: MediaKeys. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-742597615">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeys-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dom-mediakeys-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeys-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeys-4" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeys-5" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeys-6" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-7" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-8" title="§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members">§ 3.4.1 Dictionary MediaKeySystemMediaCapability Members</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-9" title="§ 4. MediaKeySystemAccess Interface">§ 4. MediaKeySystemAccess Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-10" title="§ 4.2 Methods">§ 4.2 Methods</a> <a href="#ref-for-dom-mediakeys-11" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-12" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> <a href="#ref-for-dom-mediakeys-13" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeys-14" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-15" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-16" title="§ 5.2.2 CDM Unavailable">§ 5.2.2 CDM Unavailable</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-17" title="§ 5.3 Storage and Persistence">§ 5.3 Storage and Persistence</a> <a href="#ref-for-dom-mediakeys-18" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-19" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dom-mediakeys-20" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeys-21" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeys-22" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-23" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-24" title="§ 6.7 Exceptions">§ 6.7 Exceptions</a> <a href="#ref-for-dom-mediakeys-25" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeys-26" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-27" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> <a href="#ref-for-dom-mediakeys-28" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-29" title="§ 7.1 Attributes">§ 7.1 Attributes</a> <a href="#ref-for-dom-mediakeys-30" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-31" title="§ 7.2 Methods">§ 7.2 Methods</a> <a href="#ref-for-dom-mediakeys-32" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-33" title="§ 7.5.1 Media Data May Contain Encrypted Blocks">§ 7.5.1 Media Data May Contain Encrypted Blocks</a> <a href="#ref-for-dom-mediakeys-34" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeys-35" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeys-36" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-37" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-38" title="§ 8.3 Persistent Data">§ 8.3 Persistent Data</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-39" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-40" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-41" title="§ 11.3.2 Mitigations">§ 11.3.2 Mitigations</a> <a href="#ref-for-dom-mediakeys-42" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeys-43" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeys-44" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeys-45" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeys-46" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-47" title="§ 13.3 Create MediaKeys Before Loading Media">§ 13.3 Create MediaKeys Before Loading Media</a> <a href="#ref-for-dom-mediakeys-48" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessiontype" aria-label="Links in this document to definition: MediaKeySessionType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessiontype" aria-label="Permalink for definition: MediaKeySessionType. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-2083600463">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessiontype-1" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-2" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> <a href="#ref-for-dom-mediakeysessiontype-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-4" title="§ 5.2.1 Is persistent session type?">§ 5.2.1 Is persistent session type?</a> <a href="#ref-for-dom-mediakeysessiontype-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-6" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-7" title="§ 9.1.3 License Request Format">§ 9.1.3 License Request Format</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-8" title="§ 9.1.4 License Format">§ 9.1.4 License Format</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessiontype-temporary" aria-label="Links in this document to definition: temporary">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessiontype-temporary" aria-label="Permalink for definition: temporary. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-2083600463">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-1" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-2" title="§ 3.3 MediaKeySystemConfiguration dictionary">§ 3.3 MediaKeySystemConfiguration dictionary</a> <a href="#ref-for-dom-mediakeysessiontype-temporary-3" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysessiontype-temporary-4" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysessiontype-temporary-5" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-6" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-7" title="§ 5.2.1 Is persistent session type?">§ 5.2.1 Is persistent session type?</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-8" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeysessiontype-temporary-9" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysessiontype-temporary-10" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-11" title="§ 6.7 Exceptions">§ 6.7 Exceptions</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-12" title="§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers">§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-13" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-temporary-14" title="§ 9.1.4 License Format">§ 9.1.4 License Format</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessiontype-persistent-license" aria-label="Links in this document to definition: persistent-license">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessiontype-persistent-license" aria-label="Permalink for definition: persistent-license. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-2083600463">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-2" title="§ 5.2.1 Is persistent session type?">§ 5.2.1 Is persistent session type?</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-3" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeysessiontype-persistent-license-4" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysessiontype-persistent-license-5" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysessiontype-persistent-license-6" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-7" title="§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers">§ 8.5.1 Limit or Avoid use of Distinctive Identifiers and Permanent Identifiers</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-8" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-9" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-10" title="§ 9.1.5 License Release Format">§ 9.1.5 License Release Format</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessiontype-persistent-license-11" title="§ 9.1.5.1 Example message reflecting a record of license destruction">§ 9.1.5.1 Example message reflecting a record of license destruction</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-record-s-of-license-destruction" aria-label="Links in this document to definition: record of license destruction">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-record-s-of-license-destruction" aria-label="Permalink for definition: record of license destruction. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-2" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> <a href="#ref-for-dfn-record-s-of-license-destruction-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-4" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-5" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-record-s-of-license-destruction-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-record-s-of-license-destruction-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-8" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-9" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-10" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dfn-record-s-of-license-destruction-11" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-12" title="§ 8.3 Persistent Data">§ 8.3 Persistent Data</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-13" title="§ 9.1.5.1 Example message reflecting a record of license destruction">§ 9.1.5.1 Example message reflecting a record of license destruction</a> 
    </li><li>
      <a href="#ref-for-dfn-record-s-of-license-destruction-14" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> <a href="#ref-for-dfn-record-s-of-license-destruction-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-record-s-of-license-destruction-16" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeys-createsession" aria-label="Links in this document to definition: createSession()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeys-createsession" aria-label="Permalink for definition: createSession(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-742597615">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeys-createsession-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeys-getstatusforpolicy" aria-label="Links in this document to definition: getStatusForPolicy()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeys-getstatusforpolicy" aria-label="Permalink for definition: getStatusForPolicy(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-742597615">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeys-getstatusforpolicy-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeyspolicy" aria-label="Links in this document to definition: MediaKeysPolicy">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeyspolicy" aria-label="Permalink for definition: MediaKeysPolicy. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeyspolicy-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeyspolicy-2" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dom-mediakeyspolicy-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeyspolicy-minhdcpversion" aria-label="Links in this document to definition: minHdcpVersion">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeyspolicy-minhdcpversion" aria-label="Permalink for definition: minHdcpVersion. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeyspolicy-minhdcpversion-1" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dom-mediakeyspolicy-minhdcpversion-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion" aria-label="Links in this document to definition: HDCPVersion">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion" aria-label="Permalink for definition: HDCPVersion. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-hdcpversion-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-1.0" aria-label="Links in this document to definition: 1.0">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-1.0" aria-label="Permalink for definition: 1.0. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-1.1" aria-label="Links in this document to definition: 1.1">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-1.1" aria-label="Permalink for definition: 1.1. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-1.2" aria-label="Links in this document to definition: 1.2">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-1.2" aria-label="Permalink for definition: 1.2. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-1.3" aria-label="Links in this document to definition: 1.3">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-1.3" aria-label="Permalink for definition: 1.3. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-1.4" aria-label="Links in this document to definition: 1.4">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-1.4" aria-label="Permalink for definition: 1.4. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-2.0" aria-label="Links in this document to definition: 2.0">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-2.0" aria-label="Permalink for definition: 2.0. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-2.1" aria-label="Links in this document to definition: 2.1">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-2.1" aria-label="Permalink for definition: 2.1. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-2.2" aria-label="Links in this document to definition: 2.2">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-2.2" aria-label="Permalink for definition: 2.2. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-hdcpversion-2.3" aria-label="Links in this document to definition: 2.3">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-hdcpversion-2.3" aria-label="Permalink for definition: 2.3. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeys-setservercertificate" aria-label="Links in this document to definition: setServerCertificate()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeys-setservercertificate" aria-label="Permalink for definition: setServerCertificate(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-742597615">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeys-setservercertificate-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeys-setservercertificate-2" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-is-persistent-session-type" aria-label="Links in this document to definition: Is persistent session type?">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-is-persistent-session-type" aria-label="Permalink for definition: Is persistent session type?. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-is-persistent-session-type-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dfn-is-persistent-session-type-2" title="§ 3.2.2.2 Get Supported Configuration and Consent">§ 3.2.2.2 Get Supported Configuration and Consent</a> <a href="#ref-for-dfn-is-persistent-session-type-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-is-persistent-session-type-4" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-is-persistent-session-type-5" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-is-persistent-session-type-6" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-is-persistent-session-type-7" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dfn-is-persistent-session-type-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-is-persistent-session-type-9" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cdm-unavailable" aria-label="Links in this document to definition: CDM Unavailable">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cdm-unavailable" aria-label="Permalink for definition: CDM Unavailable. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-cdm-unavailable-1" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li><li>
      <a href="#ref-for-dfn-cdm-unavailable-2" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> <a href="#ref-for-dfn-cdm-unavailable-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-storage-and-persistence" aria-label="Links in this document to definition: Storage and Persistence">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-storage-and-persistence" aria-label="Permalink for definition: Storage and Persistence. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-storage-and-persistence-1" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession" aria-label="Links in this document to definition: MediaKeySession">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession" aria-label="Permalink for definition: MediaKeySession. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dom-mediakeysession-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-4" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-5" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dom-mediakeysession-6" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-7" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysession-8" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-9" title="§ 5.2.2 CDM Unavailable">§ 5.2.2 CDM Unavailable</a> <a href="#ref-for-dom-mediakeysession-10" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-11" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dom-mediakeysession-12" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-13" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysession-14" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysession-15" title="Reference 5">(5)</a> <a href="#ref-for-dom-mediakeysession-16" title="Reference 6">(6)</a> <a href="#ref-for-dom-mediakeysession-17" title="Reference 7">(7)</a> <a href="#ref-for-dom-mediakeysession-18" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-19" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeysession-20" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-21" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysession-22" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysession-23" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-24" title="§ 6.6.1 Queue a &quot;message&quot; Event">§ 6.6.1 Queue a "message" Event</a> <a href="#ref-for-dom-mediakeysession-25" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-26" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysession-27" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-28" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> <a href="#ref-for-dom-mediakeysession-29" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-30" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-31" title="§ 6.6.3 Update Expiration">§ 6.6.3 Update Expiration</a> <a href="#ref-for-dom-mediakeysession-32" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-33" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-34" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> <a href="#ref-for-dom-mediakeysession-35" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-36" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysession-37" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-38" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-39" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dom-mediakeysession-40" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-41" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> <a href="#ref-for-dom-mediakeysession-42" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-43" title="§ 8.7 Support Multiple Keys">§ 8.7 Support Multiple Keys</a> <a href="#ref-for-dom-mediakeysession-44" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-45" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-closed" aria-label="Links in this document to definition: closed">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-closed" aria-label="Permalink for definition: closed. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-closed-1" title="§ 5.2.2 CDM Unavailable">§ 5.2.2 CDM Unavailable</a> 
    </li><li>
      <a href="#ref-for-dfn-closed-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dfn-closed-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-closed-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-closed-5" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-closed-6" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-closed-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-closed-8" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dfn-closed-9" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-closed-10" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessionclosedreason" aria-label="Links in this document to definition: MediaKeySessionClosedReason">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessionclosedreason" aria-label="Permalink for definition: MediaKeySessionClosedReason. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-103604943">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dom-mediakeysessionclosedreason-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-3" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-4" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-5" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessionclosedreason-internal-error" aria-label="Links in this document to definition: internal-error">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessionclosedreason-internal-error" aria-label="Permalink for definition: internal-error. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-103604943">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-internal-error-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessionclosedreason-closed-by-application" aria-label="Links in this document to definition: closed-by-application">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessionclosedreason-closed-by-application" aria-label="Permalink for definition: closed-by-application. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-103604943">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-closed-by-application-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-closed-by-application-2" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeysessionclosedreason-closed-by-application-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessionclosedreason-release-acknowledged" aria-label="Links in this document to definition: release-acknowledged">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessionclosedreason-release-acknowledged" aria-label="Permalink for definition: release-acknowledged. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-103604943">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-release-acknowledged-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-release-acknowledged-2" title="§ 6.2 Methods">§ 6.2 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessionclosedreason-hardware-context-reset" aria-label="Links in this document to definition: hardware-context-reset">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessionclosedreason-hardware-context-reset" aria-label="Permalink for definition: hardware-context-reset. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-103604943">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-hardware-context-reset-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysessionclosedreason-resource-evicted" aria-label="Links in this document to definition: resource-evicted">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysessionclosedreason-resource-evicted" aria-label="Permalink for definition: resource-evicted. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-103604943">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysessionclosedreason-resource-evicted-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-sessionid" aria-label="Links in this document to definition: sessionId">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-sessionid" aria-label="Permalink for definition: sessionId. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-sessionid-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-sessionid-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-sessionid-3" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeysession-sessionid-4" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-sessionid-5" title="Reference 3">(3)</a> <a href="#ref-for-dom-mediakeysession-sessionid-6" title="Reference 4">(4)</a> <a href="#ref-for-dom-mediakeysession-sessionid-7" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-sessionid-8" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-expiration" aria-label="Links in this document to definition: expiration">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-expiration" aria-label="Permalink for definition: expiration. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-expiration-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-expiration-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-expiration-3" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-expiration-4" title="§ 6.6.3 Update Expiration">§ 6.6.3 Update Expiration</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-expiration-5" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-closed" aria-label="Links in this document to definition: closed">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-closed" aria-label="Permalink for definition: closed. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-closed-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-closed-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dom-mediakeysession-closed-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-closed-4" title="§ 6.2 Methods">§ 6.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-closed-5" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-keystatuses" aria-label="Links in this document to definition: keyStatuses">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-keystatuses" aria-label="Permalink for definition: keyStatuses. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-keystatuses-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-keystatuses-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-keystatuses-3" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> <a href="#ref-for-dom-mediakeysession-keystatuses-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-keystatuses-5" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> <a href="#ref-for-dom-mediakeysession-keystatuses-6" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-onkeystatuseschange" aria-label="Links in this document to definition: onkeystatuseschange">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-onkeystatuseschange" aria-label="Permalink for definition: onkeystatuseschange. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-onkeystatuseschange-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-onmessage" aria-label="Links in this document to definition: onmessage">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-onmessage" aria-label="Permalink for definition: onmessage. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-onmessage-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-generaterequest" aria-label="Links in this document to definition: generateRequest()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-generaterequest" aria-label="Permalink for definition: generateRequest(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-generaterequest-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dom-mediakeysession-generaterequest-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-generaterequest-3" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-generaterequest-4" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dom-mediakeysession-generaterequest-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-generaterequest-6" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-generaterequest-7" title="§ 10.1 Input Data Attacks and Vulnerabilities">§ 10.1 Input Data Attacks and Vulnerabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-load" aria-label="Links in this document to definition: load()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-load" aria-label="Permalink for definition: load(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-load-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-load-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-load-3" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-load-4" title="§ 6.2 Methods">§ 6.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-load-5" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dom-mediakeysession-load-6" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-update" aria-label="Links in this document to definition: update()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-update" aria-label="Permalink for definition: update(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-update-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dom-mediakeysession-update-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-3" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> <a href="#ref-for-dom-mediakeysession-update-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-5" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-6" title="§ 6.1 Attributes">§ 6.1 Attributes</a> <a href="#ref-for-dom-mediakeysession-update-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-8" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeysession-update-9" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-10" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-11" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> <a href="#ref-for-dom-mediakeysession-update-12" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-13" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-14" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> <a href="#ref-for-dom-mediakeysession-update-15" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-16" title="§ 9.1.4 License Format">§ 9.1.4 License Format</a> <a href="#ref-for-dom-mediakeysession-update-17" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-update-18" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-19" title="§ 9.1.6 License Release Acknowledgement Format">§ 9.1.6 License Release Acknowledgement Format</a> <a href="#ref-for-dom-mediakeysession-update-20" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-21" title="§ 10.1 Input Data Attacks and Vulnerabilities">§ 10.1 Input Data Attacks and Vulnerabilities</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-22" title="§ 11.8 Secure Origin and Transport">§ 11.8 Secure Origin and Transport</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-update-23" title="§ 13.4 Using All Events">§ 13.4 Using All Events</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-close" aria-label="Links in this document to definition: close()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-close" aria-label="Permalink for definition: close(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-close-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dom-mediakeysession-close-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeysession-close-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeysession-remove" aria-label="Links in this document to definition: remove()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeysession-remove" aria-label="Permalink for definition: remove(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-782043315">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeysession-remove-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-remove-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-remove-3" title="§ 6.8 Session Storage and Persistence">§ 6.8 Session Storage and Persistence</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeysession-remove-4" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> <a href="#ref-for-dom-mediakeysession-remove-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatusmap" aria-label="Links in this document to definition: MediaKeyStatusMap">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatusmap" aria-label="Permalink for definition: MediaKeyStatusMap. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-366396555">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatusmap-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatusmap-2" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatusmap-3" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatusmap-4" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> <a href="#ref-for-dom-mediakeystatusmap-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatusmap-size" aria-label="Links in this document to definition: size">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatusmap-size" aria-label="Permalink for definition: size. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-366396555">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatusmap-size-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatusmap-size-2" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatusmap-has" aria-label="Links in this document to definition: has()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatusmap-has" aria-label="Permalink for definition: has(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-366396555">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatusmap-has-1" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatusmap-get" aria-label="Links in this document to definition: get()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatusmap-get" aria-label="Permalink for definition: get(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-366396555">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatusmap-get-1" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus" aria-label="Links in this document to definition: MediaKeyStatus">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus" aria-label="Permalink for definition: MediaKeyStatus. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-2" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dom-mediakeystatus-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-4" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-5" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeystatus-6" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeystatus-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-8" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> <a href="#ref-for-dom-mediakeystatus-9" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeystatus-12" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-10" title="§ 6.3.2 Methods">§ 6.3.2 Methods</a> <a href="#ref-for-dom-mediakeystatus-11" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-13" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> <a href="#ref-for-dom-mediakeystatus-14" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeystatus-15" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-16" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-17" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-usable" aria-label="Links in this document to definition: usable">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-usable" aria-label="Permalink for definition: usable. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-usable-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-usable-2" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-usable-3" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-expired" aria-label="Links in this document to definition: expired">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-expired" aria-label="Permalink for definition: expired. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-expired-1" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-expired-2" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-released" aria-label="Links in this document to definition: released">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-released" aria-label="Permalink for definition: released. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-released-1" title="§ 6.2 Methods">§ 6.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-released-2" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-output-restricted" aria-label="Links in this document to definition: output-restricted">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-output-restricted" aria-label="Permalink for definition: output-restricted. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-output-restricted-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-output-restricted-2" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> <a href="#ref-for-dom-mediakeystatus-output-restricted-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-output-downscaled" aria-label="Links in this document to definition: output-downscaled">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-output-downscaled" aria-label="Permalink for definition: output-downscaled. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-output-downscaled-1" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> <a href="#ref-for-dom-mediakeystatus-output-downscaled-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-usable-in-future" aria-label="Links in this document to definition: usable-in-future">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-usable-in-future" aria-label="Permalink for definition: usable-in-future. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-usable-in-future-1" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-status-pending" aria-label="Links in this document to definition: status-pending">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-status-pending" aria-label="Permalink for definition: status-pending. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-status-pending-1" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeystatus-status-pending-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-status-pending-3" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeystatus-internal-error" aria-label="Links in this document to definition: internal-error">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeystatus-internal-error" aria-label="Permalink for definition: internal-error. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-418631828">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeystatus-internal-error-1" title="§ 5.2.2 CDM Unavailable">§ 5.2.2 CDM Unavailable</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeystatus-internal-error-2" title="§ 6.3 MediaKeyStatusMap Interface">§ 6.3 MediaKeyStatusMap Interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessagetype" aria-label="Links in this document to definition: MediaKeyMessageType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessagetype" aria-label="Permalink for definition: MediaKeyMessageType. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1754914033">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessagetype-1" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeymessagetype-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-3" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> <a href="#ref-for-dom-mediakeymessagetype-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-5" title="§ 6.4.1 Attributes">§ 6.4.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-6" title="§ 6.4.2 MediaKeyMessageEventInit">§ 6.4.2 MediaKeyMessageEventInit</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-7" title="§ 6.4.2.1 Dictionary MediaKeyMessageEventInit Members">§ 6.4.2.1 Dictionary MediaKeyMessageEventInit Members</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessagetype-license-request" aria-label="Links in this document to definition: license-request">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessagetype-license-request" aria-label="Permalink for definition: license-request. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1754914033">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessagetype-license-request-1" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeymessagetype-license-request-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-mediakeymessagetype-license-request-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-license-request-4" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessagetype-license-renewal" aria-label="Links in this document to definition: license-renewal">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessagetype-license-renewal" aria-label="Permalink for definition: license-renewal. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1754914033">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessagetype-license-renewal-1" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessagetype-license-release" aria-label="Links in this document to definition: license-release">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessagetype-license-release" aria-label="Permalink for definition: license-release. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1754914033">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessagetype-license-release-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-license-release-2" title="§ 6.2 Methods">§ 6.2 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-license-release-3" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessagetype-individualization-request" aria-label="Links in this document to definition: individualization-request">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessagetype-individualization-request" aria-label="Permalink for definition: individualization-request. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1754914033">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessagetype-individualization-request-1" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dom-mediakeymessagetype-individualization-request-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-individualization-request-3" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessagetype-individualization-request-4" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessageevent" aria-label="Links in this document to definition: MediaKeyMessageEvent">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessageevent" aria-label="Permalink for definition: MediaKeyMessageEvent. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessageevent-1" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-2" title="§ 6.5 Event Summary">§ 6.5 Event Summary</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-3" title="§ 6.6.1 Queue a &quot;message&quot; Event">§ 6.6.1 Queue a "message" Event</a> <a href="#ref-for-dom-mediakeymessageevent-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-5" title="§ 9.1.3 License Request Format">§ 9.1.3 License Request Format</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-6" title="§ 9.1.5 License Release Format">§ 9.1.5 License Release Format</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessageevent-constructor" aria-label="Links in this document to definition: constructor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessageevent-constructor" aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessageevent-messagetype" aria-label="Links in this document to definition: messageType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessageevent-messagetype" aria-label="Permalink for definition: messageType. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1595553803">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessageevent-messagetype-1" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-messagetype-2" title="§ 6.6.1 Queue a &quot;message&quot; Event">§ 6.6.1 Queue a "message" Event</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-messagetype-3" title="§ 10.1 Input Data Attacks and Vulnerabilities">§ 10.1 Input Data Attacks and Vulnerabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessageevent-message" aria-label="Links in this document to definition: message">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessageevent-message" aria-label="Permalink for definition: message. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1595553803">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessageevent-message-1" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-message-2" title="§ 6.6.1 Queue a &quot;message&quot; Event">§ 6.6.1 Queue a "message" Event</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-message-3" title="§ 9.1.3 License Request Format">§ 9.1.3 License Request Format</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageevent-message-4" title="§ 9.1.5 License Release Format">§ 9.1.5 License Release Format</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessageeventinit" aria-label="Links in this document to definition: MediaKeyMessageEventInit">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessageeventinit" aria-label="Permalink for definition: MediaKeyMessageEventInit. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-726369050">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessageeventinit-1" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageeventinit-2" title="§ 6.4.2 MediaKeyMessageEventInit">§ 6.4.2 MediaKeyMessageEventInit</a> 
    </li><li>
      <a href="#ref-for-dom-mediakeymessageeventinit-3" title="§ 6.4.2.1 Dictionary MediaKeyMessageEventInit Members">§ 6.4.2.1 Dictionary MediaKeyMessageEventInit Members</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessageeventinit-messagetype" aria-label="Links in this document to definition: messageType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessageeventinit-messagetype" aria-label="Permalink for definition: messageType. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-726369050">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessageeventinit-messagetype-1" title="§ 6.4.2 MediaKeyMessageEventInit">§ 6.4.2 MediaKeyMessageEventInit</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediakeymessageeventinit-message" aria-label="Links in this document to definition: message">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediakeymessageeventinit-message" aria-label="Permalink for definition: message. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-726369050">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediakeymessageeventinit-message-1" title="§ 6.4.2 MediaKeyMessageEventInit">§ 6.4.2 MediaKeyMessageEventInit</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keystatuseschange" aria-label="Links in this document to definition: keystatuseschange">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-keystatuseschange" aria-label="Permalink for definition: keystatuseschange. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-keystatuseschange-1" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-keystatuseschange-2" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-message" aria-label="Links in this document to definition: message">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-message" aria-label="Permalink for definition: message. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-message-1" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dfn-message-2" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-message-3" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-message-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-message-5" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dfn-message-6" title="§ 6.6.1 Queue a &quot;message&quot; Event">§ 6.6.1 Queue a "message" Event</a> 
    </li><li>
      <a href="#ref-for-dfn-message-7" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> 
    </li><li>
      <a href="#ref-for-dfn-message-8" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-message-9" title="§ 9.1.3 License Request Format">§ 9.1.3 License Request Format</a> 
    </li><li>
      <a href="#ref-for-dfn-message-10" title="§ 9.1.5 License Release Format">§ 9.1.5 License Release Format</a> 
    </li><li>
      <a href="#ref-for-dfn-message-11" title="§ 10.1 Input Data Attacks and Vulnerabilities">§ 10.1 Input Data Attacks and Vulnerabilities</a> 
    </li><li>
      <a href="#ref-for-dfn-message-12" title="§ 11.8 Secure Origin and Transport">§ 11.8 Secure Origin and Transport</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-queue-a-message-event" aria-label="Links in this document to definition: Queue a &quot;message&quot; Event">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-queue-a-message-event" aria-label="Permalink for definition: Queue a &quot;message&quot; Event. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-queue-a-message-event-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-queue-a-message-event-2" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-queue-a-message-event-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-queue-a-message-event-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-queue-a-message-event-5" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-queue-a-message-event-6" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-update-key-statuses" aria-label="Links in this document to definition: Update Key Statuses">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-update-key-statuses" aria-label="Permalink for definition: Update Key Statuses. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-update-key-statuses-1" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-update-key-statuses-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-update-key-statuses-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-update-key-statuses-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-update-key-statuses-5" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-update-key-statuses-6" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> 
    </li><li>
      <a href="#ref-for-dfn-update-key-statuses-7" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li><li>
      <a href="#ref-for-dfn-update-key-statuses-8" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-update-expiration" aria-label="Links in this document to definition: Update Expiration">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-update-expiration" aria-label="Permalink for definition: Update Expiration. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-update-expiration-1" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-update-expiration-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-update-expiration-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-update-expiration-4" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> 
    </li><li>
      <a href="#ref-for-dfn-update-expiration-5" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-session-closed" aria-label="Links in this document to definition: Session Closed">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-session-closed" aria-label="Permalink for definition: Session Closed. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-session-closed-1" title="§ 5.2.2 CDM Unavailable">§ 5.2.2 CDM Unavailable</a> 
    </li><li>
      <a href="#ref-for-dfn-session-closed-2" title="§ 6.1 Attributes">§ 6.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-session-closed-3" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-session-closed-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-session-closed-5" title="§ 6.6.5 Monitor for CDM State Changes">§ 6.6.5 Monitor for CDM State Changes</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-monitor-for-cdm-state-changes" aria-label="Links in this document to definition: Monitor for CDM State Changes">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-monitor-for-cdm-state-changes" aria-label="Permalink for definition: Monitor for CDM State Changes. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-monitor-for-cdm-state-changes-1" title="§ 6. MediaKeySession Interface">§ 6. MediaKeySession Interface</a> <a href="#ref-for-dfn-monitor-for-cdm-state-changes-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-monitor-for-cdm-state-changes-3" title="§ 6.6.4 Session Closed">§ 6.6.4 Session Closed</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-typeerror" aria-label="Links in this document to definition: TypeError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-typeerror" aria-label="Permalink for definition: TypeError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-typeerror-1" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> <a href="#ref-for-dfn-typeerror-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-typeerror-3" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dfn-typeerror-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-typeerror-5" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-typeerror-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-typeerror-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-typeerror-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-typeerror-9" title="Reference 5">(5)</a> <a href="#ref-for-dfn-typeerror-10" title="Reference 6">(6)</a> <a href="#ref-for-dfn-typeerror-11" title="Reference 7">(7)</a> <a href="#ref-for-dfn-typeerror-12" title="Reference 8">(8)</a> <a href="#ref-for-dfn-typeerror-13" title="Reference 9">(9)</a> <a href="#ref-for-dfn-typeerror-14" title="Reference 10">(10)</a> <a href="#ref-for-dfn-typeerror-15" title="Reference 11">(11)</a> <a href="#ref-for-dfn-typeerror-16" title="Reference 12">(12)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-notsupportederror" aria-label="Links in this document to definition: NotSupportedError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-notsupportederror" aria-label="Permalink for definition: NotSupportedError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-notsupportederror-1" title="§ 3.2.1 Methods">§ 3.2.1 Methods</a> <a href="#ref-for-dfn-notsupportederror-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-notsupportederror-3" title="§ 5.1 Methods">§ 5.1 Methods</a> <a href="#ref-for-dfn-notsupportederror-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-notsupportederror-5" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-notsupportederror-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-notsupportederror-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-notsupportederror-8" title="§ 7.2 Methods">§ 7.2 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-invalidstateerror" aria-label="Links in this document to definition: InvalidStateError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-invalidstateerror" aria-label="Permalink for definition: InvalidStateError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-invalidstateerror-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-invalidstateerror-2" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-invalidstateerror-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-invalidstateerror-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-invalidstateerror-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-invalidstateerror-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-invalidstateerror-7" title="Reference 6">(6)</a> <a href="#ref-for-dfn-invalidstateerror-8" title="Reference 7">(7)</a> <a href="#ref-for-dfn-invalidstateerror-9" title="Reference 8">(8)</a> <a href="#ref-for-dfn-invalidstateerror-10" title="Reference 9">(9)</a> 
    </li><li>
      <a href="#ref-for-dfn-invalidstateerror-11" title="§ 7.2 Methods">§ 7.2 Methods</a> <a href="#ref-for-dfn-invalidstateerror-12" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-quotaexceedederror" aria-label="Links in this document to definition: QuotaExceededError">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-quotaexceedederror" aria-label="Permalink for definition: QuotaExceededError. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-quotaexceedederror-1" title="§ 6.2 Methods">§ 6.2 Methods</a> <a href="#ref-for-dfn-quotaexceedederror-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-quotaexceedederror-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-quotaexceedederror-4" title="§ 7.2 Methods">§ 7.2 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-htmlmediaelement" aria-label="Links in this document to definition: HTMLMediaElement">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-htmlmediaelement" aria-label="Permalink for definition: HTMLMediaElement. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-htmlmediaelement-1" title="§ Abstract">§ Abstract</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-2" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-3" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-4" title="§ 5. MediaKeys Interface">§ 5. MediaKeys Interface</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-5" title="§ 6.7 Exceptions">§ 6.7 Exceptions</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-6" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> <a href="#ref-for-dom-htmlmediaelement-7" title="Reference 2">(2)</a> <a href="#ref-for-dom-htmlmediaelement-8" title="Reference 3">(3)</a> <a href="#ref-for-dom-htmlmediaelement-9" title="Reference 4">(4)</a> <a href="#ref-for-dom-htmlmediaelement-10" title="Reference 5">(5)</a> <a href="#ref-for-dom-htmlmediaelement-11" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-12" title="§ 7.1 Attributes">§ 7.1 Attributes</a> <a href="#ref-for-dom-htmlmediaelement-13" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-14" title="§ 7.5.1 Media Data May Contain Encrypted Blocks">§ 7.5.1 Media Data May Contain Encrypted Blocks</a> <a href="#ref-for-dom-htmlmediaelement-15" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-16" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> <a href="#ref-for-dom-htmlmediaelement-17" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-18" title="§ 7.5.3 Encrypted Block Encountered">§ 7.5.3 Encrypted Block Encountered</a> <a href="#ref-for-dom-htmlmediaelement-19" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-20" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> <a href="#ref-for-dom-htmlmediaelement-21" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-22" title="§ 7.5.5 Wait for Key">§ 7.5.5 Wait for Key</a> <a href="#ref-for-dom-htmlmediaelement-23" title="Reference 2">(2)</a> <a href="#ref-for-dom-htmlmediaelement-24" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-25" title="§ 7.5.6 Attempt to Resume Playback If Necessary">§ 7.5.6 Attempt to Resume Playback If Necessary</a> <a href="#ref-for-dom-htmlmediaelement-26" title="Reference 2">(2)</a> <a href="#ref-for-dom-htmlmediaelement-27" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-28" title="§ 8.9.1 Unencrypted Container">§ 8.9.1 Unencrypted Container</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-29" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-htmlmediaelement-mediakeys" aria-label="Links in this document to definition: mediaKeys">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-htmlmediaelement-mediakeys" aria-label="Permalink for definition: mediaKeys. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1869224078">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-htmlmediaelement-mediakeys-1" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-mediakeys-2" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-mediakeys-3" title="§ 7.2 Methods">§ 7.2 Methods</a> <a href="#ref-for-dom-htmlmediaelement-mediakeys-4" title="Reference 2">(2)</a> <a href="#ref-for-dom-htmlmediaelement-mediakeys-5" title="Reference 3">(3)</a> <a href="#ref-for-dom-htmlmediaelement-mediakeys-6" title="Reference 4">(4)</a> <a href="#ref-for-dom-htmlmediaelement-mediakeys-7" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-mediakeys-8" title="§ 7.5.1 Media Data May Contain Encrypted Blocks">§ 7.5.1 Media Data May Contain Encrypted Blocks</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-mediakeys-9" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-mediakeys-10" title="§ 11.3.2 Mitigations">§ 11.3.2 Mitigations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-htmlmediaelement-onencrypted" aria-label="Links in this document to definition: onencrypted">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-htmlmediaelement-onencrypted" aria-label="Permalink for definition: onencrypted. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1869224078">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-htmlmediaelement-onencrypted-1" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-htmlmediaelement-onwaitingforkey" aria-label="Links in this document to definition: onwaitingforkey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-htmlmediaelement-onwaitingforkey" aria-label="Permalink for definition: onwaitingforkey. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1869224078">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-htmlmediaelement-onwaitingforkey-1" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-htmlmediaelement-setmediakeys" aria-label="Links in this document to definition: setMediaKeys()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-htmlmediaelement-setmediakeys" aria-label="Permalink for definition: setMediaKeys(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1869224078">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-htmlmediaelement-setmediakeys-1" title="§ 5.1 Methods">§ 5.1 Methods</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-setmediakeys-2" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-setmediakeys-3" title="§ 7.5.1 Media Data May Contain Encrypted Blocks">§ 7.5.1 Media Data May Contain Encrypted Blocks</a> <a href="#ref-for-dom-htmlmediaelement-setmediakeys-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-htmlmediaelement-setmediakeys-5" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediaencryptedevent" aria-label="Links in this document to definition: MediaEncryptedEvent">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediaencryptedevent" aria-label="Permalink for definition: MediaEncryptedEvent. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediaencryptedevent-1" title="§ 7.3 MediaEncryptedEvent">§ 7.3 MediaEncryptedEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedevent-2" title="§ 7.4 Event Summary">§ 7.4 Event Summary</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedevent-3" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> <a href="#ref-for-dom-mediaencryptedevent-4" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediaencryptedevent-constructor" aria-label="Links in this document to definition: constructor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediaencryptedevent-constructor" aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediaencryptedevent-initdatatype" aria-label="Links in this document to definition: initDataType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediaencryptedevent-initdatatype" aria-label="Permalink for definition: initDataType. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1395593112">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediaencryptedevent-initdatatype-1" title="§ 7.3 MediaEncryptedEvent">§ 7.3 MediaEncryptedEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedevent-initdatatype-2" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediaencryptedevent-initdata" aria-label="Links in this document to definition: initData">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediaencryptedevent-initdata" aria-label="Permalink for definition: initData. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1395593112">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediaencryptedevent-initdata-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedevent-initdata-2" title="§ 7.3 MediaEncryptedEvent">§ 7.3 MediaEncryptedEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedevent-initdata-3" title="§ 7.3.1 Attributes">§ 7.3.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedevent-initdata-4" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> <a href="#ref-for-dom-mediaencryptedevent-initdata-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediaencryptedeventinit" aria-label="Links in this document to definition: MediaEncryptedEventInit">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediaencryptedeventinit" aria-label="Permalink for definition: MediaEncryptedEventInit. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-51354785">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediaencryptedeventinit-1" title="§ 7.3 MediaEncryptedEvent">§ 7.3 MediaEncryptedEvent</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedeventinit-2" title="§ 7.3.2 MediaEncryptedEventInit">§ 7.3.2 MediaEncryptedEventInit</a> 
    </li><li>
      <a href="#ref-for-dom-mediaencryptedeventinit-3" title="§ 7.3.2.1 Dictionary MediaEncryptedEventInit Members">§ 7.3.2.1 Dictionary MediaEncryptedEventInit Members</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediaencryptedeventinit-initdatatype" aria-label="Links in this document to definition: initDataType">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediaencryptedeventinit-initdatatype" aria-label="Permalink for definition: initDataType. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-51354785">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediaencryptedeventinit-initdatatype-1" title="§ 7.3.2 MediaEncryptedEventInit">§ 7.3.2 MediaEncryptedEventInit</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-mediaencryptedeventinit-initdata" aria-label="Links in this document to definition: initData">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-mediaencryptedeventinit-initdata" aria-label="Permalink for definition: initData. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-51354785">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-mediaencryptedeventinit-initdata-1" title="§ 7.3.2 MediaEncryptedEventInit">§ 7.3.2 MediaEncryptedEventInit</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-encrypted" aria-label="Links in this document to definition: encrypted">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-encrypted" aria-label="Permalink for definition: encrypted. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-encrypted-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-encrypted-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-encrypted-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-encrypted-4" title="§ 7.1 Attributes">§ 7.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-encrypted-5" title="§ 7.3 MediaEncryptedEvent">§ 7.3 MediaEncryptedEvent</a> 
    </li><li>
      <a href="#ref-for-dfn-encrypted-6" title="§ 7.5.2 Initialization Data Encountered">§ 7.5.2 Initialization Data Encountered</a> <a href="#ref-for-dfn-encrypted-7" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-waitingforkey" aria-label="Links in this document to definition: waitingforkey">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-waitingforkey" aria-label="Permalink for definition: waitingforkey. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-waitingforkey-1" title="§ 7.1 Attributes">§ 7.1 Attributes</a> 
    </li><li>
      <a href="#ref-for-dfn-waitingforkey-2" title="§ 7.5.5 Wait for Key">§ 7.5.5 Wait for Key</a> <a href="#ref-for-dfn-waitingforkey-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-initialization-data-encountered" aria-label="Links in this document to definition: Initialization Data Encountered">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-initialization-data-encountered" aria-label="Permalink for definition: Initialization Data Encountered. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-initialization-data-encountered-1" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> <a href="#ref-for-dfn-initialization-data-encountered-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-initialization-data-encountered-3" title="§ 8.9.1 Unencrypted Container">§ 8.9.1 Unencrypted Container</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-encrypted-block-encountered" aria-label="Links in this document to definition: Encrypted Block Encountered">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-encrypted-block-encountered" aria-label="Permalink for definition: Encrypted Block Encountered. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-encrypted-block-encountered-1" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> 
    </li><li>
      <a href="#ref-for-dfn-encrypted-block-encountered-2" title="§ 8.9.1 Unencrypted Container">§ 8.9.1 Unencrypted Container</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-attempt-to-decrypt" aria-label="Links in this document to definition: Attempt to Decrypt">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-attempt-to-decrypt" aria-label="Permalink for definition: Attempt to Decrypt. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-attempt-to-decrypt-1" title="§ 7.5.3 Encrypted Block Encountered">§ 7.5.3 Encrypted Block Encountered</a> 
    </li><li>
      <a href="#ref-for-dfn-attempt-to-decrypt-2" title="§ 7.5.6 Attempt to Resume Playback If Necessary">§ 7.5.6 Attempt to Resume Playback If Necessary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wait-for-key" aria-label="Links in this document to definition: Wait for Key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wait-for-key" aria-label="Permalink for definition: Wait for Key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-wait-for-key-1" title="§ 7. HTMLMediaElement Extensions">§ 7. HTMLMediaElement Extensions</a> 
    </li><li>
      <a href="#ref-for-dfn-wait-for-key-2" title="§ 7.5.1 Media Data May Contain Encrypted Blocks">§ 7.5.1 Media Data May Contain Encrypted Blocks</a> 
    </li><li>
      <a href="#ref-for-dfn-wait-for-key-3" title="§ 7.5.4 Attempt to Decrypt">§ 7.5.4 Attempt to Decrypt</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-attempt-to-resume-playback-if-necessary" aria-label="Links in this document to definition: Attempt to Resume Playback If Necessary">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-attempt-to-resume-playback-if-necessary" aria-label="Permalink for definition: Attempt to Resume Playback If Necessary. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-attempt-to-resume-playback-if-necessary-1" title="§ 6.6.2 Update Key Statuses">§ 6.6.2 Update Key Statuses</a> 
    </li><li>
      <a href="#ref-for-dfn-attempt-to-resume-playback-if-necessary-2" title="§ 7.2 Methods">§ 7.2 Methods</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-individualization" aria-label="Links in this document to definition: Individualization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-individualization" aria-label="Permalink for definition: Individualization. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-individualization-1" title="§ 2. Definitions">§ 2. Definitions</a> <a href="#ref-for-dfn-individualization-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-individualization-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-individualization-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-individualization-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-individualization-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-individualization-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-individualization-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-individualization-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-individualization-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-individualization-11" title="Reference 11">(11)</a> 
    </li><li>
      <a href="#ref-for-dfn-individualization-12" title="§ 8.5.2 Encrypt Identifiers">§ 8.5.2 Encrypt Identifiers</a> <a href="#ref-for-dfn-individualization-13" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-individualization-14" title="§ 11.4.1 Concerns">§ 11.4.1 Concerns</a> 
    </li><li>
      <a href="#ref-for-dfn-individualization-15" title="§ 11.4.2 Mitigations">§ 11.4.2 Mitigations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-direct-individualization" aria-label="Links in this document to definition: Direct Individualization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-direct-individualization" aria-label="Permalink for definition: Direct Individualization. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-direct-individualization-1" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li><li>
      <a href="#ref-for-dfn-direct-individualization-2" title="§ 8.6.2 App-Assisted Individualization">§ 8.6.2 App-Assisted Individualization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-app-assisted-individualization" aria-label="Links in this document to definition: App-Assisted Individualization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-app-assisted-individualization" aria-label="Permalink for definition: App-Assisted Individualization. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-app-assisted-individualization-1" title="§ 6.4 MediaKeyMessageEvent">§ 6.4 MediaKeyMessageEvent</a> 
    </li><li>
      <a href="#ref-for-dfn-app-assisted-individualization-2" title="§ 8.6 Individualization">§ 8.6 Individualization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-common-key-systems" aria-label="Links in this document to definition: Common Key Systems">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-common-key-systems" aria-label="Permalink for definition: Common Key Systems. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-common-key-systems-1" title="§ 2. Definitions">§ 2. Definitions</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-clear-key" aria-label="Links in this document to definition: Clear Key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-clear-key" aria-label="Permalink for definition: Clear Key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-clear-key-1" title="§ Abstract">§ Abstract</a> 
    </li><li>
      <a href="#ref-for-dfn-clear-key-2" title="§ 9.1.1 Capabilities">§ 9.1.1 Capabilities</a> 
    </li><li>
      <a href="#ref-for-dfn-clear-key-3" title="§ 9.1.2 Behavior">§ 9.1.2 Behavior</a> 
    </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>